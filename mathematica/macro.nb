(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     73996,       1937]
NotebookOptionsPosition[     71631,       1879]
NotebookOutlinePosition[     71967,       1894]
CellTagsIndexPosition[     71924,       1891]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.761283945021599*^9, 
  3.761283945557975*^9}},ExpressionUUID->"ce7a8f21-2a7b-4df1-9a21-\
5d4ea3d14c5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OptimizeExpressionToC", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"tuple_:", "False"}], ",", 
     RowBox[{"sum_:", " ", "False"}], ",", 
     RowBox[{"pow2_:", " ", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "optimizedExpr", ",", "mainExpr", ",", "n", ",", "m", ",", "defs", ",", 
       "output"}], "}"}], ",", 
     RowBox[{
      RowBox[{"optimizedExpr", "=", 
       RowBox[{"Experimental`OptimizeExpression", "[", "expr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "@", 
          RowBox[{"optimizedExpr", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "0"}], "]"}], "]"}]}], "\[Equal]", 
         "\"\<Block\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"optimizedExpr", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"mainExpr", "=", 
           RowBox[{"optimizedExpr", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2", ",", 
              RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], ";"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"mainExpr", "=", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{"optimizedExpr", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}]}]}], ";"}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "mainExpr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"defs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<Real \>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"CForm", "@", 
            RowBox[{"optimizedExpr", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2", ",", "i", ",", "1"}], "]"}], "]"}]}]}], 
          "<>", "\"\< = \>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"CForm", "@", 
            RowBox[{"optimizedExpr", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2", ",", "i", ",", "2"}], "]"}], "]"}]}]}], 
          "<>", "\"\<;\\n\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"tuple", ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"MapIndexed", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<out\>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<(\>\"", "<>", 
                 RowBox[{"StringJoin", "@", 
                  RowBox[{"Riffle", "[", 
                   RowBox[{
                    RowBox[{"ToString", "/@", 
                    RowBox[{"(", 
                    RowBox[{"#2", "-", "1"}], ")"}]}], ",", "\"\<,\>\""}], 
                   "]"}]}], "<>", "\"\<) = \>\"", "<>", 
                 RowBox[{"ToString", "@", 
                  RowBox[{"CForm", "@", "#1"}]}], "<>", "\"\<;\\n\>\""}], 
                "&"}], ",", 
               RowBox[{"mainExpr", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"ArrayDepth", "[", 
                 RowBox[{"mainExpr", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "mainExpr", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "@", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<out(\>\"", "<>", 
              RowBox[{"StringJoin", "@", 
               RowBox[{"Riffle", "[", 
                RowBox[{
                 RowBox[{"ToString", "/@", 
                  RowBox[{"(", 
                   RowBox[{"#2", "-", "1"}], ")"}]}], ",", "\"\<,\>\""}], 
                "]"}]}], "<>", "\"\<) = \>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"CForm", "@", "#1"}]}], "<>", "\"\<;\\n\>\""}], "&"}], 
            ",", "mainExpr", ",", 
            RowBox[{"{", 
             RowBox[{"ArrayDepth", "[", "mainExpr", "]"}], "}"}]}], "]"}]}]}],
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"defs", ",", "output"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"output", ",", 
         RowBox[{"\"\<Power(E,\>\"", "\[Rule]", "\"\<Exp(\>\""}]}], "]"}]}], 
      ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Rename", " ", "exponent", " ", "function"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"output", ",", 
         RowBox[{"\"\<Compile_$\>\"", "\[Rule]", "\"\<c\>\""}]}], "]"}]}], 
      ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Rename", " ", "temporary", " ", "variables"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"output", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"pow2", ",", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"output", ",", 
           RowBox[{
            RowBox[{
            "RegularExpression", "[", 
             "\"\<Power\\\\(([^\\\\)\\\\(,\\\\s]*),2\\\\)\>\"", "]"}], 
            "\[Rule]", "\"\<($1*$1)\>\""}]}], "]"}], ",", "output"}], "]"}]}],
       ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Replace", " ", "Power", 
        RowBox[{"(", 
         RowBox[{"v", ",", "2"}], ")"}], " ", "with", " ", "multiplication", 
        " ", "v", "*", "v"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"If", "[", 
        RowBox[{"sum", ",", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"output", ",", 
           RowBox[{
            RowBox[{
            "RegularExpression", "[", "\"\<(out\\\\([^\\\\)]*\\\\)) (=)\>\"", 
             "]"}], "\[Rule]", "\"\<$1 +=\>\""}]}], "]"}], ",", "output"}], 
        "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"out", 
          RowBox[{"(", "..", ")"}]}], " ", "+=", " ", 
         RowBox[{"instead", " ", "of", " ", "out", 
          RowBox[{"(", "..", ")"}]}]}], " ", "=", " ", ".."}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"StringJoin", "[", "output", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymbolArray", "[", 
    RowBox[{"sname_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "n", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Symbol", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "sname", "]"}], "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Symbol", "[", 
          RowBox[{"sname", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", 
           RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"Length", "[", "n", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FunctionArray", "[", 
    RowBox[{"sname_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "n", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"ToString", "[", "sname", "]"}], "]"}], "[", "i", "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Symbol", "[", "sname", "]"}], "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"Length", "[", "n", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WriteToFile", "[", 
    RowBox[{"path_", ",", "str_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "file", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"file", " ", "=", " ", 
       RowBox[{"OpenWrite", "[", "path", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"file", ",", " ", "str"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "file", "]"}], ";", "\[IndentingNewLine]", 
      "str"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x_", "\[CircleTimes]", "y_"}], ":=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", "x", ",", "y"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.753975422835587*^9, 3.753975423293962*^9}, {
   3.7540239966734324`*^9, 3.7540239970573263`*^9}, {3.754027054440576*^9, 
   3.754027057576805*^9}, {3.7540327970988503`*^9, 3.754032835057887*^9}, {
   3.754032879897766*^9, 3.754032882096696*^9}, {3.754040031316481*^9, 
   3.7540400345624104`*^9}, {3.754040206280881*^9, 3.754040473357143*^9}, {
   3.7540405498125467`*^9, 3.7540405534453278`*^9}, {3.7540407321297626`*^9, 
   3.754040776585314*^9}, {3.754041299732593*^9, 3.7540413957709846`*^9}, {
   3.7540541075229607`*^9, 3.754054114561799*^9}, 3.754054211519972*^9, 
   3.7540544095763397`*^9, {3.754110218058097*^9, 3.7541102371630697`*^9}, {
   3.754110761699958*^9, 3.754110787710558*^9}, {3.754111043701708*^9, 
   3.754111076692844*^9}, {3.754111138689981*^9, 3.7541111403926353`*^9}, 
   3.754116221144569*^9, {3.75585915227102*^9, 3.7558592296487713`*^9}, {
   3.755859267090712*^9, 3.755859267720997*^9}, {3.755859327392712*^9, 
   3.755859401526217*^9}, {3.755859476640418*^9, 3.755859587892376*^9}, {
   3.761285641490581*^9, 3.761285645820663*^9}, {3.761287074563222*^9, 
   3.761287075410365*^9}, {3.761287135034172*^9, 
   3.76128713552135*^9}},ExpressionUUID->"3612ea70-5f38-4e37-bd1b-\
6c0b5a9bdcae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"define", " ", "vertex", " ", "inputs"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xlocal", " ", "=", " ", 
     RowBox[{"FunctionArray", "[", 
      RowBox[{"\"\<xloc\>\"", ",", "18"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x0", " ", "=", " ", 
     RowBox[{"xlocal", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x1", " ", "=", " ", 
     RowBox[{"xlocal", "[", 
      RowBox[{"[", 
       RowBox[{"4", ";;", "6"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x2", " ", "=", " ", 
     RowBox[{"xlocal", "[", 
      RowBox[{"[", 
       RowBox[{"7", ";;", "9"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xn0", " ", "=", " ", 
     RowBox[{"xlocal", "[", 
      RowBox[{"[", 
       RowBox[{"10", ";;", "12"}], "]"}], "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "neighbor", " ", "vertex", " ", "of", " ", "face", " ", "sharing", " ", 
       "e0"}], " ", "=", " ", 
      RowBox[{"x1", "-", "x0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"xn1", "=", " ", 
     RowBox[{"xlocal", "[", 
      RowBox[{"[", 
       RowBox[{"13", ";;", "15"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xn2", " ", "=", " ", 
     RowBox[{"xlocal", "[", 
      RowBox[{"[", 
       RowBox[{"16", ";;", "18"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"other", " ", "assumed", " ", "inputs"}], ",", " ", 
     RowBox[{"constant", " ", "per", " ", 
      RowBox[{"remeshing", ":", " ", "invDm"}]}], ",", " ", "A", ",", " ", 
     "l_i", ",", " ", "t_i"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"stretching", " ", 
     RowBox[{"tensor", " ", "/", " ", "first"}], " ", "fundamental", " ", 
     "form"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F", " ", "=", " ", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", " ", "-", "x0"}], ",", " ", 
         RowBox[{"x2", "-", " ", "x0"}]}], "}"}], "]"}], ".", 
      RowBox[{"FunctionArray", "[", 
       RowBox[{"\"\<invDm\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"deformation", " ", "gradient", " ", "F"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x1", "-", 
         RowBox[{"x0", " ", "x2"}], "-", "x0"}], ")"}], " ", "invDm"}]}], " ",
      "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Epsilon]", " ", "=", " ", 
     RowBox[{
      RowBox[{"Transpose", "[", "F", "]"}], ".", " ", "F"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"curvature", " ", 
      RowBox[{"tensor", " ", "/", " ", "shape"}], " ", 
      RowBox[{"operator", " ", "/", " ", "second"}], " ", "fundamental", " ", 
      "form", " ", "\[Kappa]"}], " ", "="}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", " ", "=", " ", 
     RowBox[{"Normalize", "[", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"x1", " ", "-", "x0"}], ",", " ", 
        RowBox[{"x2", "-", " ", "x0"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n0", " ", "=", " ", 
     RowBox[{"Normalize", "[", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"xn0", " ", "-", "x0"}], ",", " ", 
        RowBox[{"x1", "-", " ", "x0"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n1", " ", "=", " ", 
     RowBox[{"Normalize", "[", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"xn1", " ", "-", "x1"}], ",", " ", 
        RowBox[{"x2", "-", " ", "x1"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n2", " ", "=", " ", 
     RowBox[{"Normalize", "[", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"xn2", " ", "-", "x2"}], ",", " ", 
        RowBox[{"x0", "-", " ", "x2"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]0", " ", "=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"n", ".", "n0"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1", "-", " ", "x0"}], ")"}], ".", 
        RowBox[{"Cross", "[", 
         RowBox[{"n", ",", "n0"}], "]"}]}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]1", " ", "=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"n", ".", "n1"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2", "-", " ", "x1"}], ")"}], ".", 
        RowBox[{"Cross", "[", 
         RowBox[{"n", ",", "n1"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]2", " ", "=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"n", ".", "n2"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x0", "-", " ", "x2"}], ")"}], ".", 
        RowBox[{"Cross", "[", 
         RowBox[{"n", ",", "n2"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"phi", "[", "theta_", "]"}], " ", ":=", " ", "theta"}], ";", 
     " ", 
     RowBox[{"2", "*", "tan", 
      RowBox[{"(", 
       RowBox[{"theta", "/", "2"}], ")"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"phi", "[", "theta_", "]"}], " ", ":=", " ", 
     RowBox[{"2", "*", 
      RowBox[{"Tan", "[", 
       RowBox[{"theta", "/", "2"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]Resti", " ", "=", " ", "0"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"assuming", " ", "flat", " ", "rest", " ", "configuration"}], 
      ",", " ", 
      RowBox[{
      "could", " ", "use", " ", "input", " ", "rest", " ", "angle", " ", 
       "per", " ", "edge", "  ", "TODO", " ", "exists", " ", "in", " ", 
       "arcsim"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tot", "[", "name_", "]"}], " ", ":=", 
     RowBox[{
      RowBox[{"FunctionArray", "[", 
       RowBox[{"name", ",", "2"}], "]"}], "\[CircleTimes]", 
      RowBox[{"FunctionArray", "[", 
       RowBox[{"name", ",", "2"}], "]"}]}]}], " ", ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "vec2", " ", "because", " ", "2", "d", " ", "material", " ", "config"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Kappa]", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"phi", "[", "\[Theta]0", "]"}], "-", 
          RowBox[{"phi", "[", "thetarest0", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", "A", " ", "l0"}], ")"}]}], 
       RowBox[{"tot", "[", "\"\<t0\>\"", "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"phi", "[", "\[Theta]1", "]"}], "-", 
          RowBox[{"phi", "[", "thetarest1", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", "A", " ", "l1"}], ")"}]}], " ", 
       RowBox[{"tot", "[", "\"\<t1\>\"", "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"phi", "[", "\[Theta]2", "]"}], "-", 
          RowBox[{"phi", "[", "thetarest2", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", "A", " ", "l2"}], ")"}]}], " ", 
       RowBox[{"tot", "[", "\"\<t2\>\"", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "combined", " ", "parts", " ", "without", " ", "symmetric", " ", 
     "redundancy", " ", "for", " ", "chain", " ", "ruling"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]\[Kappa]", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"\[Kappa]", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"\[Kappa]", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"\[Kappa]", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7540232899336643`*^9, 3.754023308473406*^9}, {
   3.7540233663375263`*^9, 3.7540234438714533`*^9}, {3.7540234759831657`*^9, 
   3.754023617436458*^9}, {3.75402368429877*^9, 3.754023760119609*^9}, {
   3.754023808826668*^9, 3.754023869545535*^9}, {3.754023911290193*^9, 
   3.754023978879448*^9}, {3.754024282052266*^9, 3.754024313580803*^9}, {
   3.754024547049345*^9, 3.7540245994799223`*^9}, {3.754025460239439*^9, 
   3.7540255983227377`*^9}, {3.7540258137850018`*^9, 3.754025978711053*^9}, {
   3.754026038895108*^9, 3.754026081342535*^9}, {3.754026129685459*^9, 
   3.75402615849335*^9}, {3.7540262434835052`*^9, 3.754026287097475*^9}, {
   3.754026322980064*^9, 3.754026368626458*^9}, {3.75402640305891*^9, 
   3.754026487825637*^9}, {3.754026669101832*^9, 3.7540267121343517`*^9}, 
   3.7540400434692297`*^9, 3.754040480622787*^9, {3.75404054710104*^9, 
   3.75404054777276*^9}, {3.754040779169834*^9, 3.7540408894011106`*^9}, {
   3.7540516192312183`*^9, 3.754051646630447*^9}, {3.754114193013981*^9, 
   3.75411420576961*^9}, {3.7541155028678617`*^9, 3.754115517689828*^9}, {
   3.754116116322241*^9, 3.754116117185795*^9}, {3.754117779766054*^9, 
   3.75411778870254*^9}, {3.754117819301795*^9, 3.754117887518787*^9}, {
   3.7542831537385483`*^9, 3.7542831953926773`*^9}, {3.7558451061297607`*^9, 
   3.755845132041484*^9}, {3.7558596007652903`*^9, 3.7558596124847813`*^9}, {
   3.761284047822206*^9, 3.7612840481560087`*^9}, {3.761285081877398*^9, 
   3.7612851055151243`*^9}, {3.761285948779154*^9, 
   3.761285957698354*^9}},ExpressionUUID->"4776e7ad-a76c-49e4-b3e9-\
6cbde6d13ec3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Output", " ", "strains"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"simplifyTimes", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "180"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"assumptions", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Variables", "[", 
        RowBox[{"Level", "[", 
         RowBox[{"\[Epsilon]\[Kappa]", ",", 
          RowBox[{"{", 
           RowBox[{"-", "2"}], "}"}]}], "]"}], "]"}], " ", "\[Element]", " ", 
       "Reals"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", " ", "@", " ", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"opt1", " ", "=", " ", 
     RowBox[{"Quiet", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{"\[Epsilon]\[Kappa]", ",", 
        RowBox[{"TimeConstraint", "\[Rule]", "simplifyTimes"}], ",", " ", 
        RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"opt1", " ", "//", " ", "Dimensions"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteToFile", "[", 
     RowBox[{"\"\<ek_val.txt\>\"", ",", " ", 
      RowBox[{"OptimizeExpressionToC", "[", "opt1", "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"opt2", " ", "=", " ", 
     RowBox[{"Quiet", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"opt1", ",", "xlocal"}], "]"}], ",", 
        RowBox[{"TimeConstraint", "\[Rule]", "simplifyTimes"}], ",", " ", 
        RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"opt2", " ", "//", " ", "Dimensions"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteToFile", "[", 
     RowBox[{"\"\<ek_valgrad.txt\>\"", ",", " ", 
      RowBox[{"OptimizeExpressionToC", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"opt1", ",", "opt2"}], "}"}], ",", " ", "True"}], "]"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"opt3", " ", "=", " ", 
     RowBox[{"Quiet", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"opt2", ",", "xlocal"}], "]"}], ",", 
        RowBox[{"TimeConstraint", "\[Rule]", "simplifyTimes"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"opt3", " ", "//", " ", "Dimensions"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteToFile", "[", 
     RowBox[{"\"\<ek_valgradhess.txt\>\"", ",", " ", 
      RowBox[{"OptimizeExpressionToC", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"opt1", ",", "opt2", ",", " ", "opt3"}], "}"}], ",", " ", 
        "True"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Beep", "[", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.754032175212368*^9, 3.754032198551841*^9}, {
   3.754033064957539*^9, 3.754033067277697*^9}, {3.754033224746778*^9, 
   3.754033345432867*^9}, {3.754033383569584*^9, 3.754033434288007*^9}, {
   3.7540336403658943`*^9, 3.754033640742869*^9}, {3.754037019002068*^9, 
   3.7540370292736397`*^9}, {3.7540373001657877`*^9, 3.754037312652113*^9}, 
   3.7540373989501762`*^9, {3.754037599233857*^9, 3.754037626481627*^9}, {
   3.754037704360797*^9, 3.754037894670238*^9}, {3.754038001079235*^9, 
   3.754038001588687*^9}, {3.7540381456990137`*^9, 3.754038224514159*^9}, {
   3.754038257410974*^9, 3.754038257848946*^9}, {3.754040025674768*^9, 
   3.75404002796369*^9}, {3.754040894895322*^9, 3.7540409311501827`*^9}, {
   3.75404118086233*^9, 3.7540411911237307`*^9}, 3.7540416773419037`*^9, {
   3.754042049651032*^9, 3.754042049794258*^9}, {3.754056098934525*^9, 
   3.754056104107953*^9}, {3.7541112994236526`*^9, 3.7541113330742407`*^9}, {
   3.7541115167581263`*^9, 3.754111516796309*^9}, {3.754111910274416*^9, 
   3.754111918824725*^9}, {3.754313825499147*^9, 3.75431384945665*^9}, {
   3.76128408226604*^9, 3.7612841539609632`*^9}, 3.761284371118311*^9, {
   3.761284495235053*^9, 3.7612845462025633`*^9}, 
   3.761284599362053*^9},ExpressionUUID->"db2d1574-3286-468b-8744-\
a23c0c930e49"],

Cell[BoxData[
 RowBox[{"{", "6", "}"}]], "Output",
 CellChangeTimes->{3.75404167919634*^9, 3.75404210721097*^9, 
  3.754054415521418*^9, 3.754111329836998*^9, 3.754111531922576*^9, 
  3.754117933522828*^9, 3.754313859378401*^9, 3.755845161474073*^9, 
  3.761284179208387*^9, 3.761284637623682*^9, 3.7612851540901203`*^9, 
  3.761285238211226*^9, 3.761285281992118*^9, 
  3.761285978480341*^9},ExpressionUUID->"c70176b4-a4bc-40c5-9579-\
30d7323cfd2d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "18"}], "}"}]], "Output",
 CellChangeTimes->{3.75404167919634*^9, 3.75404210721097*^9, 
  3.754054415521418*^9, 3.754111329836998*^9, 3.754111531922576*^9, 
  3.754117933522828*^9, 3.754313859378401*^9, 3.755845161474073*^9, 
  3.761284179208387*^9, 3.761284637623682*^9, 3.7612851540901203`*^9, 
  3.761285238211226*^9, 3.761285281992118*^9, 
  3.7612861593800287`*^9},ExpressionUUID->"90110604-685b-40b0-ae54-\
0d762c46187c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "18", ",", "18"}], "}"}]], "Output",
 CellChangeTimes->{3.75404167919634*^9, 3.75404210721097*^9, 
  3.754054415521418*^9, 3.754111329836998*^9, 3.754111531922576*^9, 
  3.754117933522828*^9, 3.754313859378401*^9, 3.755845161474073*^9, 
  3.761284179208387*^9, 3.761284637623682*^9, 3.7612851540901203`*^9, 
  3.761285238211226*^9, 3.761285281992118*^9, 
  3.7612863615486383`*^9},ExpressionUUID->"489e6f78-90ba-41b9-8181-\
6231e27deff5"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7541117150554028`*^9, 3.754111717162174*^9}, 
   3.754111909208987*^9},ExpressionUUID->"83828bfb-ee37-4639-8b6c-\
321bc715f6f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "MAKE", " ", "SOME", " ", "TEST", " ", "ENERGY", " ", "AND", " ", "OUTPUT",
     " ", "ALSO", " ", "PSI", 
    RowBox[{"(", "ek", ")"}], " ", "AND", " ", "DERIVATIVES"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"tr", "^", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{"eps", "-", "I"}], ")"}]}], " ", "+", " ", 
    RowBox[{"tr", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"eps", "-", "I"}], ")"}], "^", "2"}], ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"tr", "^", "2"}], 
     RowBox[{"(", "kappa", ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"det", "^", "2"}], 
     RowBox[{"(", "kappa", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ek", " ", "=", " ", 
     RowBox[{"FunctionArray", "[", 
      RowBox[{"\"\<ekdof\>\"", ",", "6"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EE", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ek", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"ek", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ek", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"ek", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}], " ", "-", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KK", " ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ek", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{"ek", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ek", "[", 
          RowBox[{"[", "5", "]"}], "]"}], ",", 
         RowBox[{"ek", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]", " ", "=", " ", 
     RowBox[{
      RowBox[{"a0", " ", 
       RowBox[{
        RowBox[{"Tr", "[", "EE", "]"}], "^", "2"}]}], "+", 
      RowBox[{"a1", " ", 
       RowBox[{"Tr", "[", 
        RowBox[{"EE", ".", "EE"}], "]"}]}], " ", "+", " ", 
      RowBox[{"b0", " ", 
       RowBox[{
        RowBox[{"Tr", "[", "KK", "]"}], "^", "2"}]}], " ", "+", " ", 
      RowBox[{"b1", " ", 
       RowBox[{
        RowBox[{"Det", "[", "KK", "]"}], "^", "2"}]}]}]}], " ", 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.75403383236524*^9, 3.754033850753985*^9}, {
   3.75403827019179*^9, 3.7540382835192347`*^9}, {3.754038430374539*^9, 
   3.754038511116502*^9}, {3.754038735075407*^9, 3.754038909215828*^9}, {
   3.754039108246768*^9, 3.754039177548894*^9}, 3.754039241125738*^9, {
   3.754040587083583*^9, 3.7540405998519077`*^9}, {3.754040687579975*^9, 
   3.754040719234311*^9}, 3.754041211196226*^9, {3.754042060049485*^9, 
   3.7540420653762827`*^9}, {3.754125825788766*^9, 3.754125828547031*^9}, {
   3.754131899686879*^9, 3.7541319003028097`*^9}, {3.761286983033908*^9, 
   3.761287023952009*^9}},ExpressionUUID->"34057c6a-bdd5-48dc-bdfb-\
ca87f3c47be6"],

Cell[BoxData[{
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"\[Psi]", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a0", "\[Rule]", "10"}], ",", " ", 
      RowBox[{"a1", "\[Rule]", "10"}], ",", " ", 
      RowBox[{"b0", "\[Rule]", "1"}], ",", " ", 
      RowBox[{"b1", "\[Rule]", 
       RowBox[{"1", "/", "100"}]}], ",", " ", 
      RowBox[{"ek0", "\[Rule]", "i"}], ",", 
      RowBox[{"ek1", "\[Rule]", "0"}], ",", 
      RowBox[{"ek2", "\[Rule]", "1"}], ",", 
      RowBox[{"ek3", "\[Rule]", "0"}], ",", 
      RowBox[{"ek4", "\[Rule]", "0"}], ",", 
      RowBox[{"ek5", "\[Rule]", "0"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0.5", ",", "1.5"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"\[Psi]", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a0", "\[Rule]", "10"}], ",", " ", 
      RowBox[{"a1", "\[Rule]", "10"}], ",", " ", 
      RowBox[{"b0", "\[Rule]", "1"}], ",", " ", 
      RowBox[{"b1", "\[Rule]", 
       RowBox[{"1", "/", "100"}]}], ",", " ", 
      RowBox[{"ek0", "\[Rule]", "1"}], ",", 
      RowBox[{"ek1", "\[Rule]", "i"}], ",", 
      RowBox[{"ek2", "\[Rule]", "1"}], ",", 
      RowBox[{"ek3", "\[Rule]", "0"}], ",", 
      RowBox[{"ek4", "\[Rule]", "0"}], ",", 
      RowBox[{"ek5", "\[Rule]", "0"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"-", "1.0"}], ",", "1.0"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"\[Psi]", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a0", "\[Rule]", "10"}], ",", " ", 
      RowBox[{"a1", "\[Rule]", "10"}], ",", " ", 
      RowBox[{"b0", "\[Rule]", "1"}], ",", " ", 
      RowBox[{"b1", "\[Rule]", 
       RowBox[{"1", "/", "100"}]}], ",", " ", 
      RowBox[{"ek0", "\[Rule]", "1"}], ",", 
      RowBox[{"ek1", "\[Rule]", "0"}], ",", 
      RowBox[{"ek2", "\[Rule]", "1"}], ",", 
      RowBox[{"ek3", "\[Rule]", "i"}], ",", 
      RowBox[{"ek4", "\[Rule]", "0"}], ",", 
      RowBox[{"ek5", "\[Rule]", "0"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"-", "30"}], ",", "30"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"\[Psi]", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a0", "\[Rule]", "10"}], ",", " ", 
      RowBox[{"a1", "\[Rule]", "10"}], ",", " ", 
      RowBox[{"b0", "\[Rule]", "1"}], ",", " ", 
      RowBox[{"b1", "\[Rule]", 
       RowBox[{"1", "/", "100"}]}], ",", " ", 
      RowBox[{"ek0", "\[Rule]", "1"}], ",", 
      RowBox[{"ek1", "\[Rule]", "0"}], ",", 
      RowBox[{"ek2", "\[Rule]", "1"}], ",", 
      RowBox[{"ek3", "\[Rule]", "0"}], ",", 
      RowBox[{"ek4", "\[Rule]", "i"}], ",", 
      RowBox[{"ek5", "\[Rule]", "0"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"-", 
      RowBox[{"Sqrt", "[", "30", "]"}]}], ",", 
     RowBox[{"Sqrt", "[", "30", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"\[Psi]", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a0", "\[Rule]", "10"}], ",", " ", 
      RowBox[{"a1", "\[Rule]", "10"}], ",", " ", 
      RowBox[{"b0", "\[Rule]", "1"}], ",", " ", 
      RowBox[{"b1", "\[Rule]", 
       RowBox[{"1", "/", "100"}]}], ",", " ", 
      RowBox[{"ek0", "\[Rule]", "1"}], ",", 
      RowBox[{"ek1", "\[Rule]", "0"}], ",", 
      RowBox[{"ek2", "\[Rule]", "1"}], ",", 
      RowBox[{"ek3", "\[Rule]", "0"}], ",", 
      RowBox[{"ek4", "\[Rule]", "i"}], ",", 
      RowBox[{"ek5", "\[Rule]", "i"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"-", "30"}], ",", "30"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.755941813949402*^9, 3.755942105002055*^9}, {
  3.7559421531453876`*^9, 
  3.755942203655497*^9}},ExpressionUUID->"eb0f7c7c-29e0-4630-8951-\
518f9428c379"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"simplifyTimes", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "180"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"assumptions", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Variables", "[", 
      RowBox[{"Level", "[", 
       RowBox[{"\[Psi]", " ", ",", 
        RowBox[{"{", 
         RowBox[{"-", "2"}], "}"}]}], "]"}], "]"}], " ", "\[Element]", " ", 
     "Reals"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", " ", "@", " ", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opt1", " ", "=", " ", 
   RowBox[{"Quiet", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"{", "\[Psi]", "}"}], " ", ",", 
      RowBox[{"TimeConstraint", "\[Rule]", "simplifyTimes"}], ",", " ", 
      RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteToFile", "[", 
   RowBox[{"\"\<psi_val.txt\>\"", ",", " ", 
    RowBox[{"OptimizeExpressionToC", "[", "opt1", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opt2", " ", "=", " ", 
   RowBox[{"Quiet", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{"\[Psi]", ",", "ek"}], "]"}], ",", 
      RowBox[{"TimeConstraint", "\[Rule]", "simplifyTimes"}], ",", " ", 
      RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteToFile", "[", 
   RowBox[{"\"\<psi_grad.txt\>\"", ",", " ", 
    RowBox[{"OptimizeExpressionToC", "[", "opt2", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opt3", " ", "=", " ", 
   RowBox[{"Quiet", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{"opt2", ",", "ek"}], "]"}], ",", 
      RowBox[{"TimeConstraint", "\[Rule]", "simplifyTimes"}], ",", " ", 
      RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteToFile", "[", 
   RowBox[{"\"\<psi_gradhess.txt\>\"", ",", " ", 
    RowBox[{"OptimizeExpressionToC", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"opt2", ",", "opt3"}], "}"}], ",", "True"}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.754038922850649*^9, 3.754038996535083*^9}, {
   3.754039043295809*^9, 3.7540390453819723`*^9}, {3.754039076574335*^9, 
   3.754039098261621*^9}, {3.754039188030126*^9, 3.754039206379929*^9}, {
   3.7540392609374723`*^9, 3.754039289859956*^9}, {3.754039395692704*^9, 
   3.7540394006826563`*^9}, 3.754039450610968*^9, 3.75404061545963*^9, 
   3.754040645580265*^9, {3.7540411573425083`*^9, 3.754041167370934*^9}, {
   3.754041221987308*^9, 3.7540412342043047`*^9}, {3.754042093303154*^9, 
   3.7540420996119623`*^9}, {3.754053868043047*^9, 3.754053961720331*^9}, {
   3.754054124503242*^9, 3.754054132021907*^9}, {3.754054268116549*^9, 
   3.75405426948269*^9}, 3.754054439148459*^9, {3.754056114580714*^9, 
   3.754056114893602*^9}, {3.7541094834748783`*^9, 3.754109563441243*^9}, {
   3.7541108269628077`*^9, 3.754110830921287*^9}, {3.761284617888323*^9, 
   3.7612846807361*^9}},ExpressionUUID->"ad57a804-d84a-4d8b-b266-\
2a66855df4a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"tests", " ", "collecting", " ", "powers"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "might", " ", "be", " ", "required", " ", "for", " ", "speed", " ", 
       "up"}], ".."}], "  ", "bc", " ", "optimizeexpressiontoc", " ", "fails",
      " ", "for", " ", 
     RowBox[{"e", ".", "g", ".", " ", 
      RowBox[{
       RowBox[{"(", "ab", ")"}], "^", "2"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"combinePowers", "[", "expr_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Inactivate", "[", 
      RowBox[{"expr", ",", "Power"}], "]"}], "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Inactive", "[", "Power", "]"}], "[", 
          RowBox[{"z1_", ",", "n_"}], "]"}], " ", 
         RowBox[{
          RowBox[{"Inactive", "[", "Power", "]"}], "[", 
          RowBox[{"z2_", ",", "m_"}], "]"}]}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Abs", "[", "m", "]"}], "\[Equal]", "n"}], ")"}]}], 
      "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Inactive", "[", "Power", "]"}], "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z1", " ", 
          RowBox[{"Power", "[", 
           RowBox[{"z2", ",", 
            RowBox[{"Sign", "[", "m", "]"}]}], "]"}]}], ")"}], ",", "n"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OptimizeExpressionToC", "[", "  ", 
     RowBox[{"{", 
      RowBox[{"Inactivate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "/", "y"}], ")"}], "^", "2"}], ",", " ", "Power"}], 
       "]"}], "}"}], " ", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"combinePowers", "[", "opt1", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"combinePowers", "[", 
     RowBox[{"Grad", "[", 
      RowBox[{"opt1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ek", "[", "0", "]"}], ",", 
         RowBox[{"ek", "[", "1", "]"}]}], "}"}]}], "]"}], " ", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OptimizeExpressionToC", "[", "  ", 
     RowBox[{"{", 
      RowBox[{"Simplify", " ", "@", " ", 
       RowBox[{"combinePowers", "[", "opt1", "]"}]}], "}"}], " ", "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.75586161660637*^9, 3.755861617318481*^9}, {
  3.755861649458168*^9, 3.755861656959593*^9}, {3.755861689448842*^9, 
  3.755861760295471*^9}, {3.755861839513178*^9, 3.755862008827553*^9}, {
  3.755862168771591*^9, 
  3.7558622128175373`*^9}},ExpressionUUID->"409b12fd-5167-44d1-93b6-\
286f6585bbfd"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.763356219028224*^9},ExpressionUUID->"9cc917c8-d170-4c20-ad91-\
c63508415c47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"data", "-", 
    RowBox[{"driven", " ", "energy", "  ", "NEW"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"eta1D", "[", 
      RowBox[{"x_", ",", "i_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Symbol", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "C", "]"}], "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", 
           RowBox[{"ToString", "[", "#", "]"}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "#"]}], "&"}], " ", "/@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], " ", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eta2D", "[", 
     RowBox[{"x_", ",", "i_", ",", "j_"}], "]"}], " ", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Symbol", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "C", "]"}], "<>", 
         RowBox[{"ToString", "[", "i", "]"}], "<>", 
         RowBox[{"ToString", "[", "j", "]"}], "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]], 
       SuperscriptBox[
        RowBox[{"x", "[", 
         RowBox[{"[", 
          RowBox[{"j", "+", "1"}], "]"}], "]"}], 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]]}], "&"}], " ", "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}], "}"}]}]}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coords2D", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "5"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psi", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"C0", " ", "+", " ", 
     RowBox[{"Total", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"eta1D", "[", 
         RowBox[{"x", ",", "i"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], "]"}], " ", "+", 
     " ", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"eta2D", "[", 
          RowBox[{"x", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], "/@", " ", 
        "coords2D"}], ",", " ", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]\[Kappa]", " ", "=", " ", 
     RowBox[{"FunctionArray", "[", 
      RowBox[{"\"\<ek\>\"", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]\[Kappa]shift", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"same", " ", "shift", " ", "as", " ", "in", " ", "python"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]\[Kappa]normed", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "\[Epsilon]\[Kappa]", " ", "-", " ", "\[Epsilon]\[Kappa]shift"}], 
       ")"}], "/", 
      RowBox[{"FunctionArray", "[", 
       RowBox[{"\"\<ekscale\>\"", ",", "6"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simplifyTimes", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "180"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"assumptions", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Variables", "[", 
        RowBox[{"Level", "[", 
         RowBox[{
          RowBox[{"psi", "[", "\[Epsilon]\[Kappa]normed", "]"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"-", "2"}], "}"}]}], "]"}], "]"}], " ", "\[Element]", " ", 
       "Reals"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", " ", "@", " ", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"opt1", " ", "=", " ", 
     RowBox[{"Quiet", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"psi", "[", "\[Epsilon]\[Kappa]normed", "]"}], " ", ",", 
        RowBox[{"TimeConstraint", "\[Rule]", "simplifyTimes"}], ",", " ", 
        RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteToFile", "[", 
     RowBox[{"\"\<psi_val.txt\>\"", ",", " ", 
      RowBox[{"OptimizeExpressionToC", "[", 
       RowBox[{"{", "opt1", "}"}], "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"opt2", " ", "=", " ", 
     RowBox[{"Quiet", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"opt1", ",", "\[Epsilon]\[Kappa]"}], "]"}], ",", 
        RowBox[{"TimeConstraint", "\[Rule]", "simplifyTimes"}], ",", " ", 
        RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteToFile", "[", 
     RowBox[{"\"\<psi_grad.txt\>\"", ",", " ", 
      RowBox[{"OptimizeExpressionToC", "[", "opt2", "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"opt3", " ", "=", " ", 
     RowBox[{"Quiet", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"opt2", ",", "\[Epsilon]\[Kappa]"}], "]"}], ",", 
        RowBox[{"TimeConstraint", "\[Rule]", "simplifyTimes"}], ",", " ", 
        RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteToFile", "[", 
     RowBox[{"\"\<psi_gradhess.txt\>\"", ",", " ", 
      RowBox[{"OptimizeExpressionToC", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"opt2", ",", "opt3"}], "}"}], ",", "True"}], "]"}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.763359331243696*^9, 3.763359366682631*^9}, {
  3.763359863845834*^9, 3.763359893836795*^9}, {3.7633599529576406`*^9, 
  3.763360010339497*^9}, {3.7633600852993*^9, 3.7633601003731003`*^9}, {
  3.763360138355579*^9, 3.7633601408424473`*^9}, {3.763360182225896*^9, 
  3.763360203487967*^9}},ExpressionUUID->"61d2e58f-b248-4896-83fb-\
6b9b362760a7"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7633598694757843`*^9, 
  3.7633598695330763`*^9}},ExpressionUUID->"a870e677-4e72-4fb1-a7d3-\
c6df82a69f7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"data", "-", 
    RowBox[{"driven", " ", "energy", "  ", "OLD"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nprimitives", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nprimitivecoeffs", " ", "=", " ", "5"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cpsi", " ", "=", " ", 
     RowBox[{"FunctionArray", "[", 
      RowBox[{"\"\<C\>\"", ",", 
       RowBox[{"1", "+", 
        RowBox[{"nprimitives", "*", "nprimitivecoeffs"}]}]}], "]"}]}], ";"}], 
   " ", 
   RowBox[{"(*", " ", 
    RowBox[{"constant", " ", "+", " ", 
     RowBox[{
     "6", " ", "primitives", " ", "with", " ", "each", " ", "5", " ", 
      "coeffs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]\[Kappa]", " ", "=", " ", 
     RowBox[{"FunctionArray", "[", 
      RowBox[{"\"\<ek\>\"", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]\[Kappa]normed", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Epsilon]\[Kappa]", " ", "-", " ", 
        RowBox[{"FunctionArray", "[", 
         RowBox[{"\"\<ekshift\>\"", ",", "6"}], "]"}]}], ")"}], "/", 
      RowBox[{"FunctionArray", "[", 
       RowBox[{"\"\<ekscale\>\"", ",", "6"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Eta]", "[", 
      RowBox[{"Ceta_", ",", " ", "X_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Ceta", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"Ceta", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "X"}], "+", 
      RowBox[{
       RowBox[{"Ceta", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"X", "^", "2"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Ceta", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"X", "^", "3"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Ceta", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"X", "^", "4"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]", "[", 
      RowBox[{"Cpsi_", ",", " ", "ek_"}], "]"}], " ", ":=", " ", 
     RowBox[{"s", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cpsi", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "+", 
        RowBox[{"Total", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\[Eta]", "[", 
            RowBox[{
             RowBox[{"Cpsi", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", "+", 
                 RowBox[{"5", "*", "i"}]}], ";;", 
                RowBox[{"2", "+", 
                 RowBox[{"5", "*", 
                  RowBox[{"(", 
                   RowBox[{"i", "+", "1"}], ")"}]}], "-", "1"}]}], "]"}], 
              "]"}], ",", " ", 
             RowBox[{"ek", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], "]"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"Cpsi", ",", "\[Epsilon]\[Kappa]normed"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simplifyTimes", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "180"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"assumptions", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Variables", "[", 
        RowBox[{"Level", "[", 
         RowBox[{
          RowBox[{"\[Psi]", "[", 
           RowBox[{"Cpsi", ",", "\[Epsilon]\[Kappa]normed"}], "]"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"-", "2"}], "}"}]}], "]"}], "]"}], " ", "\[Element]", " ", 
       "Reals"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", " ", "@", " ", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"opt1", " ", "=", " ", 
     RowBox[{"Quiet", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"Cpsi", ",", "\[Epsilon]\[Kappa]normed"}], "]"}], "}"}], 
        " ", ",", 
        RowBox[{"TimeConstraint", "\[Rule]", "simplifyTimes"}], ",", " ", 
        RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteToFile", "[", 
     RowBox[{"\"\<psi_val.txt\>\"", ",", " ", 
      RowBox[{"OptimizeExpressionToC", "[", "opt1", "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"opt2", " ", "=", " ", 
     RowBox[{"Quiet", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{
          RowBox[{"\[Psi]", "[", 
           RowBox[{"Cpsi", ",", "\[Epsilon]\[Kappa]normed"}], "]"}], ",", 
          "\[Epsilon]\[Kappa]"}], "]"}], ",", 
        RowBox[{"TimeConstraint", "\[Rule]", "simplifyTimes"}], ",", " ", 
        RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteToFile", "[", 
     RowBox[{"\"\<psi_grad.txt\>\"", ",", " ", 
      RowBox[{"OptimizeExpressionToC", "[", "opt2", "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"opt3", " ", "=", " ", 
     RowBox[{"Quiet", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"opt2", ",", "\[Epsilon]\[Kappa]"}], "]"}], ",", 
        RowBox[{"TimeConstraint", "\[Rule]", "simplifyTimes"}], ",", " ", 
        RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteToFile", "[", 
     RowBox[{"\"\<psi_gradhess.txt\>\"", ",", " ", 
      RowBox[{"OptimizeExpressionToC", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"opt2", ",", "opt3"}], "}"}], ",", "True"}], "]"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Debugging", " ", "/", " ", "Experimenting"}], " ", "Zone"}], 
    " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.75411126019691*^9, 3.754111267334103*^9}, {
   3.7558559357868423`*^9, 3.7558560539307327`*^9}, {3.755856092546006*^9, 
   3.755856168471343*^9}, {3.755856389181508*^9, 3.755856393156547*^9}, {
   3.7558564876439447`*^9, 3.755856536475424*^9}, {3.755856572963526*^9, 
   3.755856629875971*^9}, {3.755856780306368*^9, 3.755856874310699*^9}, {
   3.755856975005465*^9, 3.755857055507648*^9}, {3.755857103011653*^9, 
   3.755857194314335*^9}, {3.75585736724963*^9, 3.755857409752245*^9}, {
   3.755857489431953*^9, 3.75585771451746*^9}, {3.7558577493475723`*^9, 
   3.7558577523555527`*^9}, {3.755857894957049*^9, 3.7558579325137987`*^9}, {
   3.755857969457891*^9, 3.755858035520541*^9}, {3.755858176567773*^9, 
   3.7558581792483873`*^9}, {3.755858710351268*^9, 3.7558587434472647`*^9}, {
   3.755859035886235*^9, 3.7558591418492203`*^9}, {3.755859629886897*^9, 
   3.7558596504678907`*^9}, {3.7558597379085407`*^9, 3.755859830832266*^9}, {
   3.755859903096593*^9, 3.755859941064476*^9}, {3.755860179339991*^9, 
   3.7558602258832293`*^9}, {3.755860398313758*^9, 3.755860571174759*^9}, {
   3.755860614465536*^9, 3.7558607337159367`*^9}, {3.755860833395479*^9, 
   3.75586086426725*^9}, {3.755861174063393*^9, 3.7558612210547237`*^9}, {
   3.75586133025352*^9, 3.755861330920206*^9}, {3.7558613650391827`*^9, 
   3.7558613807885323`*^9}, 3.755861424217703*^9, {3.75586223017262*^9, 
   3.755862230938295*^9}, {3.7558622891083717`*^9, 3.755862348544795*^9}, {
   3.7558623835209312`*^9, 3.755862384743754*^9}, {3.755866764426113*^9, 
   3.755866765672069*^9}, {3.755866799932543*^9, 3.75586681772995*^9}, {
   3.755867831616547*^9, 3.7558678362176037`*^9}, {3.761284736366868*^9, 
   3.761284844733822*^9}, {3.7633593279406443`*^9, 3.763359328820022*^9}, {
   3.763359437073978*^9, 3.763359442393756*^9}, {3.763359766781715*^9, 
   3.763359813581287*^9}, 
   3.763359861396901*^9},ExpressionUUID->"3e7e2a88-e90f-4b35-8ccc-\
0a8b67bcba39"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"psi", "[", "x", "]"}]}]], "Input",
 CellChangeTimes->{
  3.763357197723852*^9, {3.7633572803245077`*^9, 3.763357296059574*^9}, {
   3.7633573457393*^9, 3.763357412907071*^9}, {3.763357444970701*^9, 
   3.76335744573246*^9}, {3.763357498818316*^9, 3.763357593747417*^9}, 
   3.76335773282386*^9, {3.763357772151532*^9, 3.763357791703197*^9}, {
   3.76335791713402*^9, 3.763357946316532*^9}, {3.763357990366625*^9, 
   3.763358025005121*^9}, {3.7633580623976707`*^9, 3.763358102067155*^9}, {
   3.7633582434326344`*^9, 3.763358284984235*^9}, {3.763358340127791*^9, 
   3.763358381639016*^9}, {3.763358414273407*^9, 3.763358573437722*^9}, {
   3.7633586123198*^9, 3.763358828913397*^9}, {3.763359081382806*^9, 
   3.763359240827609*^9}, 
   3.763359340550156*^9},ExpressionUUID->"21e8f103-87d1-4bf6-9114-\
992f7095dff3"],

Cell[BoxData[
 RowBox[{"C0", "+", 
  RowBox[{"C11", " ", 
   RowBox[{"x", "[", "1", "]"}]}], "+", 
  RowBox[{"C0111", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   RowBox[{"x", "[", "1", "]"}]}], "+", 
  RowBox[{"C0121", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "2"], " ", 
   RowBox[{"x", "[", "1", "]"}]}], "+", 
  RowBox[{"C0131", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "3"], " ", 
   RowBox[{"x", "[", "1", "]"}]}], "+", 
  RowBox[{"C12", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "1", "]"}], "2"]}], "+", 
  RowBox[{"C0112", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "1", "]"}], "2"]}], "+", 
  RowBox[{"C0122", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "1", "]"}], "2"]}], "+", 
  RowBox[{"C13", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "1", "]"}], "3"]}], "+", 
  RowBox[{"C0113", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "1", "]"}], "3"]}], "+", 
  RowBox[{"C14", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "1", "]"}], "4"]}], "+", 
  RowBox[{"C21", " ", 
   RowBox[{"x", "[", "2", "]"}]}], "+", 
  RowBox[{"C0211", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   RowBox[{"x", "[", "2", "]"}]}], "+", 
  RowBox[{"C0221", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "2"], " ", 
   RowBox[{"x", "[", "2", "]"}]}], "+", 
  RowBox[{"C0231", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "3"], " ", 
   RowBox[{"x", "[", "2", "]"}]}], "+", 
  RowBox[{"C22", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"C0212", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"C0222", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"C23", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "3"]}], "+", 
  RowBox[{"C0213", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "3"]}], "+", 
  RowBox[{"C24", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "4"]}], "+", 
  RowBox[{"C31", " ", 
   RowBox[{"x", "[", "3", "]"}]}], "+", 
  RowBox[{"C0311", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   RowBox[{"x", "[", "3", "]"}]}], "+", 
  RowBox[{"C0321", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "2"], " ", 
   RowBox[{"x", "[", "3", "]"}]}], "+", 
  RowBox[{"C0331", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "3"], " ", 
   RowBox[{"x", "[", "3", "]"}]}], "+", 
  RowBox[{"C2311", " ", 
   RowBox[{"x", "[", "2", "]"}], " ", 
   RowBox[{"x", "[", "3", "]"}]}], "+", 
  RowBox[{"C2321", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "2"], " ", 
   RowBox[{"x", "[", "3", "]"}]}], "+", 
  RowBox[{"C2331", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "3"], " ", 
   RowBox[{"x", "[", "3", "]"}]}], "+", 
  RowBox[{"C32", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{"C0312", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{"C0322", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{"C2312", " ", 
   RowBox[{"x", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{"C2322", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{"C33", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"C0313", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"C2313", " ", 
   RowBox[{"x", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"C34", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "4"]}], "+", 
  RowBox[{"C41", " ", 
   RowBox[{"x", "[", "4", "]"}]}], "+", 
  RowBox[{"C0411", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   RowBox[{"x", "[", "4", "]"}]}], "+", 
  RowBox[{"C0421", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "2"], " ", 
   RowBox[{"x", "[", "4", "]"}]}], "+", 
  RowBox[{"C0431", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "3"], " ", 
   RowBox[{"x", "[", "4", "]"}]}], "+", 
  RowBox[{"C2411", " ", 
   RowBox[{"x", "[", "2", "]"}], " ", 
   RowBox[{"x", "[", "4", "]"}]}], "+", 
  RowBox[{"C2421", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "2"], " ", 
   RowBox[{"x", "[", "4", "]"}]}], "+", 
  RowBox[{"C2431", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "3"], " ", 
   RowBox[{"x", "[", "4", "]"}]}], "+", 
  RowBox[{"C3411", " ", 
   RowBox[{"x", "[", "3", "]"}], " ", 
   RowBox[{"x", "[", "4", "]"}]}], "+", 
  RowBox[{"C3421", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "2"], " ", 
   RowBox[{"x", "[", "4", "]"}]}], "+", 
  RowBox[{"C3431", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "3"], " ", 
   RowBox[{"x", "[", "4", "]"}]}], "+", 
  RowBox[{"C42", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{"C0412", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{"C0422", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{"C2412", " ", 
   RowBox[{"x", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{"C2422", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{"C3412", " ", 
   RowBox[{"x", "[", "3", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{"C3422", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{"C43", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "4", "]"}], "3"]}], "+", 
  RowBox[{"C0413", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "4", "]"}], "3"]}], "+", 
  RowBox[{"C2413", " ", 
   RowBox[{"x", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "4", "]"}], "3"]}], "+", 
  RowBox[{"C3413", " ", 
   RowBox[{"x", "[", "3", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "4", "]"}], "3"]}], "+", 
  RowBox[{"C44", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"C51", " ", 
   RowBox[{"x", "[", "5", "]"}]}], "+", 
  RowBox[{"C0511", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   RowBox[{"x", "[", "5", "]"}]}], "+", 
  RowBox[{"C0521", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "2"], " ", 
   RowBox[{"x", "[", "5", "]"}]}], "+", 
  RowBox[{"C0531", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "3"], " ", 
   RowBox[{"x", "[", "5", "]"}]}], "+", 
  RowBox[{"C2511", " ", 
   RowBox[{"x", "[", "2", "]"}], " ", 
   RowBox[{"x", "[", "5", "]"}]}], "+", 
  RowBox[{"C2521", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "2"], " ", 
   RowBox[{"x", "[", "5", "]"}]}], "+", 
  RowBox[{"C2531", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "3"], " ", 
   RowBox[{"x", "[", "5", "]"}]}], "+", 
  RowBox[{"C3511", " ", 
   RowBox[{"x", "[", "3", "]"}], " ", 
   RowBox[{"x", "[", "5", "]"}]}], "+", 
  RowBox[{"C3521", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "2"], " ", 
   RowBox[{"x", "[", "5", "]"}]}], "+", 
  RowBox[{"C3531", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "3"], " ", 
   RowBox[{"x", "[", "5", "]"}]}], "+", 
  RowBox[{"C52", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "5", "]"}], "2"]}], "+", 
  RowBox[{"C0512", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "5", "]"}], "2"]}], "+", 
  RowBox[{"C0522", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "0", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "5", "]"}], "2"]}], "+", 
  RowBox[{"C2512", " ", 
   RowBox[{"x", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "5", "]"}], "2"]}], "+", 
  RowBox[{"C2522", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "5", "]"}], "2"]}], "+", 
  RowBox[{"C3512", " ", 
   RowBox[{"x", "[", "3", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "5", "]"}], "2"]}], "+", 
  RowBox[{"C3522", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "3", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "5", "]"}], "2"]}], "+", 
  RowBox[{"C53", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "5", "]"}], "3"]}], "+", 
  RowBox[{"C0513", " ", 
   RowBox[{"x", "[", "0", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "5", "]"}], "3"]}], "+", 
  RowBox[{"C2513", " ", 
   RowBox[{"x", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "5", "]"}], "3"]}], "+", 
  RowBox[{"C3513", " ", 
   RowBox[{"x", "[", "3", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "5", "]"}], "3"]}], "+", 
  RowBox[{"C54", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "5", "]"}], "4"]}], "+", 
  RowBox[{"C61", " ", 
   RowBox[{"x", "[", "6", "]"}]}], "+", 
  RowBox[{"C62", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "6", "]"}], "2"]}], "+", 
  RowBox[{"C63", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "6", "]"}], "3"]}], "+", 
  RowBox[{"C64", " ", 
   SuperscriptBox[
    RowBox[{"x", "[", "6", "]"}], "4"]}]}]], "Output",
 CellChangeTimes->{
  3.7633592411325073`*^9},ExpressionUUID->"76bf3edd-c4ef-4ca6-895d-\
1d7cdf52750c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OptimizeExpressionToC", "[", 
  RowBox[{"{", 
   RowBox[{"psi", "[", "x", "]"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7633592748433857`*^9, 
  3.763359282077241*^9}},ExpressionUUID->"4bca066b-acf3-431e-afb2-\
0d90de032b54"],

Cell[BoxData["\<\"Real c1 = x(1);\\nReal c9 = x(0);\\nReal c16 = Power(c1,2);\
\\nReal c11 = Power(c9,2);\\nReal c21 = Power(c1,3);\\nReal c26 = \
x(2);\\nReal c14 = Power(c9,3);\\nReal c31 = Power(c26,2);\\nReal c35 = \
Power(c26,3);\\nReal c40 = x(3);\\nReal c49 = Power(c40,2);\\nReal c55 = \
Power(c40,3);\\nReal c61 = x(4);\\nReal c72 = Power(c61,2);\\nReal c80 = \
Power(c61,3);\\nReal c87 = x(5);\\nReal c98 = Power(c87,2);\\nReal c106 = \
Power(c87,3);\\nReal c113 = x(6);\\nout(0) = C0 + C11*c1 + C14*Power(c1,4) + \
C53*c106 + C0121*c1*c11 + C61*c113 + C62*Power(c113,2) + C63*Power(c113,3) + \
C64*Power(c113,4) + C0131*c1*c14 + C12*c16 + C0122*c11*c16 + C13*c21 + \
C21*c26 + C2513*c106*c26 + C0221*c11*c26 + C0231*c14*c26 + C24*Power(c26,4) + \
C22*c31 + C0222*c11*c31 + C23*c35 + C31*c40 + C3513*c106*c40 + C0321*c11*c40 \
+ C0331*c14*c40 + C2311*c26*c40 + C2321*c31*c40 + C2331*c35*c40 + \
C34*Power(c40,4) + C32*c49 + C0322*c11*c49 + C2312*c26*c49 + C2322*c31*c49 + \
C33*c55 + C2313*c26*c55 + C41*c61 + C0421*c11*c61 + C0431*c14*c61 + \
C2411*c26*c61 + C2421*c31*c61 + C2431*c35*c61 + C3411*c40*c61 + C3421*c49*c61 \
+ C3431*c55*c61 + C44*Power(c61,4) + C42*c72 + C0422*c11*c72 + C2412*c26*c72 \
+ C2422*c31*c72 + C3412*c40*c72 + C3422*c49*c72 + C43*c80 + C2413*c26*c80 + \
C3413*c40*c80 + C51*c87 + C0521*c11*c87 + C0531*c14*c87 + C2511*c26*c87 + \
C2521*c31*c87 + C2531*c35*c87 + C3511*c40*c87 + C3521*c49*c87 + C3531*c55*c87 \
+ C54*Power(c87,4) + C0111*c1*c9 + C0513*c106*c9 + C0112*c16*c9 + \
C0113*c21*c9 + C0211*c26*c9 + C0212*c31*c9 + C0213*c35*c9 + C0311*c40*c9 + \
C0312*c49*c9 + C0313*c55*c9 + C0411*c61*c9 + C0412*c72*c9 + C0413*c80*c9 + \
C0511*c87*c9 + C52*c98 + C0522*c11*c98 + C2512*c26*c98 + C2522*c31*c98 + \
C3512*c40*c98 + C3522*c49*c98 + C0512*c9*c98;\\n\"\>"], "Output",
 CellChangeTimes->{
  3.7633592824362297`*^9},ExpressionUUID->"10d18bf2-bbb1-4dc1-a1c8-\
5d290fc0eb6e"]
}, Open  ]]
},
WindowSize->{1869, 1145},
WindowMargins->{{0, Automatic}, {Automatic, 30}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 156, 3, 32, "Input", "ExpressionUUID" -> \
"ce7a8f21-2a7b-4df1-9a21-5d4ea3d14c5d"],
Cell[717, 25, 11661, 288, 608, "Input", "ExpressionUUID" -> \
"3612ea70-5f38-4e37-bd1b-6c0b5a9bdcae"],
Cell[12381, 315, 10396, 269, 650, "Input", "ExpressionUUID" -> \
"4776e7ad-a76c-49e4-b3e9-6cbde6d13ec3"],
Cell[CellGroupData[{
Cell[22802, 588, 4229, 92, 328, "Input", "ExpressionUUID" -> \
"db2d1574-3286-468b-8744-a23c0c930e49"],
Cell[27034, 682, 450, 8, 32, "Output", "ExpressionUUID" -> \
"c70176b4-a4bc-40c5-9579-30d7323cfd2d"],
Cell[27487, 692, 476, 9, 34, "Output", "ExpressionUUID" -> \
"90110604-685b-40b0-ae54-0d762c46187c"],
Cell[27966, 703, 487, 9, 34, "Output", "ExpressionUUID" -> \
"489e6f78-90ba-41b9-8181-6231e27deff5"]
}, Open  ]],
Cell[28468, 715, 177, 3, 32, "Input", "ExpressionUUID" -> \
"83828bfb-ee37-4639-8b6c-321bc715f6f6"],
Cell[28648, 720, 3423, 97, 147, "Input", "ExpressionUUID" -> \
"34057c6a-bdd5-48dc-bdfb-ca87f3c47be6"],
Cell[32074, 819, 3925, 104, 148, "Input", "ExpressionUUID" -> \
"eb0f7c7c-29e0-4630-8951-518f9428c379"],
Cell[36002, 925, 3297, 78, 218, "Input", "ExpressionUUID" -> \
"ad57a804-d84a-4d8b-b266-2a66855df4a3"],
Cell[39302, 1005, 2695, 75, 149, "Input", "ExpressionUUID" -> \
"409b12fd-5167-44d1-93b6-286f6585bbfd"],
Cell[42000, 1082, 147, 3, 55, "Input", "ExpressionUUID" -> \
"9cc917c8-d170-4c20-ad91-c63508415c47"],
Cell[42150, 1087, 7757, 211, 481, "Input", "ExpressionUUID" -> \
"61d2e58f-b248-4896-83fb-6b9b362760a7"],
Cell[49910, 1300, 210, 4, 77, "Input", "ExpressionUUID" -> \
"a870e677-4e72-4fb1-a7d3-c6df82a69f7b"],
Cell[50123, 1306, 8325, 200, 512, "Input", "ExpressionUUID" -> \
"3e7e2a88-e90f-4b35-8ccc-0a8b67bcba39"],
Cell[CellGroupData[{
Cell[58473, 1510, 921, 15, 99, "Input", "ExpressionUUID" -> \
"21e8f103-87d1-4bf6-9114-992f7095dff3"],
Cell[59397, 1527, 10009, 310, 165, "Output", "ExpressionUUID" -> \
"76bf3edd-c4ef-4ca6-895d-1d7cdf52750c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69443, 1842, 256, 6, 32, "Input", "ExpressionUUID" -> \
"4bca066b-acf3-431e-afb2-0d90de032b54"],
Cell[69702, 1850, 1913, 26, 630, "Output", "ExpressionUUID" -> \
"10d18bf2-bbb1-4dc1-a1c8-5d290fc0eb6e"]
}, Open  ]]
}
]
*)

