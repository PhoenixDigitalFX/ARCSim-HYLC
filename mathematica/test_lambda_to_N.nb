(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    189114,       4979]
NotebookOptionsPosition[    185706,       4899]
NotebookOutlinePosition[    186041,       4914]
CellTagsIndexPosition[    185998,       4911]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.777347742884466*^9, 3.777347744556012*^9}, {
   3.777362942060321*^9, 3.7773629424210453`*^9}, {3.7773775575471087`*^9, 
   3.777377570140028*^9}, {3.777397726043507*^9, 3.7773977307200136`*^9}, 
   3.777398574564353*^9},ExpressionUUID->"bff7917f-2396-4bc2-8ea3-\
049129c17f4b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"x_", "\[CircleTimes]", "y_"}], ":=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", "x", ",", "y"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Angle", "[", 
     RowBox[{"u_", ",", "v_", ",", " ", "n_"}], "]"}], ":=", " ", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"u", ".", "v"}], ",", 
      RowBox[{"n", ".", " ", 
       RowBox[{"Cross", "[", 
        RowBox[{"u", ",", "v"}], "]"}]}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"note", " ", "that", " ", "mathematica", " ", "arctan", 
     RowBox[{"(", 
      RowBox[{"x", ",", "y"}], ")"}], " ", "vs", " ", "cpp", " ", "atan2", 
     RowBox[{"(", 
      RowBox[{"y", ",", "x"}], ")"}]}], ",", " ", 
    RowBox[{"assume", " ", "normalized", " ", "u", " ", "v", " ", "n"}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotCW90", "[", 
     RowBox[{"n_", ",", "x_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"n", 
      RowBox[{"(", 
       RowBox[{"n", ".", "x"}], ")"}]}], "-", 
     RowBox[{"(", 
      RowBox[{"n", "\[Cross]", "x"}], ")"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"rot", " ", "x", " ", "around", " ", "n", " ", "by"}], " ", "-", 
     RowBox[{"Pi", "/", "2"}]}], ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "90"}], "deg", " ", "rotation", " ", 
     "clockwise"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeCyl", "[", 
    RowBox[{"sx_", ",", "sa_", ",", "sy_", ",", "H_", ",", "\[Theta]_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Cyl", ",", "S", ",", "Suv", ",", "k"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", " ", "=", " ", 
       RowBox[{"-", "H"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"S", " ", "=", " ", 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"sx", 
           RowBox[{"sa", " ", "sx"}]},
          {"0", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"1", "-", 
              SuperscriptBox["sa", "2"]}], "]"}], " ", "sy"}]},
          {"0", "0"}
         }], "\[NoBreak]", ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Suv", " ", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"RotationMatrix", "[", 
          RowBox[{"\[Theta]", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], ".", 
        " ", "S", ".", 
        RowBox[{"{", 
         RowBox[{"u", ",", "v"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Cyl", " ", "=", " ", 
       RowBox[{
        RowBox[{"RotationMatrix", "[", 
         RowBox[{"\[Theta]", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{
             RowBox[{"Suv", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sinc", "[", 
              RowBox[{
               RowBox[{"Suv", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "k"}], "]"}]}]},
           {
            RowBox[{"Suv", "[", 
             RowBox[{"[", "2", "]"}], "]"}]},
           {
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Suv", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{
                RowBox[{"Suv", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "k"}], "2"], "]"}], " ", 
             RowBox[{"Sinc", "[", 
              FractionBox[
               RowBox[{
                RowBox[{"Suv", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "k"}], "2"], "]"}]}]}
          }], "\[NoBreak]", ")"}]}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"singularity", " ", "safe"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "@", "Cyl"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DiscreteShapeOperator", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"num_:", "16"}], ",", 
     RowBox[{"dx_:", 
      RowBox[{"1", "/", "1000"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "k", ",", "P", ",", "p", ",", " ", "A", ",", "x0", ",", "x1", 
       ",", "xn", ",", "n0", ",", "ni", ",", "ei", ",", "\[Theta]i", ",", 
       "\[CapitalLambda]", ",", " ", "ti"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", " ", "=", 
       RowBox[{"dx", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"Cos", "[", "0", "]"}], 
            RowBox[{"Sin", "[", "0", "]"}]},
           {
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["2", "3"], "Pi"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{
              FractionBox["2", "3"], "Pi"}], "]"}]},
           {
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["4", "3"], "Pi"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{
              FractionBox["4", "3"], "Pi"}], "]"}]},
           {
            RowBox[{"2", 
             RowBox[{"Cos", "[", 
              FractionBox["Pi", "3"], "]"}]}], 
            RowBox[{"2", 
             RowBox[{"Sin", "[", 
              FractionBox["Pi", "3"], "]"}]}]},
           {
            RowBox[{"2", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"3", "Pi"}], "3"], "]"}]}], 
            RowBox[{"2", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"3", "Pi"}], "3"], "]"}]}]},
           {
            RowBox[{"2", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"5", "Pi"}], "3"], "]"}]}], 
            RowBox[{"2", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"5", "Pi"}], "3"], "]"}]}]}
          }], "\[NoBreak]", ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "0"}], ",", 
        RowBox[{"k", "<", "num"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"P", ".", " ", 
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"2", " ", 
               RowBox[{"Pi", " ", "/", " ", "num"}]}], "]"}]}], ")"}], " ", "//",
            " ", "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p", " ", "=", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"x", " ", "@@", " ", 
              RowBox[{"P", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], " ", "//", 
           " ", "N"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"get", " ", "world", " ", "space", " ", "points"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"n0", " ", "=", " ", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"p", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "\[Cross]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "-", 
              RowBox[{"p", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"compute", " ", "world", " ", "space", " ", "normal"}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"A", " ", "=", " ", 
          FractionBox[
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"p", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "\[Cross]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "-", 
               RowBox[{"p", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "2"]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "0"}], ",", 
           RowBox[{"i", "<", "3"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"x0", " ", "=", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"x1", " ", "=", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "3"}], "]"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"xn", " ", "=", " ", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"4", "+", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ni", " ", "=", " ", 
             RowBox[{"Normalize", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"xn", "-", "x0"}], ")"}], "\[Cross]", 
               RowBox[{"(", 
                RowBox[{"x1", "-", "x0"}], ")"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ei", " ", "=", 
             RowBox[{"x1", "-", "x0"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[Theta]i", "=", " ", 
             RowBox[{"-", 
              RowBox[{"Angle", "[", 
               RowBox[{"n0", ",", "ni", ",", 
                RowBox[{"Normalize", "[", "ei", "]"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"ti", " ", "=", " ", 
               RowBox[{"rot", "[", 
                RowBox[{
                 RowBox[{"Normalize", "[", 
                  FractionBox[
                   RowBox[{"n0", "+", "ni"}], "2"], "]"}], ",", "ei"}], 
                "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"ti", " ", "=", " ", 
             RowBox[{"RotCW90", "[", 
              RowBox[{"n0", ",", "ei"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[CapitalLambda]", " ", "=", 
             RowBox[{
              RowBox[{"\[CapitalLambda]", " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Theta]i", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", "A", " ", 
                    RowBox[{"Norm", "[", "ti", "]"}]}], ")"}]}], 
                 RowBox[{"(", 
                  RowBox[{"ti", "\[CircleTimes]", "ti"}], ")"}]}], ")"}]}], 
              " ", "//", " ", "N"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", "/", "num"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DiscreteShapeOperatorR", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"num_:", "16"}], ",", 
     RowBox[{"dx_:", 
      RowBox[{"1", "/", "1000"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "k", ",", "P", ",", "p", ",", " ", "A", ",", "x0", ",", "x1", 
       ",", "xn", ",", "n0", ",", "ni", ",", "ei", ",", "\[Theta]i", ",", 
       "\[CapitalLambda]", ",", " ", "ti", ",", "F", ",", "R2"}], "}"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"NOTE", ":", " ", 
        RowBox[{"when", " ", "not", " ", "using", " ", 
         FractionBox[
          RowBox[{"n0", "+", "ni"}], "2"], " ", "we", " ", "dont", " ", 
         "need", " ", "normalized", " ", "vectors", " ", "for", " ", "angle", 
         " ", "computation"}]}], ",", " ", 
       RowBox[{
       "trying", " ", "to", " ", "delay", " ", "normalization", " ", "as", 
        " ", "long", " ", "as", " ", "possible"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", " ", "=", 
       RowBox[{"dx", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"Cos", "[", "0", "]"}], 
            RowBox[{"Sin", "[", "0", "]"}]},
           {
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["2", "3"], "Pi"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{
              FractionBox["2", "3"], "Pi"}], "]"}]},
           {
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["4", "3"], "Pi"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{
              FractionBox["4", "3"], "Pi"}], "]"}]},
           {
            RowBox[{"2", 
             RowBox[{"Cos", "[", 
              FractionBox["Pi", "3"], "]"}]}], 
            RowBox[{"2", 
             RowBox[{"Sin", "[", 
              FractionBox["Pi", "3"], "]"}]}]},
           {
            RowBox[{"2", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"3", "Pi"}], "3"], "]"}]}], 
            RowBox[{"2", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"3", "Pi"}], "3"], "]"}]}]},
           {
            RowBox[{"2", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"5", "Pi"}], "3"], "]"}]}], 
            RowBox[{"2", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"5", "Pi"}], "3"], "]"}]}]}
          }], "\[NoBreak]", ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "0"}], ",", 
        RowBox[{"k", "<", "num"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", " ", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"P", ".", " ", 
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"2", " ", 
               RowBox[{"Pi", " ", "/", " ", "num"}]}], "]"}]}], ")"}], " ", "//",
            " ", "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p", " ", "=", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"x", " ", "@@", " ", 
              RowBox[{"P", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], " ", "//", 
           " ", "N"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"get", " ", "world", " ", "space", " ", "points"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"n0", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "\[Cross]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"p", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"compute", " ", "world", " ", "space", " ", "normal"}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"A", " ", "=", " ", 
          FractionBox[
           RowBox[{"Norm", "[", "n0", "]"}], "2"]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"F", " ", "=", " ", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"p", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "-", 
               RowBox[{"p", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"R2", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{"F", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}], 
              ",", 
              RowBox[{"Normalize", "[", 
               RowBox[{"n0", "\[Cross]", 
                RowBox[{"F", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}]}], 
               "]"}]}], "}"}], "]"}], " ", "//", " ", "N"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"R", " ", "=", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"xu", "/"}], "|", "xu", "|"}], ",", "  ", 
             RowBox[{
              RowBox[{"n", " ", "x", " ", 
               RowBox[{"xu", "/"}]}], "|", "xu", "|"}], ",", " ", "n"}], 
            ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "0"}], ",", 
           RowBox[{"i", "<", "3"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"x0", "=", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"x1", "=", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "3"}], "]"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"xn", "=", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"4", "+", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ni", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xn", "-", "x0"}], ")"}], "\[Cross]", 
              RowBox[{"(", 
               RowBox[{"x1", "-", "x0"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ei", "=", 
             RowBox[{"x1", "-", "x0"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[Theta]i", "=", " ", 
             RowBox[{"-", 
              RowBox[{"Angle", "[", 
               RowBox[{"n0", ",", "ni", ",", 
                RowBox[{"Normalize", "[", "ei", "]"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"ti", " ", "=", " ", 
               RowBox[{"rot", "[", 
                RowBox[{
                 RowBox[{"Normalize", "[", 
                  FractionBox[
                   RowBox[{"n0", "+", "ni"}], "2"], "]"}], ",", "ei"}], 
                "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"ti", " ", "=", " ", 
             RowBox[{
              RowBox[{"Transpose", "[", "R2", "]"}], ".", " ", 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                 {"0", 
                  RowBox[{"n0", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], 
                  RowBox[{"-", 
                   RowBox[{"n0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]},
                 {
                  RowBox[{"-", 
                   RowBox[{"n0", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "0", 
                  RowBox[{"n0", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]},
                 {
                  RowBox[{"n0", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], 
                  RowBox[{"-", 
                   RowBox[{"n0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "0"}
                }], "\[NoBreak]", ")"}], ".", "ei"}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"proj", " ", "to", " ", "R"}], "-", 
               RowBox[{
               "frame", " ", "without", " ", "normal", " ", "component", " ", 
                "which", " ", "is", " ", "0", " ", "by", " ", 
                "definition"}]}], ",", " ", "simplified"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"\[CapitalLambda]", " ", "=", 
               RowBox[{
                RowBox[{"\[CapitalLambda]", " ", "+", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Theta]i", " ", 
                   RowBox[{
                    RowBox[{"Norm", "[", "ei", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "A"}], ")"}]}], 
                   RowBox[{"(", 
                    RowBox[{"ti", "\[CircleTimes]", "ti"}], ")"}]}], ")"}]}], 
                " ", "//", " ", "N"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"\[CapitalLambda]", " ", "=", 
             RowBox[{
              RowBox[{"\[CapitalLambda]", " ", "+", " ", 
               RowBox[{"(", " ", 
                RowBox[{
                 FractionBox["\[Theta]i", 
                  RowBox[{
                   RowBox[{"Norm", "[", "ei", "]"}], 
                   RowBox[{"Norm", "[", "n0", "]"}], 
                   RowBox[{"(", 
                    RowBox[{"n0", ".", "n0"}], ")"}]}]], 
                 RowBox[{"(", 
                  RowBox[{"ti", "\[CircleTimes]", "ti"}], ")"}]}], ")"}]}], 
              " ", "//", " ", "N"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", "/", "num"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7773985751581707`*^9, 3.7773985766686974`*^9}, {
   3.777398700022371*^9, 3.7773987002323213`*^9}, {3.7773988013720007`*^9, 
   3.777398856900283*^9}, {3.7775631158596153`*^9, 3.777563119233554*^9}, {
   3.777563528452833*^9, 3.777563532089672*^9}, {3.7775637079595003`*^9, 
   3.777563805034497*^9}, {3.7775638736366005`*^9, 3.777563876472679*^9}, {
   3.7775639855898438`*^9, 3.7775639898064847`*^9}, {3.77760645925315*^9, 
   3.777606459573249*^9}, {3.777607645324144*^9, 3.77760764577855*^9}, {
   3.777607702371573*^9, 3.7776077030351152`*^9}, {3.77760797787148*^9, 
   3.777607991823023*^9}, {3.7776093410723057`*^9, 3.7776093897920427`*^9}, {
   3.777609691164569*^9, 3.77760970290742*^9}, 3.777609824668704*^9, {
   3.777612202118616*^9, 3.777612213540316*^9}, {3.777612277854439*^9, 
   3.777612342581213*^9}, {3.777612377020935*^9, 3.777612377392441*^9}, {
   3.777612469141378*^9, 3.777612493602373*^9}, {3.777612523754457*^9, 
   3.7776126044766912`*^9}, {3.777612655466748*^9, 3.777612687598901*^9}, {
   3.777612727094973*^9, 3.777612798150529*^9}, {3.777612846983824*^9, 
   3.7776128635030613`*^9}, {3.777637272193886*^9, 3.777637272386476*^9}, {
   3.777637318283038*^9, 3.777637318449411*^9}, {3.7776384175087*^9, 
   3.777638477043428*^9}, {3.777638545184265*^9, 3.777638557078348*^9}, {
   3.777640130997456*^9, 3.7776401397669077`*^9}, 3.777649457357647*^9, {
   3.777649500215019*^9, 3.7776495017682734`*^9}, {3.7776495344993224`*^9, 
   3.777649589507367*^9}, {3.777649734629773*^9, 3.777649779886881*^9}, {
   3.7776935113192797`*^9, 3.7776935632524137`*^9}, {3.777693598567464*^9, 
   3.777693636198575*^9}, {3.777693693677875*^9, 3.7776936982857103`*^9}, {
   3.7776937313575373`*^9, 3.777693861469099*^9}, {3.777693955637828*^9, 
   3.777693980980805*^9}, {3.7776940521560307`*^9, 3.777694074019129*^9}, {
   3.77769410631791*^9, 3.7776941182439003`*^9}, {3.777694174811947*^9, 
   3.777694193075675*^9}, {3.7776949458938828`*^9, 3.7776949515551643`*^9}, {
   3.777695006894245*^9, 3.777695007087957*^9}, {3.777696242848741*^9, 
   3.777696288102414*^9}, {3.7776963877513447`*^9, 3.7776963894704647`*^9}, {
   3.777696467067216*^9, 3.7776964672735167`*^9}, {3.777696501686964*^9, 
   3.7776965790231028`*^9}, {3.7776966372253723`*^9, 3.777696641103303*^9}, {
   3.777696969249052*^9, 3.777696983368354*^9}, {3.7776971973975477`*^9, 
   3.777697345384585*^9}, {3.777697384614147*^9, 3.777697404217113*^9}, {
   3.777697446921336*^9, 3.777697457078948*^9}, {3.777697494194962*^9, 
   3.777697550676746*^9}, {3.777697598322777*^9, 3.777697652961853*^9}, {
   3.7776978580529346`*^9, 3.777697863871913*^9}, {3.777698043461041*^9, 
   3.777698066437622*^9}, {3.7776981577725077`*^9, 3.777698211610983*^9}, {
   3.777698341889223*^9, 3.7776983647850943`*^9}, {3.777698396625248*^9, 
   3.777698404417191*^9}, {3.777698491823462*^9, 3.777698603157954*^9}, {
   3.777698644548381*^9, 3.777698653118744*^9}, 
   3.7776989783690653`*^9},ExpressionUUID->"26d244b1-cb62-4bbd-9ec8-\
450d951a784c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "[", 
     RowBox[{"u_", ",", "v_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"RotationMatrix", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "4"}], ",", 
       RowBox[{"Normalize", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}]}], "]"}], ".", 
     RowBox[{"MakeCyl", "[", 
      RowBox[{"2", ",", "0.3", ",", "1.8", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sqrt", "[", "7", "]"}]}], "*", "10"}], ",", 
       RowBox[{
        RowBox[{"Sqrt", "[", "2", "]"}], "+", 
        RowBox[{"1", "*", 
         RowBox[{"Pi", "/", "8"}]}]}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"u_", ",", "v_"}], "]"}], "=", " ", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"sx", 
             RowBox[{"sa", " ", "sy"}]},
            {"0", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", " ", "-", " ", 
                SuperscriptBox["sa", "2"]}], "]"}], " ", "sy"}]},
            {"0", "0"}
           }], "\[NoBreak]", ")"}], ".", 
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}], ".", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"a", "b"},
              {"b", "c"}
             }], "\[NoBreak]", ")"}], ".", 
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}]}], ")"}]}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sx", "\[Rule]", " ", "2"}], ",", " ", 
        RowBox[{"sa", "\[Rule]", " ", 
         RowBox[{"-", ".3"}]}], ",", " ", 
        RowBox[{"sy", "\[Rule]", " ", "0.9"}], ",", 
        RowBox[{"a", "\[Rule]", "1"}], ",", 
        RowBox[{"b", "\[Rule]", "3"}], ",", 
        RowBox[{"c", "\[Rule]", 
         RowBox[{"-", "1"}]}]}], "}"}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"u", ",", "v"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F0", " ", "=", " ", 
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"u", ",", "v"}], "]"}], ",", 
       RowBox[{"u", "\[Rule]", " ", "0"}]}], "]"}], ",", 
     RowBox[{"v", "\[Rule]", "0"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], " ", "=", " ", 
   RowBox[{"Normalize", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{"u", ",", "v"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "\[Cross]", 
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{"u", ",", "v"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", "2"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n0", " ", "=", " ", 
   RowBox[{"n", "[", 
    RowBox[{
     RowBox[{"1", "/", "1000"}], ",", 
     RowBox[{"1", "/", "1000"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"duv", " ", "=", " ", "0.0001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dN0", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"duv", ",", "v"}], "]"}], "-", 
          RowBox[{"n", "[", 
           RowBox[{
            RowBox[{"-", "duv"}], ",", "v"}], "]"}]}], ",", 
         RowBox[{"v", "\[Rule]", " ", "0"}]}], "]"}], 
       RowBox[{"2", "duv"}]], ",", 
      FractionBox[
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"u", ",", "duv"}], "]"}], "-", 
          RowBox[{"n", "[", 
           RowBox[{"u", ",", 
            RowBox[{"-", "duv"}]}], "]"}]}], ",", 
         RowBox[{"u", "\[Rule]", " ", "0"}]}], "]"}], 
       RowBox[{"2", "duv"}]]}], "}"}], "]"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{
   "could", " ", "also", " ", "speed", " ", "up", " ", "by", " ", "doing", 
    " ", "eps", " ", "instead", " ", "of", " ", "limit"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"II0", " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"Transpose", "[", "dN0", "]"}], ".", "F0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L0", " ", "=", 
   RowBox[{
    RowBox[{"DiscreteShapeOperator", "[", 
     RowBox[{"x", ",", "16", ",", 
      RowBox[{"1", "/", "1000"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "\[Rule]", " ", 
       RowBox[{"1", "/", "1000"}]}], ",", " ", 
      RowBox[{"v", "\[Rule]", " ", 
       RowBox[{"1", "/", "1000"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K0", " ", "=", " ", 
    RowBox[{
     RowBox[{"DiscreteShapeOperatorR", "[", 
      RowBox[{"x", ",", "16", ",", 
       RowBox[{"1", "/", "1000"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "\[Rule]", " ", 
        RowBox[{"1", "/", "1000"}]}], ",", " ", 
       RowBox[{"v", "\[Rule]", " ", 
        RowBox[{"1", "/", "1000"}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"plotL", " ", "=", " ", "1"}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"ParametricPlot3D", "[", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"u", ",", "v"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", 
        RowBox[{
         RowBox[{"-", "plotL"}], "/", "2"}], ",", 
        RowBox[{"plotL", "/", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v", ",", 
        RowBox[{
         RowBox[{"-", "plotL"}], "/", "2"}], ",", 
        RowBox[{"plotL", "/", "2"}]}], "}"}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "plotL"}], " ", 
          RowBox[{"2", "/", "3"}]}], ",", 
         RowBox[{"plotL", " ", 
          RowBox[{"2", "/", "3"}]}]}], "}"}]}]}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<II: \>\"", ",", 
   RowBox[{"NumberForm", "[", 
    RowBox[{
     RowBox[{"II0", "//", " ", "MatrixForm"}], ",", "4"}], "]"}], ",", " ", 
   "\"\<    \[CapitalLambda]tri: \>\"", ",", 
   RowBox[{"NumberForm", "[", 
    RowBox[{
     RowBox[{"L0", "//", " ", "MatrixForm"}], ",", "4"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<n,u n,v: \>\"", ",", 
   RowBox[{
    RowBox[{"NumberForm", "[", 
     RowBox[{
      RowBox[{"dN0", "//", " ", "MatrixForm"}], ",", "4"}], "]"}], "//", " ", 
    "MatrixForm"}], ",", "\"\<    x,u x,v: \>\"", ",", 
   RowBox[{
    RowBox[{"NumberForm", "[", 
     RowBox[{
      RowBox[{"F0", "//", " ", "MatrixForm"}], ",", "4"}], "]"}], "//", " ", 
    "MatrixForm"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<??: \>\"", ",", 
   RowBox[{
    RowBox[{"NumberForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Inverse", "[", 
          RowBox[{"F0", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "2"}], ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}], "]"}], ".", 
        "II0", ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"F0", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "2"}], ",", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}]}], "//", " ", 
       "MatrixForm"}], ",", "4"}], "]"}], "//", " ", "MatrixForm"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Normalize", "[", 
       RowBox[{"F0", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Normalize", "[", 
        RowBox[{
         RowBox[{"F0", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "\[Cross]", 
         RowBox[{"F0", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "2"}], "]"}], "]"}]}], "]"}], 
       "\[Cross]", 
       RowBox[{"Normalize", "[", 
        RowBox[{"F0", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}]}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<K: \>\"", ",", 
   RowBox[{
    RowBox[{"NumberForm", "[", 
     RowBox[{
      RowBox[{"K0", "//", " ", "MatrixForm"}], ",", "4"}], "]"}], "//", " ", 
    "MatrixForm"}], ",", " ", "\"\<     Kalt: \>\"", ",", 
   RowBox[{
    RowBox[{"NumberForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "R", "]"}], ".", "L0", ".", "R"}], "//", 
       " ", "MatrixForm"}], ",", "4"}], "]"}], "//", " ", "MatrixForm"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Q: \>\"", ",", 
    RowBox[{
     RowBox[{"NumberForm", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "F0", "]"}], ".", "L0", ".", "F0"}], "//", 
        " ", "MatrixForm"}], ",", "4"}], "]"}], "//", " ", "MatrixForm"}]}], 
   "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Q", " ", "=", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Normalize", "[", 
         RowBox[{"F0", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Normalize", "[", 
         RowBox[{"F0", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "2"}], "]"}], "]"}], "]"}]}], 
       "}"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "Q", "]"}], ".", "L0", ".", "Q"}], " ", "//", 
     " ", "MatrixForm"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "F0", "]"}], ".", "F0"}], "]"}], ".", 
    RowBox[{"Transpose", "[", "F0", "]"}], ".", "L0", ".", "F0", ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "F0", "]"}], ".", "F0"}], "]"}]}], " ", "//", 
   " ", "MatrixForm"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"A", " ", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "R", "]"}], ".", "F0"}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", ".", "A"}], "//", "MatrixForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", 
    RowBox[{"Transpose", "[", "A", "]"}], "]"}], ".", "II0", ".", 
   RowBox[{"Inverse", "[", "A", "]"}]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", "R", "]"}], ".", "L0", ".", "R"}], " ", "//", 
  " ", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"K0", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", ".", "K0", ".", 
    RowBox[{"Transpose", "[", "R", "]"}]}], " ", "//", " ", "MatrixForm"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"CONTINUE", ":", " ", 
     RowBox[{"write", " ", "theory", " ", "conversion", " ", "better"}]}], 
    ",", " ", 
    RowBox[{
     RowBox[{"is", " ", "lam"}], "=", 
     RowBox[{"R2", " ", "K", " ", "R2T"}]}], ",", " ", 
    RowBox[{"K", " ", "=", 
     RowBox[{"R2T", " ", "Lam", " ", "R2", " ", "correct", " ", 
      RowBox[{"option", "?", " ", "also"}], " ", "why", " ", "does", " ", 
      "is", " ", "change", " ", 
      RowBox[{
      "numerically", "?", "noisy", "?", "\[IndentingNewLine]", "then"}], " ", 
      "figure", " ", "out", " ", "if", " ", "that", " ", "quantity", " ", 
      "can", " ", "be", " ", "computed", " ", "more", " ", "directly", " ", 
      "like", " ", 
      RowBox[{"shapeop", ".", "\[IndentingNewLine]", "then"}], " ", "compute",
       " ", "it", " ", "macro", " ", "and", " ", "use", " ", 
      RowBox[{"it", ".", "\[IndentingNewLine]", "oh"}], " ", "and", " ", 
      "maybe", " ", "the", " ", "ti", " ", "in", " ", "the", " ", 
      "shapeoperator", " ", "should", " ", "be", " ", "in", " ", "plane", " ",
       "of", " ", "the", " ", "triangle", " ", "not", " ", "the", " ", 
      "avgnormal", " ", "planes"}]}], ",", " ", 
    RowBox[{
    "maybe", " ", "then", " ", "also", " ", "conversion", " ", "more", " ", 
     RowBox[{"correct", ".", "\[IndentingNewLine]", "yeah"}], " ", "just", 
     " ", "compute", " ", "ti", " ", "in", " ", "plane", " ", "and", " ", 
     "then", " ", "transofrm", " ", "them", " ", "R_.", "T", " ", "ti"}]}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.777631956542202*^9, 3.777631968429483*^9}, {
   3.777632006998539*^9, 3.7776322643274603`*^9}, {3.777632403045397*^9, 
   3.777632407665015*^9}, {3.777632445265386*^9, 3.777632475034191*^9}, {
   3.777632511196931*^9, 3.777632601464226*^9}, {3.777632726592553*^9, 
   3.777632884373514*^9}, {3.7776330412682753`*^9, 3.7776330767803183`*^9}, {
   3.77763313999691*^9, 3.7776331913174133`*^9}, {3.777633221564386*^9, 
   3.777633285467634*^9}, {3.7776333254165907`*^9, 3.777633337800641*^9}, {
   3.777633392232834*^9, 3.7776334069218197`*^9}, {3.7776335170141478`*^9, 
   3.777633531297399*^9}, {3.777633595295043*^9, 3.777633597938278*^9}, {
   3.777633736405631*^9, 3.777633742087625*^9}, {3.777633850838819*^9, 
   3.777633861590364*^9}, {3.777633892972364*^9, 3.777634004142921*^9}, {
   3.777634061926457*^9, 3.777634090326779*^9}, {3.777634462588498*^9, 
   3.777634621232546*^9}, {3.7776350672091923`*^9, 3.777635085454805*^9}, {
   3.777635161467683*^9, 3.7776351889257917`*^9}, 3.7776352192286587`*^9, 
   3.77763556608354*^9, {3.777635622555354*^9, 3.7776357753759527`*^9}, {
   3.777635816750307*^9, 3.7776359826128483`*^9}, {3.7776362080984383`*^9, 
   3.777636227212434*^9}, {3.777636301621502*^9, 3.777636332659932*^9}, {
   3.7776363773581953`*^9, 3.777636414782216*^9}, {3.777636452645096*^9, 
   3.7776364528149233`*^9}, {3.777636922464452*^9, 3.7776369302424994`*^9}, {
   3.777636964946673*^9, 3.7776371380218697`*^9}, 3.7776373032520437`*^9, {
   3.777638492468442*^9, 3.777638525382763*^9}, {3.777638578629856*^9, 
   3.7776386250907516`*^9}, {3.777639272980359*^9, 3.777639277935335*^9}, {
   3.777639313630005*^9, 3.77763932607757*^9}, {3.777640176715148*^9, 
   3.7776402003629093`*^9}, {3.777640244704749*^9, 3.777640301249032*^9}, {
   3.777640452170475*^9, 3.777640468024334*^9}, {3.7776494638774223`*^9, 
   3.7776494839568396`*^9}, 3.777649563497944*^9, {3.7776495975366945`*^9, 
   3.7776496536288767`*^9}, {3.7776496841925898`*^9, 3.777649714361497*^9}, {
   3.7776506035712395`*^9, 3.7776506079067335`*^9}, {3.777651154704818*^9, 
   3.7776511916411705`*^9}, {3.7776546021113997`*^9, 3.777654602264366*^9}, {
   3.777655348679963*^9, 3.7776553586227727`*^9}, {3.7776554923060894`*^9, 
   3.7776555708539996`*^9}, {3.7776556600135074`*^9, 
   3.7776557027008743`*^9}, {3.7776562131218452`*^9, 
   3.7776563166287956`*^9}, {3.7776563515936284`*^9, 
   3.7776563872942324`*^9}, {3.777656465237331*^9, 3.777656485972699*^9}, {
   3.777693195841833*^9, 3.777693328032559*^9}, {3.7776940851851473`*^9, 
   3.777694096223495*^9}, {3.777694149336266*^9, 3.7776941648271093`*^9}, {
   3.7776942078818083`*^9, 3.777694218278961*^9}, {3.777694958623942*^9, 
   3.777694959773509*^9}, 3.7776984121184483`*^9, {3.777713054319201*^9, 
   3.777713121617165*^9}, 3.777713185032476*^9, {3.777713901900713*^9, 
   3.777713927811472*^9}, {3.7777139663254623`*^9, 3.777713977776516*^9}, {
   3.7777140137580757`*^9, 3.777714013907003*^9}, {3.777714214208757*^9, 
   3.777714243992606*^9}, {3.7777202878039093`*^9, 3.777720325187334*^9}, {
   3.7777204739444113`*^9, 3.777720519364667*^9}, {3.777720756842737*^9, 
   3.777720771655985*^9}, {3.777720856709031*^9, 
   3.777720885201942*^9}},ExpressionUUID->"7089f250-f82c-45b8-a89b-\
bc6004c3c480"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"II: \"\>", "\[InvisibleSpace]", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         InterpretationBox["\<\"-5.791\"\>",
          -5.791286879104792,
          AutoDelete->True], 
         InterpretationBox["\<\"18.93\"\>",
          18.92758723127843,
          AutoDelete->True]},
        {
         InterpretationBox["\<\"18.93\"\>",
          18.92754043411486,
          AutoDelete->True], 
         InterpretationBox["\<\"-61.86\"\>",
          -61.86063307152064,
          AutoDelete->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    NumberForm[#, 4]& ], 
   "\[InvisibleSpace]", "\<\"    \[CapitalLambda]tri: \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         InterpretationBox["\<\"-12.27\"\>",
          -12.266052330002658`,
          AutoDelete->True], 
         InterpretationBox["\<\"11.29\"\>",
          11.286035047669406`,
          AutoDelete->True], 
         InterpretationBox["\<\"6.837\"\>",
          6.836628953560521,
          AutoDelete->True]},
        {
         InterpretationBox["\<\"11.29\"\>",
          11.286035047669406`,
          AutoDelete->True], 
         InterpretationBox["\<\"-10.38\"\>",
          -10.384023440421359`,
          AutoDelete->True], 
         InterpretationBox["\<\"-6.291\"\>",
          -6.2909663688296265`,
          AutoDelete->True]},
        {
         InterpretationBox["\<\"6.837\"\>",
          6.836628953560521,
          AutoDelete->True], 
         InterpretationBox["\<\"-6.291\"\>",
          -6.2909663688296265`,
          AutoDelete->True], 
         InterpretationBox["\<\"-3.812\"\>",
          -3.812458625418259,
          AutoDelete->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    NumberForm[#, 4]& ]}],
  SequenceForm["II: ", 
   NumberForm[
    MatrixForm[{{-5.791286879104792, 18.92758723127843}, {
     18.92754043411486, -61.86063307152064}}], 4], 
   "    \[CapitalLambda]tri: ", 
   NumberForm[
    MatrixForm[{{-12.266052330002658`, 11.286035047669406`, 
     6.836628953560521}, {
     11.286035047669406`, -10.384023440421359`, -6.2909663688296265`}, {
     6.836628953560521, -6.2909663688296265`, -3.812458625418259}}], 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7776555744928246`*^9, 3.7776556634764004`*^9, {3.77765569563313*^9, 
   3.7776557122878194`*^9}, {3.777693230217826*^9, 3.7776932660072813`*^9}, {
   3.7776933011448183`*^9, 3.777693328776237*^9}, {3.777694097340629*^9, 
   3.777694150488652*^9}, {3.777694181019231*^9, 3.7776942192969217`*^9}, 
   3.777694962746338*^9, {3.77769501383153*^9, 3.777695018008939*^9}, 
   3.7776964104013367`*^9, 3.7776964410019827`*^9, 3.777696487772584*^9, {
   3.777696524174653*^9, 3.777696552558878*^9}, {3.777696649626161*^9, 
   3.777696653576749*^9}, 3.777696986633307*^9, 3.777697302686318*^9, 
   3.7776973488311377`*^9, {3.777697391207665*^9, 3.7776974065507717`*^9}, 
   3.777697471524667*^9, 3.777697647583302*^9, 3.777698073421628*^9, 
   3.7776982035533543`*^9, {3.777698408413827*^9, 3.77769841330168*^9}, {
   3.777698554097541*^9, 3.777698575854244*^9}, {3.777698620921843*^9, 
   3.7776986546786757`*^9}, {3.777713100057126*^9, 3.77771312613615*^9}, 
   3.777713190581234*^9, 3.7777139785077267`*^9, 3.7777140175552197`*^9, {
   3.777714235901867*^9, 3.777714244606399*^9}, 3.7777202405753*^9, {
   3.7777203074360447`*^9, 3.7777203286657343`*^9}, 3.777720520863099*^9, 
   3.777720772413848*^9, {3.777720874998481*^9, 
   3.777720888244912*^9}},ExpressionUUID->"c073e0d7-107d-4423-a1e5-\
159b49d2567c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"n,u n,v: \"\>", "\[InvisibleSpace]", 
   TagBox[
    TagBox[
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          InterpretationBox["\<\"8.428\"\>",
           8.427680511617075,
           AutoDelete->True], 
          InterpretationBox["\<\"-27.54\"\>",
           -27.54400998937756,
           AutoDelete->True]},
         {
          InterpretationBox["\<\"-7.754\"\>",
           -7.7542321936704965`,
           AutoDelete->True], 
          InterpretationBox["\<\"25.34\"\>",
           25.34299309376969,
           AutoDelete->True]},
         {
          InterpretationBox["\<\"-4.698\"\>",
           -4.697775397285997,
           AutoDelete->True], 
          InterpretationBox["\<\"15.35\"\>",
           15.353639983428092`,
           AutoDelete->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]],
     NumberForm[#, 4]& ],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\"    x,u x,v: \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    TagBox[
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          InterpretationBox["\<\"1.456\"\>",
           1.456055450775017,
           AutoDelete->True], 
          InterpretationBox["\<\"-0.4648\"\>",
           -0.46483589744854104`,
           AutoDelete->True]},
         {
          InterpretationBox["\<\"1.218\"\>",
           1.2175771958315253`,
           AutoDelete->True], 
          InterpretationBox["\<\"1.723\"\>",
           1.7231321628288039`,
           AutoDelete->True]},
         {
          InterpretationBox["\<\"-0.6304\"\>",
           -0.6304032808126893,
           AutoDelete->True], 
          InterpretationBox["\<\"0.3509\"\>",
           0.350917565630646,
           AutoDelete->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]],
     NumberForm[#, 4]& ],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["n,u n,v: ", 
   MatrixForm[
    NumberForm[
     MatrixForm[{{
      8.427680511617075, -27.54400998937756}, {-7.7542321936704965`, 
      25.34299309376969}, {-4.697775397285997, 15.353639983428092`}}], 4]], 
   "    x,u x,v: ", 
   MatrixForm[
    NumberForm[
     MatrixForm[{{1.456055450775017, -0.46483589744854104`}, {
      1.2175771958315253`, 1.7231321628288039`}, {-0.6304032808126893, 
      0.350917565630646}}], 4]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7776555744928246`*^9, 3.7776556634764004`*^9, {3.77765569563313*^9, 
   3.7776557122878194`*^9}, {3.777693230217826*^9, 3.7776932660072813`*^9}, {
   3.7776933011448183`*^9, 3.777693328776237*^9}, {3.777694097340629*^9, 
   3.777694150488652*^9}, {3.777694181019231*^9, 3.7776942192969217`*^9}, 
   3.777694962746338*^9, {3.77769501383153*^9, 3.777695018008939*^9}, 
   3.7776964104013367`*^9, 3.7776964410019827`*^9, 3.777696487772584*^9, {
   3.777696524174653*^9, 3.777696552558878*^9}, {3.777696649626161*^9, 
   3.777696653576749*^9}, 3.777696986633307*^9, 3.777697302686318*^9, 
   3.7776973488311377`*^9, {3.777697391207665*^9, 3.7776974065507717`*^9}, 
   3.777697471524667*^9, 3.777697647583302*^9, 3.777698073421628*^9, 
   3.7776982035533543`*^9, {3.777698408413827*^9, 3.77769841330168*^9}, {
   3.777698554097541*^9, 3.777698575854244*^9}, {3.777698620921843*^9, 
   3.7776986546786757`*^9}, {3.777713100057126*^9, 3.77771312613615*^9}, 
   3.777713190581234*^9, 3.7777139785077267`*^9, 3.7777140175552197`*^9, {
   3.777714235901867*^9, 3.777714244606399*^9}, 3.7777202405753*^9, {
   3.7777203074360447`*^9, 3.7777203286657343`*^9}, 3.777720520863099*^9, 
   3.777720772413848*^9, {3.777720874998481*^9, 
   3.77772088824822*^9}},ExpressionUUID->"bfb780cb-ab6c-47f9-ae07-\
880701d0f8c2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"??: \"\>", "\[InvisibleSpace]", 
   TagBox[
    TagBox[
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          InterpretationBox["\<\"-19.92\"\>",
           -19.917395558422044`,
           AutoDelete->True], 
          InterpretationBox["\<\"15.\"\>",
           14.997696459498568`,
           AutoDelete->True]},
         {
          InterpretationBox["\<\"15.\"\>",
           14.997681240659183`,
           AutoDelete->True], 
          InterpretationBox["\<\"-11.29\"\>",
           -11.293176870637884`,
           AutoDelete->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]],
     NumberForm[#, 4]& ],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["??: ", 
   MatrixForm[
    NumberForm[
     MatrixForm[{{-19.917395558422044`, 14.997696459498568`}, {
      14.997681240659183`, -11.293176870637884`}}], 4]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7776555744928246`*^9, 3.7776556634764004`*^9, {3.77765569563313*^9, 
   3.7776557122878194`*^9}, {3.777693230217826*^9, 3.7776932660072813`*^9}, {
   3.7776933011448183`*^9, 3.777693328776237*^9}, {3.777694097340629*^9, 
   3.777694150488652*^9}, {3.777694181019231*^9, 3.7776942192969217`*^9}, 
   3.777694962746338*^9, {3.77769501383153*^9, 3.777695018008939*^9}, 
   3.7776964104013367`*^9, 3.7776964410019827`*^9, 3.777696487772584*^9, {
   3.777696524174653*^9, 3.777696552558878*^9}, {3.777696649626161*^9, 
   3.777696653576749*^9}, 3.777696986633307*^9, 3.777697302686318*^9, 
   3.7776973488311377`*^9, {3.777697391207665*^9, 3.7776974065507717`*^9}, 
   3.777697471524667*^9, 3.777697647583302*^9, 3.777698073421628*^9, 
   3.7776982035533543`*^9, {3.777698408413827*^9, 3.77769841330168*^9}, {
   3.777698554097541*^9, 3.777698575854244*^9}, {3.777698620921843*^9, 
   3.7776986546786757`*^9}, {3.777713100057126*^9, 3.77771312613615*^9}, 
   3.777713190581234*^9, 3.7777139785077267`*^9, 3.7777140175552197`*^9, {
   3.777714235901867*^9, 3.777714244606399*^9}, 3.7777202405753*^9, {
   3.7777203074360447`*^9, 3.7777203286657343`*^9}, 3.777720520863099*^9, 
   3.777720772413848*^9, {3.777720874998481*^9, 
   3.7777208882508802`*^9}},ExpressionUUID->"118d2892-6937-4926-ba08-\
47f2286b7a39"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"K: \"\>", "\[InvisibleSpace]", 
   TagBox[
    TagBox[
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          InterpretationBox["\<\"-1.447\"\>",
           -1.4472725707457945`,
           AutoDelete->True], 
          InterpretationBox["\<\"6.018\"\>",
           6.017569144172293,
           AutoDelete->True]},
         {
          InterpretationBox["\<\"6.018\"\>",
           6.017569144172293,
           AutoDelete->True], 
          InterpretationBox["\<\"-25.02\"\>",
           -25.01526182509649,
           AutoDelete->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]],
     NumberForm[#, 4]& ],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\"     Kalt: \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    TagBox[
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          InterpretationBox["\<\"-1.448\"\>",
           -1.4476828882729276`,
           AutoDelete->True], 
          InterpretationBox["\<\"6.018\"\>",
           6.0181890897239505`,
           AutoDelete->True]},
         {
          InterpretationBox["\<\"6.018\"\>",
           6.01818908972395,
           AutoDelete->True], 
          InterpretationBox["\<\"-25.01\"\>",
           -25.01332677262682,
           AutoDelete->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]],
     NumberForm[#, 4]& ],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["K: ", 
   MatrixForm[
    NumberForm[
     MatrixForm[{{-1.4472725707457945`, 6.017569144172293}, {
      6.017569144172293, -25.01526182509649}}], 4]], "     Kalt: ", 
   MatrixForm[
    NumberForm[
     MatrixForm[{{-1.4476828882729276`, 6.0181890897239505`}, {
      6.01818908972395, -25.01332677262682}}], 4]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7776555744928246`*^9, 3.7776556634764004`*^9, {3.77765569563313*^9, 
   3.7776557122878194`*^9}, {3.777693230217826*^9, 3.7776932660072813`*^9}, {
   3.7776933011448183`*^9, 3.777693328776237*^9}, {3.777694097340629*^9, 
   3.777694150488652*^9}, {3.777694181019231*^9, 3.7776942192969217`*^9}, 
   3.777694962746338*^9, {3.77769501383153*^9, 3.777695018008939*^9}, 
   3.7776964104013367`*^9, 3.7776964410019827`*^9, 3.777696487772584*^9, {
   3.777696524174653*^9, 3.777696552558878*^9}, {3.777696649626161*^9, 
   3.777696653576749*^9}, 3.777696986633307*^9, 3.777697302686318*^9, 
   3.7776973488311377`*^9, {3.777697391207665*^9, 3.7776974065507717`*^9}, 
   3.777697471524667*^9, 3.777697647583302*^9, 3.777698073421628*^9, 
   3.7776982035533543`*^9, {3.777698408413827*^9, 3.77769841330168*^9}, {
   3.777698554097541*^9, 3.777698575854244*^9}, {3.777698620921843*^9, 
   3.7776986546786757`*^9}, {3.777713100057126*^9, 3.77771312613615*^9}, 
   3.777713190581234*^9, 3.7777139785077267`*^9, 3.7777140175552197`*^9, {
   3.777714235901867*^9, 3.777714244606399*^9}, 3.7777202405753*^9, {
   3.7777203074360447`*^9, 3.7777203286657343`*^9}, 3.777720520863099*^9, 
   3.777720772413848*^9, {3.777720874998481*^9, 
   3.7777208882529488`*^9}},ExpressionUUID->"5ae09aef-4b84-4b26-bf3e-\
30c6c8eb13aa"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Q: \"\>", "\[InvisibleSpace]", 
   TagBox[
    TagBox[
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          InterpretationBox["\<\"-5.791\"\>",
           -5.79073155309171,
           AutoDelete->True], 
          InterpretationBox["\<\"18.93\"\>",
           18.930331913291276`,
           AutoDelete->True]},
         {
          InterpretationBox["\<\"18.93\"\>",
           18.930331913291276`,
           AutoDelete->True], 
          InterpretationBox["\<\"-61.87\"\>",
           -61.86992766865992,
           AutoDelete->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]],
     NumberForm[#, 4]& ],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Q: ", 
   MatrixForm[
    NumberForm[
     MatrixForm[{{-5.79073155309171, 18.930331913291276`}, {
      18.930331913291276`, -61.86992766865992}}], 4]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7776555744928246`*^9, 3.7776556634764004`*^9, {3.77765569563313*^9, 
   3.7776557122878194`*^9}, {3.777693230217826*^9, 3.7776932660072813`*^9}, {
   3.7776933011448183`*^9, 3.777693328776237*^9}, {3.777694097340629*^9, 
   3.777694150488652*^9}, {3.777694181019231*^9, 3.7776942192969217`*^9}, 
   3.777694962746338*^9, {3.77769501383153*^9, 3.777695018008939*^9}, 
   3.7776964104013367`*^9, 3.7776964410019827`*^9, 3.777696487772584*^9, {
   3.777696524174653*^9, 3.777696552558878*^9}, {3.777696649626161*^9, 
   3.777696653576749*^9}, 3.777696986633307*^9, 3.777697302686318*^9, 
   3.7776973488311377`*^9, {3.777697391207665*^9, 3.7776974065507717`*^9}, 
   3.777697471524667*^9, 3.777697647583302*^9, 3.777698073421628*^9, 
   3.7776982035533543`*^9, {3.777698408413827*^9, 3.77769841330168*^9}, {
   3.777698554097541*^9, 3.777698575854244*^9}, {3.777698620921843*^9, 
   3.7776986546786757`*^9}, {3.777713100057126*^9, 3.77771312613615*^9}, 
   3.777713190581234*^9, 3.7777139785077267`*^9, 3.7777140175552197`*^9, {
   3.777714235901867*^9, 3.777714244606399*^9}, 3.7777202405753*^9, {
   3.7777203074360447`*^9, 3.7777203286657343`*^9}, 3.777720520863099*^9, 
   3.777720772413848*^9, {3.777720874998481*^9, 
   3.7777208882553368`*^9}},ExpressionUUID->"bf960f7b-6d77-416e-b83c-\
872c67492a7b"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "2.1769160132157106`"}], "4.297546424024127`"},
     {"4.297546424024127`", 
      RowBox[{"-", "8.483695147411076`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7776555745078926`*^9, 3.7776556634953947`*^9, {3.777655695653124*^9, 
   3.7776557123068047`*^9}, {3.777693230225377*^9, 3.7776932660143127`*^9}, {
   3.7776933011523733`*^9, 3.777693328784843*^9}, {3.777694097347481*^9, 
   3.777694150492193*^9}, {3.7776941810779676`*^9, 3.777694219308045*^9}, 
   3.777694962749426*^9, {3.777695013836192*^9, 3.7776950180168123`*^9}, 
   3.7776964104098587`*^9, 3.777696441006132*^9, 3.7776964877811937`*^9, {
   3.7776965241826363`*^9, 3.777696552569203*^9}, {3.7776966496348248`*^9, 
   3.7776966535844603`*^9}, 3.777696986643137*^9, 3.777697302696479*^9, 
   3.7776973489678507`*^9, {3.777697391327138*^9, 3.777697406558276*^9}, 
   3.777697471533635*^9, 3.777697647593596*^9, 3.777698073431943*^9, 
   3.777698203563562*^9, {3.7776984084243402`*^9, 3.777698413309342*^9}, {
   3.777698566107175*^9, 3.777698577255459*^9}, {3.777698621158636*^9, 
   3.7776986546876373`*^9}, {3.777713100065151*^9, 3.777713126144946*^9}, 
   3.7777131905912323`*^9, 3.777713978515605*^9, 3.7777140175629473`*^9, {
   3.777714235910007*^9, 3.777714244614205*^9}, 3.7777202405846643`*^9, {
   3.777720307446566*^9, 3.777720328676227*^9}, 3.777720520873822*^9, 
   3.7777207724239187`*^9, {3.777720875011373*^9, 
   3.77772088825711*^9}},ExpressionUUID->"1f6c1b95-cb44-4926-914c-\
9d2599394eef"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.4560554507750172`", 
      RowBox[{"-", "0.464835897448541`"}]},
     {"1.2175771958315256`", "1.7231321628288039`"},
     {
      RowBox[{"-", "0.6304032808126894`"}], "0.350917565630646`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7776555745078926`*^9, 3.7776556634953947`*^9, {3.777655695653124*^9, 
   3.7776557123068047`*^9}, {3.777693230225377*^9, 3.7776932660143127`*^9}, {
   3.7776933011523733`*^9, 3.777693328784843*^9}, {3.777694097347481*^9, 
   3.777694150492193*^9}, {3.7776941810779676`*^9, 3.777694219308045*^9}, 
   3.777694962749426*^9, {3.777695013836192*^9, 3.7776950180168123`*^9}, 
   3.7776964104098587`*^9, 3.777696441006132*^9, 3.7776964877811937`*^9, {
   3.7776965241826363`*^9, 3.777696552569203*^9}, {3.7776966496348248`*^9, 
   3.7776966535844603`*^9}, 3.777696986643137*^9, 3.777697302696479*^9, 
   3.7776973489678507`*^9, {3.777697391327138*^9, 3.777697406558276*^9}, 
   3.777697471533635*^9, 3.777697647593596*^9, 3.777698073431943*^9, 
   3.777698203563562*^9, {3.7776984084243402`*^9, 3.777698413309342*^9}, {
   3.777698566107175*^9, 3.777698577255459*^9}, {3.777698621158636*^9, 
   3.7776986546876373`*^9}, {3.777713100065151*^9, 3.777713126144946*^9}, 
   3.7777131905912323`*^9, 3.777713978515605*^9, 3.7777140175629473`*^9, {
   3.777714235910007*^9, 3.777714244614205*^9}, 3.7777202405846643`*^9, {
   3.777720307446566*^9, 3.777720328676227*^9}, 3.777720520873822*^9, 
   3.7777207724239187`*^9, {3.777720875011373*^9, 
   3.777720888259327*^9}},ExpressionUUID->"087d3f30-775a-45ac-819c-\
5ac4f90973e8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.4478217197761976`"}], "6.017438376783948`"},
     {"6.01742474990701`", 
      RowBox[{"-", "25.009627998323847`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7776555745078926`*^9, 3.7776556634953947`*^9, {3.777655695653124*^9, 
   3.7776557123068047`*^9}, {3.777693230225377*^9, 3.7776932660143127`*^9}, {
   3.7776933011523733`*^9, 3.777693328784843*^9}, {3.777694097347481*^9, 
   3.777694150492193*^9}, {3.7776941810779676`*^9, 3.777694219308045*^9}, 
   3.777694962749426*^9, {3.777695013836192*^9, 3.7776950180168123`*^9}, 
   3.7776964104098587`*^9, 3.777696441006132*^9, 3.7776964877811937`*^9, {
   3.7776965241826363`*^9, 3.777696552569203*^9}, {3.7776966496348248`*^9, 
   3.7776966535844603`*^9}, 3.777696986643137*^9, 3.777697302696479*^9, 
   3.7776973489678507`*^9, {3.777697391327138*^9, 3.777697406558276*^9}, 
   3.777697471533635*^9, 3.777697647593596*^9, 3.777698073431943*^9, 
   3.777698203563562*^9, {3.7776984084243402`*^9, 3.777698413309342*^9}, {
   3.777698566107175*^9, 3.777698577255459*^9}, {3.777698621158636*^9, 
   3.7776986546876373`*^9}, {3.777713100065151*^9, 3.777713126144946*^9}, 
   3.7777131905912323`*^9, 3.777713978515605*^9, 3.7777140175629473`*^9, {
   3.777714235910007*^9, 3.777714244614205*^9}, 3.7777202405846643`*^9, {
   3.777720307446566*^9, 3.777720328676227*^9}, 3.777720520873822*^9, 
   3.7777207724239187`*^9, {3.777720875011373*^9, 
   3.777720888261085*^9}},ExpressionUUID->"8ec5b09a-57af-40da-9614-\
83a5efa8020d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.4476828882729276`"}], "6.0181890897239505`"},
     {"6.01818908972395`", 
      RowBox[{"-", "25.01332677262682`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7776555745078926`*^9, 3.7776556634953947`*^9, {3.777655695653124*^9, 
   3.7776557123068047`*^9}, {3.777693230225377*^9, 3.7776932660143127`*^9}, {
   3.7776933011523733`*^9, 3.777693328784843*^9}, {3.777694097347481*^9, 
   3.777694150492193*^9}, {3.7776941810779676`*^9, 3.777694219308045*^9}, 
   3.777694962749426*^9, {3.777695013836192*^9, 3.7776950180168123`*^9}, 
   3.7776964104098587`*^9, 3.777696441006132*^9, 3.7776964877811937`*^9, {
   3.7776965241826363`*^9, 3.777696552569203*^9}, {3.7776966496348248`*^9, 
   3.7776966535844603`*^9}, 3.777696986643137*^9, 3.777697302696479*^9, 
   3.7776973489678507`*^9, {3.777697391327138*^9, 3.777697406558276*^9}, 
   3.777697471533635*^9, 3.777697647593596*^9, 3.777698073431943*^9, 
   3.777698203563562*^9, {3.7776984084243402`*^9, 3.777698413309342*^9}, {
   3.777698566107175*^9, 3.777698577255459*^9}, {3.777698621158636*^9, 
   3.7776986546876373`*^9}, {3.777713100065151*^9, 3.777713126144946*^9}, 
   3.7777131905912323`*^9, 3.777713978515605*^9, 3.7777140175629473`*^9, {
   3.777714235910007*^9, 3.777714244614205*^9}, 3.7777202405846643`*^9, {
   3.777720307446566*^9, 3.777720328676227*^9}, 3.777720520873822*^9, 
   3.7777207724239187`*^9, {3.777720875011373*^9, 
   3.777720888262762*^9}},ExpressionUUID->"9a2817ab-29c4-4a97-82c2-\
df9e4095bce2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.4472725707457945`"}], "6.017569144172293`"},
     {"6.017569144172293`", 
      RowBox[{"-", "25.01526182509649`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7776555745078926`*^9, 3.7776556634953947`*^9, {3.777655695653124*^9, 
   3.7776557123068047`*^9}, {3.777693230225377*^9, 3.7776932660143127`*^9}, {
   3.7776933011523733`*^9, 3.777693328784843*^9}, {3.777694097347481*^9, 
   3.777694150492193*^9}, {3.7776941810779676`*^9, 3.777694219308045*^9}, 
   3.777694962749426*^9, {3.777695013836192*^9, 3.7776950180168123`*^9}, 
   3.7776964104098587`*^9, 3.777696441006132*^9, 3.7776964877811937`*^9, {
   3.7776965241826363`*^9, 3.777696552569203*^9}, {3.7776966496348248`*^9, 
   3.7776966535844603`*^9}, 3.777696986643137*^9, 3.777697302696479*^9, 
   3.7776973489678507`*^9, {3.777697391327138*^9, 3.777697406558276*^9}, 
   3.777697471533635*^9, 3.777697647593596*^9, 3.777698073431943*^9, 
   3.777698203563562*^9, {3.7776984084243402`*^9, 3.777698413309342*^9}, {
   3.777698566107175*^9, 3.777698577255459*^9}, {3.777698621158636*^9, 
   3.7776986546876373`*^9}, {3.777713100065151*^9, 3.777713126144946*^9}, 
   3.7777131905912323`*^9, 3.777713978515605*^9, 3.7777140175629473`*^9, {
   3.777714235910007*^9, 3.777714244614205*^9}, 3.7777202405846643`*^9, {
   3.777720307446566*^9, 3.777720328676227*^9}, 3.777720520873822*^9, 
   3.7777207724239187`*^9, {3.777720875011373*^9, 
   3.777720888264413*^9}},ExpressionUUID->"99a92d58-b470-4881-bd99-\
17cb04e884fe"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "12.265598249135918`"}], "11.286819060130078`", 
      "6.8372115088195375`"},
     {"11.286819060130082`", 
      RowBox[{"-", "10.385672225543942`"}], 
      RowBox[{"-", "6.291577178842221`"}]},
     {"6.837211508819538`", 
      RowBox[{"-", "6.291577178842221`"}], 
      RowBox[{"-", "3.811263921162425`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7776555745078926`*^9, 3.7776556634953947`*^9, {3.777655695653124*^9, 
   3.7776557123068047`*^9}, {3.777693230225377*^9, 3.7776932660143127`*^9}, {
   3.7776933011523733`*^9, 3.777693328784843*^9}, {3.777694097347481*^9, 
   3.777694150492193*^9}, {3.7776941810779676`*^9, 3.777694219308045*^9}, 
   3.777694962749426*^9, {3.777695013836192*^9, 3.7776950180168123`*^9}, 
   3.7776964104098587`*^9, 3.777696441006132*^9, 3.7776964877811937`*^9, {
   3.7776965241826363`*^9, 3.777696552569203*^9}, {3.7776966496348248`*^9, 
   3.7776966535844603`*^9}, 3.777696986643137*^9, 3.777697302696479*^9, 
   3.7776973489678507`*^9, {3.777697391327138*^9, 3.777697406558276*^9}, 
   3.777697471533635*^9, 3.777697647593596*^9, 3.777698073431943*^9, 
   3.777698203563562*^9, {3.7776984084243402`*^9, 3.777698413309342*^9}, {
   3.777698566107175*^9, 3.777698577255459*^9}, {3.777698621158636*^9, 
   3.7776986546876373`*^9}, {3.777713100065151*^9, 3.777713126144946*^9}, 
   3.7777131905912323`*^9, 3.777713978515605*^9, 3.7777140175629473`*^9, {
   3.777714235910007*^9, 3.777714244614205*^9}, 3.7777202405846643`*^9, {
   3.777720307446566*^9, 3.777720328676227*^9}, 3.777720520873822*^9, 
   3.7777207724239187`*^9, {3.777720875011373*^9, 
   3.777720888266095*^9}},ExpressionUUID->"eec494bc-f799-46d8-a60d-\
5fbbff9a5070"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"Transpose", "[", "A", "]"}], "]"}], ".", "II0", ".", 
     RowBox[{"Inverse", "[", "A", "]"}]}], "//", "MatrixForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", "R", "]"}], ".", "L0", ".", "R"}], " ", "//", 
    " ", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.7776555603863373`*^9, 
  3.77765556091516*^9}},ExpressionUUID->"22b10274-332d-4853-868c-\
c621db876994"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.4478217900260286`"}], "6.0174386687545`"},
     {"6.017422391440349`", 
      RowBox[{"-", "25.009618196061027`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.777655538658267*^9, 
  3.777655561241064*^9}},ExpressionUUID->"47eb07d5-f97a-4f47-b013-\
7272489bdfb5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.447843068186367`"}], "6.018820042110465`"},
     {"6.018820042110466`", 
      RowBox[{"-", "25.012695889215365`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.777655538658267*^9, 
  3.777655561248062*^9}},ExpressionUUID->"6394b429-d085-4054-8c08-\
f6008735c181"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", "F0", "]"}], ".", "L0", ".", "F0"}], " ", "//", 
  " ", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FtF", " ", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "F0", "]"}], ".", "F0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Normalize", "[", 
       RowBox[{"F0", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Normalize", "[", 
        RowBox[{
         RowBox[{"F0", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "\[Cross]", 
         RowBox[{"F0", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "2"}], "]"}], "]"}]}], "]"}], 
       "\[Cross]", 
       RowBox[{"Normalize", "[", 
        RowBox[{"F0", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}]}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", " ", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", "R", "]"}], ".", "F0"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", 
    RowBox[{"Transpose", "[", "A", "]"}], "]"}], ".", "II0", ".", 
   RowBox[{"Inverse", "[", "A", "]"}]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"Transpose", "[", "A", "]"}], "]"}], ".", "II0", ".", 
     RowBox[{"Inverse", "[", "A", "]"}]}], ")"}], ".", 
   RowBox[{"Transpose", "[", "R", "]"}]}], " ", "//", " ", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", "R", "]"}], ".", "L0", ".", "R"}], " ", "//", 
  " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7776500436295724`*^9, 3.777650057103483*^9}, {
  3.7776505894016886`*^9, 3.7776505952571354`*^9}, {3.7776507214402623`*^9, 
  3.777650760697605*^9}, {3.777653696598625*^9, 3.777653910259383*^9}, {
  3.777653992126243*^9, 3.7776540440606394`*^9}, {3.7776545538718147`*^9, 
  3.7776545877829766`*^9}, {3.777655001452859*^9, 3.777655039372737*^9}, {
  3.777655394552313*^9, 
  3.777655431044652*^9}},ExpressionUUID->"ecceba40-909e-48ab-b0d7-\
cce0c42d3ea6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "4.691011540923826`"}], "16.90959210027369`"},
     {"16.909592100273688`", 
      RowBox[{"-", "60.937059054649545`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.777650057608927*^9, 3.7776505954446363`*^9, 3.777650761087318*^9, 
   3.7776512081358547`*^9, {3.7776537452430887`*^9, 3.777653758052003*^9}, {
   3.7776537945153413`*^9, 3.7776538215517178`*^9}, 3.777653910496311*^9, {
   3.7776540113710876`*^9, 3.777654044486501*^9}, 3.77765458851274*^9, 
   3.7776546232336683`*^9, {3.777655008567587*^9, 3.7776550395766726`*^9}, {
   3.7776554153226695`*^9, 3.7776554315894823`*^9}, 
   3.777655505676818*^9},ExpressionUUID->"945bf14e-1538-4f2e-ba0c-\
4212670065e1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.4478217900260286`"}], "6.0174386687545`"},
     {"6.017422391440349`", 
      RowBox[{"-", "25.009618196061027`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.777650057608927*^9, 3.7776505954446363`*^9, 3.777650761087318*^9, 
   3.7776512081358547`*^9, {3.7776537452430887`*^9, 3.777653758052003*^9}, {
   3.7776537945153413`*^9, 3.7776538215517178`*^9}, 3.777653910496311*^9, {
   3.7776540113710876`*^9, 3.777654044486501*^9}, 3.77765458851274*^9, 
   3.7776546232336683`*^9, {3.777655008567587*^9, 3.7776550395766726`*^9}, {
   3.7776554153226695`*^9, 3.7776554315894823`*^9}, 
   3.777655505683799*^9},ExpressionUUID->"63fd0e89-d0bf-47f4-a3bb-\
47206294f8cb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "12.264227220483246`"}], "11.284203929238366`", 
      "6.836351333406548`"},
     {"11.28418935460812`", 
      RowBox[{"-", "10.382480001746611`"}], 
      RowBox[{"-", "6.290056564831641`"}]},
     {"6.8363503005040025`", 
      RowBox[{"-", "6.290063738688451`"}], 
      RowBox[{"-", "3.8107327638571995`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.777650057608927*^9, 3.7776505954446363`*^9, 3.777650761087318*^9, 
   3.7776512081358547`*^9, {3.7776537452430887`*^9, 3.777653758052003*^9}, {
   3.7776537945153413`*^9, 3.7776538215517178`*^9}, 3.777653910496311*^9, {
   3.7776540113710876`*^9, 3.777654044486501*^9}, 3.77765458851274*^9, 
   3.7776546232336683`*^9, {3.777655008567587*^9, 3.7776550395766726`*^9}, {
   3.7776554153226695`*^9, 3.7776554315894823`*^9}, 
   3.7776555056908064`*^9},ExpressionUUID->"0c7c7909-032c-4d28-b7a2-\
95ed44afc195"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.447843068186367`"}], "6.018820042110465`"},
     {"6.018820042110466`", 
      RowBox[{"-", "25.012695889215365`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.777650057608927*^9, 3.7776505954446363`*^9, 3.777650761087318*^9, 
   3.7776512081358547`*^9, {3.7776537452430887`*^9, 3.777653758052003*^9}, {
   3.7776537945153413`*^9, 3.7776538215517178`*^9}, 3.777653910496311*^9, {
   3.7776540113710876`*^9, 3.777654044486501*^9}, 3.77765458851274*^9, 
   3.7776546232336683`*^9, {3.777655008567587*^9, 3.7776550395766726`*^9}, {
   3.7776554153226695`*^9, 3.7776554315894823`*^9}, 
   3.777655505694796*^9},ExpressionUUID->"a93fdc12-4749-4ef8-bd87-\
2a895e1d516e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", " ", "OLD"}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"COPIES", " ", "--"}], "--"}], "--"}], "--"}], 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", "-"}]}]}]}]}]}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7773976994120007`*^9, 
  3.777397718939777*^9}},ExpressionUUID->"288bc807-25c3-45a6-92e4-\
4b4c964d2239"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rot", "[", 
    RowBox[{"n_", ",", "x_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"n", 
     RowBox[{"(", 
      RowBox[{"n", ".", "x"}], ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{"n", "\[Cross]", "x"}], ")"}]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"rot", " ", "x", " ", "around", " ", "n", " ", "by"}], " ", "-", 
     RowBox[{"Pi", "/", "2"}]}], ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "90"}], "deg", " ", "rotation", " ", 
     "clockwise"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ApproxLambdaTri", "[", 
    RowBox[{"x_", ",", "n_", ",", 
     RowBox[{"num_:", "32"}], ",", 
     RowBox[{"dx_:", 
      RowBox[{"1", "/", "1000"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "k", ",", "P", ",", "p", ",", " ", "s", ",", "A", ",", "X0", 
       ",", "X1", ",", "x0", ",", "x1", ",", "xn", ",", "Ti", ",", "Ei", ",", 
       "n0", ",", "ni", ",", "ei", ",", "\[Theta]i", ",", "\[CapitalLambda]", 
       ",", " ", "TMP"}], " ", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", " ", "=", 
       RowBox[{"dx", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"Cos", "[", "0", "]"}], 
            RowBox[{"Sin", "[", "0", "]"}]},
           {
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["2", "3"], "Pi"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{
              FractionBox["2", "3"], "Pi"}], "]"}]},
           {
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["4", "3"], "Pi"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{
              FractionBox["4", "3"], "Pi"}], "]"}]},
           {
            RowBox[{"2", 
             RowBox[{"Cos", "[", 
              FractionBox["Pi", "3"], "]"}]}], 
            RowBox[{"2", 
             RowBox[{"Sin", "[", 
              FractionBox["Pi", "3"], "]"}]}]},
           {
            RowBox[{"2", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"3", "Pi"}], "3"], "]"}]}], 
            RowBox[{"2", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"3", "Pi"}], "3"], "]"}]}]},
           {
            RowBox[{"2", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"5", "Pi"}], "3"], "]"}]}], 
            RowBox[{"2", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"5", "Pi"}], "3"], "]"}]}]}
          }], "\[NoBreak]", ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", 
         RowBox[{"P", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{
        FractionBox[
         RowBox[{"Sqrt", "[", "3", "]"}], "4"], 
        SuperscriptBox["s", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "0"}], ",", 
        RowBox[{"k", "<", "num"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"P", ".", " ", 
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"2", " ", 
               RowBox[{"Pi", " ", "/", " ", "num"}]}], "]"}]}], ")"}], " ", "//",
            " ", "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p", " ", "=", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"x", " ", "@@", " ", 
              RowBox[{"P", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], " ", "//", 
           " ", "N"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"get", " ", "world", " ", "space", " ", "points"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"n0", " ", "=", " ", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"p", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "\[Cross]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "-", 
              RowBox[{"p", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"compute", " ", "world", " ", "space", " ", "normal"}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "0"}], ",", 
           RowBox[{"i", "<", "3"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"X0", " ", "=", 
             RowBox[{"P", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"X1", " ", "=", 
             RowBox[{"P", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "3"}], "]"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Ei", " ", "=", " ", 
             RowBox[{"X1", "-", "X0"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Ti", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Ei", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
               RowBox[{"-", 
                RowBox[{"Ei", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"x0", " ", "=", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"x1", " ", "=", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "3"}], "]"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"xn", " ", "=", " ", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"4", "+", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ni", " ", "=", " ", 
             RowBox[{"Normalize", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"xn", "-", "x0"}], ")"}], "\[Cross]", 
               RowBox[{"(", 
                RowBox[{"x1", "-", "x0"}], ")"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ei", " ", "=", 
             RowBox[{"x1", "-", "x0"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[Theta]i", "=", " ", 
             RowBox[{"-", 
              RowBox[{"Angle", "[", 
               RowBox[{"n0", ",", "ni", ",", 
                RowBox[{"Normalize", "[", "ei", "]"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"\[CapitalLambda]", " ", "=", 
             RowBox[{
              RowBox[{"\[CapitalLambda]", " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Theta]i", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", "A", " ", 
                    RowBox[{"Norm", "[", "Ti", "]"}]}], ")"}]}], 
                 RowBox[{"(", 
                  RowBox[{"Ti", "\[CircleTimes]", "Ti"}], ")"}]}], ")"}]}], 
              " ", "//", " ", "N"}]}]}]}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"TMP", " ", "=", 
             RowBox[{
              RowBox[{"x", "@@", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"X1", "+", "X0"}], "2"], "+", 
                 RowBox[{"Ti", "/", "2"}]}], ")"}]}], " ", "-", " ", 
              RowBox[{"x", "@@", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"X1", "+", "X0"}], "2"], "-", 
                 RowBox[{"Ti", "/", "2"}]}], ")"}]}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"\[CapitalLambda]", " ", "=", 
             RowBox[{
              RowBox[{"\[CapitalLambda]", " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Theta]i", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", "A", " ", 
                    RowBox[{"Norm", "[", "TMP", "]"}]}], ")"}]}], 
                 RowBox[{"(", 
                  RowBox[{"TMP", "\[CircleTimes]", "Ti"}], ")"}]}], ")"}]}], 
              " ", "//", " ", "N"}]}]}], "*)"}], "\[IndentingNewLine]", "]"}],
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", "/", "num"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApproxDN", "[", 
    RowBox[{"x_", ",", "n_", ",", 
     RowBox[{"num_:", "32"}], ",", 
     RowBox[{"dx_:", 
      RowBox[{"1", "/", "1000"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "k", ",", "P", ",", "p", ",", " ", "s", ",", "A", ",", "X0", 
       ",", "X1", ",", "x0", ",", "x1", ",", "xn", ",", "ti", ",", "Ti", ",", 
       "Ei", ",", "n0", ",", "ni", ",", "ei", ",", "\[Theta]i", ",", "F", ",",
        "dN", " ", ",", "SVD", ",", "Q"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", " ", "=", 
       RowBox[{"dx", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"Cos", "[", "0", "]"}], 
            RowBox[{"Sin", "[", "0", "]"}]},
           {
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["2", "3"], "Pi"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{
              FractionBox["2", "3"], "Pi"}], "]"}]},
           {
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["4", "3"], "Pi"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{
              FractionBox["4", "3"], "Pi"}], "]"}]},
           {
            RowBox[{"2", 
             RowBox[{"Cos", "[", 
              FractionBox["Pi", "3"], "]"}]}], 
            RowBox[{"2", 
             RowBox[{"Sin", "[", 
              FractionBox["Pi", "3"], "]"}]}]},
           {
            RowBox[{"2", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"3", "Pi"}], "3"], "]"}]}], 
            RowBox[{"2", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"3", "Pi"}], "3"], "]"}]}]},
           {
            RowBox[{"2", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"5", "Pi"}], "3"], "]"}]}], 
            RowBox[{"2", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"5", "Pi"}], "3"], "]"}]}]}
          }], "\[NoBreak]", ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", 
         RowBox[{"P", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{
        FractionBox[
         RowBox[{"Sqrt", "[", "3", "]"}], "4"], 
        SuperscriptBox["s", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dN", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "0"}], ",", 
        RowBox[{"k", "<", "num"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"P", ".", " ", 
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"2", " ", 
               RowBox[{"Pi", " ", "/", " ", "num"}]}], "]"}]}], ")"}], " ", "//",
            " ", "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p", " ", "=", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"x", " ", "@@", " ", 
              RowBox[{"P", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], " ", "//", 
           " ", "N"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"get", " ", "world", " ", "space", " ", "points"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"n0", " ", "=", " ", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"p", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "\[Cross]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "-", 
              RowBox[{"p", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"compute", " ", "world", " ", "space", " ", "normal"}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"F", "=", " ", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"p", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "-", 
               RowBox[{"p", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}], ".", " ", 
           RowBox[{"Inverse", "[", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"SVD", " ", "=", " ", 
            RowBox[{"SingularValueDecomposition", "[", "F", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"F", " ", "=", " ", 
            RowBox[{
             RowBox[{"SVD", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ".", 
             RowBox[{"SVD", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"TODO", " ", "TRY", " ", "CURRENT", " ", 
           RowBox[{"AREA", "?"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"A", " ", "=", " ", 
          FractionBox[
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"p", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "\[Cross]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "-", 
               RowBox[{"p", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "2"]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "0"}], ",", 
           RowBox[{"i", "<", "3"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"X0", " ", "=", 
             RowBox[{"P", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"X1", " ", "=", 
             RowBox[{"P", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "3"}], "]"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Ei", " ", "=", " ", 
             RowBox[{"X1", "-", "X0"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"x0", " ", "=", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"x1", " ", "=", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "3"}], "]"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"xn", " ", "=", " ", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"4", "+", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ni", " ", "=", " ", 
             RowBox[{"Normalize", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"xn", "-", "x0"}], ")"}], "\[Cross]", 
               RowBox[{"(", 
                RowBox[{"x1", "-", "x0"}], ")"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ei", " ", "=", 
             RowBox[{"x1", "-", "x0"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Ti", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Ei", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
               RowBox[{"-", 
                RowBox[{"Ei", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"\[Theta]i", "=", " ", 
             RowBox[{"Angle", "[", 
              RowBox[{"n0", ",", "ni", ",", 
               RowBox[{"Normalize", "[", "ei", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ti", " ", "=", " ", 
             RowBox[{"rot", "[", 
              RowBox[{
               RowBox[{"Normalize", "[", 
                FractionBox[
                 RowBox[{"n0", "+", "ni"}], "2"], "]"}], ",", "ei"}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"dN", " ", "=", 
             RowBox[{
              RowBox[{"dN", " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Norm", "[", "ei", "]"}], 
                 RowBox[{"\[Theta]i", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", "A"}], ")"}]}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Normalize", "[", "ti", "]"}], "\[CircleTimes]", 
                    RowBox[{"Normalize", "[", "ti", "]"}]}], ")"}], ".", 
                  "F"}]}], ")"}]}], " ", "//", " ", "N"}]}], ";"}]}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"dN", " ", "=", 
             RowBox[{
              RowBox[{"dN", " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Norm", "[", "ei", "]"}], 
                 RowBox[{"\[Theta]i", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", "A"}], ")"}]}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Normalize", "[", "ti", "]"}], "\[CircleTimes]", 
                   RowBox[{"(", 
                    RowBox[{"Normalize", "[", "Ti", "]"}], ")"}]}], ")"}]}], 
                ")"}]}], " ", "//", " ", "N"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"dN", "/", "num"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "[", 
     RowBox[{"u_", ",", "v_"}], "]"}], "=", 
    RowBox[{"MakeCyl", "[", 
     RowBox[{"2", ",", "0.3", ",", "1.5", ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", "7", "]"}]}], "*", "10"}], ",", 
      RowBox[{
       RowBox[{"Sqrt", "[", "2", "]"}], "+", 
       RowBox[{"1", "*", 
        RowBox[{"Pi", "/", "8"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"u_", ",", "v_"}], "]"}], "=", " ", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"sx", 
             RowBox[{"sa", " ", "sy"}]},
            {"0", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", " ", "-", " ", 
                SuperscriptBox["sa", "2"]}], "]"}], " ", "sy"}]},
            {"0", "0"}
           }], "\[NoBreak]", ")"}], ".", 
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}], ".", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"a", "b"},
              {"b", "c"}
             }], "\[NoBreak]", ")"}], ".", 
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}]}], ")"}]}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sx", "\[Rule]", " ", "2"}], ",", " ", 
        RowBox[{"sa", "\[Rule]", " ", 
         RowBox[{"-", ".3"}]}], ",", " ", 
        RowBox[{"sy", "\[Rule]", " ", "0.9"}], ",", 
        RowBox[{"a", "\[Rule]", "1"}], ",", 
        RowBox[{"b", "\[Rule]", "3"}], ",", 
        RowBox[{"c", "\[Rule]", 
         RowBox[{"-", "1"}]}]}], "}"}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"u", ",", "v"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F0", " ", "=", " ", 
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"u", ",", "v"}], "]"}], ",", 
       RowBox[{"u", "\[Rule]", " ", "0"}]}], "]"}], ",", 
     RowBox[{"v", "\[Rule]", "0"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], " ", "=", " ", 
   RowBox[{"Normalize", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{"u", ",", "v"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "\[Cross]", 
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{"u", ",", "v"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", "2"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n0", " ", "=", " ", 
    RowBox[{"n", "[", 
     RowBox[{
      RowBox[{"1", "/", "1000"}], ",", 
      RowBox[{"1", "/", "1000"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"n0", " ", "=", " ", 
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{"n", "[", 
          RowBox[{"u", ",", "v"}], "]"}], ",", 
         RowBox[{"u", "\[Rule]", " ", "0"}]}], "]"}], ",", 
       RowBox[{"v", "\[Rule]", "0"}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"duv", " ", "=", " ", "0.0001"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"TODO", " ", "CONTINUE"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "CONSTRUCT", " ", "projected", " ", "Kappa", " ", "from", " ", "LAMBDA",
        " ", "VIA", " ", "II", " ", "OR", " ", "SO"}], "..."}], "."}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dN0", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"duv", ",", "v"}], "]"}], "-", 
          RowBox[{"n", "[", 
           RowBox[{
            RowBox[{"-", "duv"}], ",", "v"}], "]"}]}], ",", 
         RowBox[{"v", "\[Rule]", " ", "0"}]}], "]"}], 
       RowBox[{"2", "duv"}]], ",", 
      FractionBox[
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"u", ",", "duv"}], "]"}], "-", 
          RowBox[{"n", "[", 
           RowBox[{"u", ",", 
            RowBox[{"-", "duv"}]}], "]"}]}], ",", 
         RowBox[{"u", "\[Rule]", " ", "0"}]}], "]"}], 
       RowBox[{"2", "duv"}]]}], "}"}], "]"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{
   "could", " ", "also", " ", "speed", " ", "up", " ", "by", " ", "doing", 
    " ", "eps", " ", "instead", " ", "of", " ", "limit"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dN0", " ", "=", " ", 
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{"Grad", "[", 
          RowBox[{
           RowBox[{"n", "[", 
            RowBox[{"u", ",", "v"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}]}], "]"}], ",", 
         RowBox[{"u", "\[Rule]", " ", "0"}]}], "]"}], ",", 
       RowBox[{"v", "\[Rule]", "0"}]}], "]"}]}], ";", "  ", "SLOW"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"II0", " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"Transpose", "[", "dN0", "]"}], ".", "F0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L0", " ", "=", 
   RowBox[{
    RowBox[{"ApproxLambdaTri", "[", 
     RowBox[{"x", ",", "n", ",", "16", ",", 
      RowBox[{"1", "/", "1000"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "\[Rule]", " ", 
       RowBox[{"1", "/", "1000"}]}], ",", " ", 
      RowBox[{"v", "\[Rule]", " ", 
       RowBox[{"1", "/", "1000"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L0c", " ", "=", 
   RowBox[{
    RowBox[{"ApproxLambdaTriCorrect", "[", 
     RowBox[{"x", ",", "n", ",", "16", ",", 
      RowBox[{"1", "/", "1000"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "\[Rule]", " ", 
       RowBox[{"1", "/", "1000"}]}], ",", " ", 
      RowBox[{"v", "\[Rule]", " ", 
       RowBox[{"1", "/", "1000"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotL", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<II: \>\"", ",", 
   RowBox[{"NumberForm", "[", 
    RowBox[{
     RowBox[{"II0", "//", " ", "MatrixForm"}], ",", "4"}], "]"}], ",", " ", 
   "\"\<    \[CapitalLambda]tri: \>\"", ",", 
   RowBox[{"NumberForm", "[", 
    RowBox[{
     RowBox[{"L0", "//", " ", "MatrixForm"}], ",", "4"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[CapitalLambda]corrected: \>\"", ",", 
   RowBox[{"NumberForm", "[", 
    RowBox[{
     RowBox[{"L0c", "//", " ", "MatrixForm"}], ",", "4"}], "]"}], ",", " ", 
   "\"\<    IIfromLam: \>\"", ",", 
   RowBox[{"NumberForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", "F0", "]"}], ".", "L0c", ".", "F0"}], "//", 
      " ", "MatrixForm"}], ",", "4"}], "]"}], ",", " ", 
   "\"\<    dNfromLam: \>\"", ",", 
   RowBox[{"NumberForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"L0c", ".", "F0"}], "//", " ", "MatrixForm"}], ",", "4"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<n,u n,v: \>\"", ",", 
   RowBox[{
    RowBox[{"NumberForm", "[", 
     RowBox[{
      RowBox[{"dN0", "//", " ", "MatrixForm"}], ",", "4"}], "]"}], "//", " ", 
    "MatrixForm"}], ",", "\"\<    x,u x,v: \>\"", ",", 
   RowBox[{
    RowBox[{"NumberForm", "[", 
     RowBox[{
      RowBox[{"F0", "//", " ", "MatrixForm"}], ",", "4"}], "]"}], "//", " ", 
    "MatrixForm"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<approx dN: \>\"", ",", 
   RowBox[{
    RowBox[{"NumberForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ApproxDN", "[", 
          RowBox[{"x", ",", "n", ",", "8", ",", 
           RowBox[{"1", "/", "1000"}]}], "]"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "\[Rule]", " ", 
           RowBox[{"1", "/", "1000"}]}], ",", " ", 
          RowBox[{"v", "\[Rule]", " ", 
           RowBox[{"1", "/", "1000"}]}]}], "}"}]}], "//", " ", "MatrixForm"}],
       ",", "4"}], "]"}], "//", " ", "MatrixForm"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<K: \>\"", ",", 
   RowBox[{
    RowBox[{"NumberForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Inverse", "[", 
          RowBox[{"F0", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "2"}], ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}], "]"}], ".", 
        "II0", ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"F0", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "2"}], ",", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}]}], "//", " ", 
       "MatrixForm"}], ",", "4"}], "]"}], "//", " ", "MatrixForm"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.777649491672103*^9, 
  3.777649492236278*^9}},ExpressionUUID->"749c92e4-67bd-42f9-af62-\
101448c38365"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Angle", "[", 
     RowBox[{"u_", ",", "v_", ",", " ", "n_"}], "]"}], ":=", " ", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"u", ".", "v"}], ",", 
      RowBox[{"n", ".", " ", 
       RowBox[{"Cross", "[", 
        RowBox[{"u", ",", "v"}], "]"}]}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"note", " ", "that", " ", "mathematica", " ", "arctan", 
     RowBox[{"(", 
      RowBox[{"x", ",", "y"}], ")"}], " ", "vs", " ", "cpp", " ", "atan2", 
     RowBox[{"(", 
      RowBox[{"y", ",", "x"}], ")"}]}], ",", " ", 
    RowBox[{"assume", " ", "normalized", " ", "u", " ", "v", " ", "n"}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x_", "\[CircleTimes]", "y_"}], ":=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", "x", ",", "y"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApproxLambdaOLD", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dx", ",", "A", ",", "tx", ",", "ty", ",", " ", "\[Theta]R", ",", " ", 
       "\[Theta]L", ",", " ", "\[Theta]T", ",", "\[Theta]B", ",", 
       "\[CapitalLambda]"}], " ", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\[Theta]0", " ", "=", 
        RowBox[{"-", 
         RowBox[{"Angle", "[", 
          RowBox[{"n", ",", "n0", ",", " ", 
           RowBox[{"Normalize", "[", 
            RowBox[{"x1", "-", " ", "x0"}], "]"}]}], "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalLambda]", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"phi", "[", "\[Theta]0", "]"}], "-", 
             RowBox[{"phi", "[", "thetarest0", "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", "A", " ", "l0"}], ")"}]}], 
          RowBox[{"tot", "[", "\"\<t0\>\"", "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"phi", "[", "\[Theta]1", "]"}], "-", 
             RowBox[{"phi", "[", "thetarest1", "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", "A", " ", "l1"}], ")"}]}], " ", 
          RowBox[{"tot", "[", "\"\<t1\>\"", "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"phi", "[", "\[Theta]2", "]"}], "-", 
             RowBox[{"phi", "[", "thetarest2", "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", "A", " ", "l2"}], ")"}]}], " ", 
          RowBox[{"tot", "[", "\"\<t2\>\"", "]"}]}]}]}], ";"}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dx", " ", "=", " ", "0.01"}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       SuperscriptBox["dx", "2"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tx", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"dx", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ty", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "dx"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]R", " ", "=", " ", 
       RowBox[{"-", 
        RowBox[{"Angle", "[", 
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"u", ",", "v"}], "]"}], ",", 
          RowBox[{"n", "[", 
           RowBox[{
            RowBox[{"u", "+", "dx"}], ",", "v"}], "]"}], ",", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"u", "+", 
               RowBox[{"dx", "/", "2"}]}], ",", 
              RowBox[{"v", "+", 
               RowBox[{"dx", "/", "2"}]}]}], "]"}], "-", 
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"u", "+", 
               RowBox[{"dx", "/", "2"}]}], ",", 
              RowBox[{"v", "-", 
               RowBox[{"dx", "/", "2"}]}]}], "]"}]}], "]"}]}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[Theta]T", " ", "=", " ", 
       RowBox[{"-", 
        RowBox[{"Angle", "[", 
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"u", ",", "v"}], "]"}], ",", 
          RowBox[{"n", "[", 
           RowBox[{"u", ",", 
            RowBox[{"v", "+", "dx"}]}], "]"}], ",", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"u", "-", 
               RowBox[{"dx", "/", "2"}]}], ",", 
              RowBox[{"v", "+", 
               RowBox[{"dx", "/", "2"}]}]}], "]"}], "-", 
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"u", "+", 
               RowBox[{"dx", "/", "2"}]}], ",", 
              RowBox[{"v", "+", 
               RowBox[{"dx", "/", "2"}]}]}], "]"}]}], "]"}]}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[Theta]L", " ", "=", " ", 
       RowBox[{"-", 
        RowBox[{"Angle", "[", 
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"u", ",", "v"}], "]"}], ",", 
          RowBox[{"n", "[", 
           RowBox[{
            RowBox[{"u", "-", "dx"}], ",", "v"}], "]"}], ",", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"u", "-", 
               RowBox[{"dx", "/", "2"}]}], ",", 
              RowBox[{"v", "-", 
               RowBox[{"dx", "/", "2"}]}]}], "]"}], "-", 
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"u", "-", 
               RowBox[{"dx", "/", "2"}]}], ",", 
              RowBox[{"v", "+", 
               RowBox[{"dx", "/", "2"}]}]}], "]"}]}], "]"}]}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[Theta]B", " ", "=", " ", 
       RowBox[{"-", 
        RowBox[{"Angle", "[", 
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"u", ",", "v"}], "]"}], ",", 
          RowBox[{"n", "[", 
           RowBox[{"u", ",", 
            RowBox[{"v", "-", "dx"}]}], "]"}], ",", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"u", "+", 
               RowBox[{"dx", "/", "2"}]}], ",", 
              RowBox[{"v", "-", 
               RowBox[{"dx", "/", "2"}]}]}], "]"}], "-", 
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"u", "-", 
               RowBox[{"dx", "/", "2"}]}], ",", 
              RowBox[{"v", "-", 
               RowBox[{"dx", "/", "2"}]}]}], "]"}]}], "]"}]}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", " ", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]R", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "A", " ", "dx"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"tx", "\[CircleTimes]", "tx"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Theta]T", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "A", " ", "dx"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"ty", "\[CircleTimes]", "ty"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Theta]L", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "A", " ", "dx"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "tx"}], "\[CircleTimes]", 
           RowBox[{"-", "tx"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Theta]B", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "A", " ", "dx"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ty"}], "\[CircleTimes]", 
           RowBox[{"-", "ty"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[CapitalLambda]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApproxLambda", "[", 
    RowBox[{"x_", ",", "n_", ",", 
     RowBox[{"num_:", "32"}], ",", 
     RowBox[{"off_:", "0"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "k", ",", "dx", ",", "P", ",", " ", "s", ",", "A", ",", "X0", 
       ",", "X1", ",", "XM", ",", "Ti", ",", "Ei", ",", "n0", ",", "ni", ",", 
       "ei", ",", "\[Theta]i", ",", "\[CapitalLambda]"}], " ", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dx", " ", "=", " ", "0.01"}], ";", "\[IndentingNewLine]", 
      RowBox[{"P", " ", "=", 
       RowBox[{"dx", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {
             RowBox[{"1", "/", "2"}], 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}]},
            {
             RowBox[{"1", "/", "2"}], 
             RowBox[{"1", "/", "2"}]},
            {
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], 
             RowBox[{"1", "/", "2"}]},
            {
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}]}
           }], "\[NoBreak]", ")"}], ".", 
         RowBox[{"RotationMatrix", "[", "off", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", 
         RowBox[{"P", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       SuperscriptBox["s", "2"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "0"}], ",", 
        RowBox[{"k", "<", "num"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", " ", "=", " ", 
          RowBox[{"P", ".", " ", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"2", " ", 
             RowBox[{"Pi", " ", "/", " ", "num"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "0"}], ",", 
           RowBox[{"i", "<", "4"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"X0", " ", "=", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"u", ",", "v"}], "}"}], "+"}], "*)"}], 
             RowBox[{"P", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", 
                RowBox[{"Mod", "[", 
                 RowBox[{"i", ",", "4"}], "]"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"X1", " ", "=", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"u", ",", "v"}], "}"}], "+"}], "*)"}], 
             RowBox[{"P", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "4"}], "]"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Ei", " ", "=", " ", 
             RowBox[{"X1", "-", "X0"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Ti", " ", "=", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Ei", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"-", 
                 RowBox[{"Ei", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], " ", "*", " ", 
              "0.9"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"XM", " ", "=", " ", 
             FractionBox[
              RowBox[{"X0", "+", "X1"}], "2"]}], ";", "\[IndentingNewLine]", 
            RowBox[{"n0", " ", "=", " ", 
             RowBox[{"n", "@@", 
              RowBox[{"(", 
               RowBox[{"XM", " ", "-", " ", 
                RowBox[{"Ti", "/", "2"}]}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ni", " ", "=", " ", 
             RowBox[{"n", "@@", 
              RowBox[{"(", 
               RowBox[{"XM", " ", "+", " ", 
                RowBox[{"Ti", "/", "2"}]}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ei", " ", "=", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "@@", "X1"}], ")"}], " ", "-", " ", 
              RowBox[{"(", 
               RowBox[{"x", " ", "@@", "X0"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"\[Theta]i", "=", " ", 
             RowBox[{"-", 
              RowBox[{"Angle", "[", 
               RowBox[{"n0", ",", "ni", ",", 
                RowBox[{"Normalize", "[", "ei", "]"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"\[CapitalLambda]", " ", "=", 
             RowBox[{"\[CapitalLambda]", " ", "+", " ", 
              RowBox[{
               RowBox[{"\[Theta]i", "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "A", " ", 
                  RowBox[{"Norm", "[", "Ti", "]"}]}], ")"}]}], 
               RowBox[{"(", 
                RowBox[{"Ti", "\[CircleTimes]", "Ti"}], ")"}]}]}]}], "  ", 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", "/", "num"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApproxLambdaCool", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dx", ",", "num", ",", "da", ",", " ", "daoff", ",", "R", ",", " ", "b",
        ",", "A", ",", "ti", ",", " ", "uvin", ",", " ", "uvout", ",", " ", 
       "ni", ",", " ", "nj", ",", "Ei", ",", "uv0", ",", "uv1", ",", "ei", 
       ",", " ", "\[Theta]", ",", "\[CapitalLambda]"}], " ", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"ref", ".", "space"}], " ", "circley", " ", "ngon"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dx", " ", "=", " ", "0.001"}], ";", " ", 
      RowBox[{"R", " ", "=", " ", 
       FractionBox["dx", "2"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"num", "=", " ", "4"}], ";", " ", 
      RowBox[{"da", "=", " ", 
       RowBox[{"2", " ", 
        RowBox[{"Pi", " ", "/", " ", "num"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"daoff", " ", "=", " ", 
       RowBox[{"da", "/", "3"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", " ", "=", " ", 
       RowBox[{"dx", " ", 
        RowBox[{"Sin", "[", 
         FractionBox["da", "2"], "]"}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"opp", " ", "side", " ", "len"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", 
       RowBox[{"num", " ", "*", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], 
          SuperscriptBox["R", "2"], 
          RowBox[{"Sin", "[", "da", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"i", "<", "num"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ti", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"i", " ", "da"}], " ", "+", "daoff"}], "]"}], ",", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"i", " ", "da"}], "+", "daoff"}], "]"}]}], "}"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"uvin", " ", "=", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"R", "-", 
              RowBox[{"b", "/", "2"}]}], ")"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"i", " ", "da"}], "+", "daoff"}], "]"}], ",", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"i", " ", "da"}], "+", "daoff"}], "]"}]}], 
             "}"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"uvout", "=", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"R", "+", 
              RowBox[{"b", "/", "2"}]}], ")"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"i", " ", "da"}], "+", "daoff"}], "]"}], ",", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"i", " ", "da"}], "+", "daoff"}], "]"}]}], 
             "}"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ni", " ", "=", " ", 
          RowBox[{"n", "[", 
           RowBox[{
            RowBox[{"uvin", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"uvin", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nj", " ", "=", " ", 
          RowBox[{"n", "[", 
           RowBox[{
            RowBox[{"uvout", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"uvout", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Ei", " ", "=", " ", 
          RowBox[{"b", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"ti", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"ti", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"uv0", " ", "=", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}], " ", "+", " ", 
           RowBox[{"R", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"i", " ", "da"}], "+", "daoff"}], "]"}], ",", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"i", " ", "da"}], "+", "daoff"}], "]"}]}], "}"}]}], 
           " ", "-", " ", 
           RowBox[{"Ei", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"uv1", "=", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}], " ", "+", " ", 
           RowBox[{"R", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"i", " ", "da"}], "+", "daoff"}], "]"}], ",", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"i", " ", "da"}], "+", "daoff"}], "]"}]}], "}"}]}], 
           "+", 
           RowBox[{"Ei", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ei", " ", "=", " ", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{
             RowBox[{"uv1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"uv1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"x", "[", 
            RowBox[{
             RowBox[{"uv0", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"uv0", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Theta]", "=", " ", 
          RowBox[{"-", 
           RowBox[{"Angle", "[", 
            RowBox[{"ni", ",", "nj", ",", 
             RowBox[{"Normalize", "[", "ei", "]"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalLambda]", " ", "=", 
          RowBox[{"\[CapitalLambda]", " ", "+", " ", 
           RowBox[{
            RowBox[{"\[Theta]", "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", "A"}], ")"}]}], 
            RowBox[{"(", 
             RowBox[{"ti", "\[CircleTimes]", "ti"}], ")"}], " ", "b"}]}]}], 
         "  ", ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[CapitalLambda]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApproxLambdaTri", "[", 
    RowBox[{"x_", ",", "n_", ",", 
     RowBox[{"num_:", "32"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "k", ",", "dx", ",", "P", ",", " ", "s", ",", "A", ",", "X0", 
       ",", "X1", ",", "XM", ",", "Ti", ",", "Ei", ",", "n0", ",", "ni", ",", 
       "ei", ",", "\[Theta]i", ",", "\[CapitalLambda]"}], " ", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dx", " ", "=", " ", "0.001"}], ";", "\[IndentingNewLine]", 
      RowBox[{"P", " ", "=", 
       RowBox[{"dx", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"Cos", "[", "0", "]"}], 
            RowBox[{"Sin", "[", "0", "]"}]},
           {
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["2", "3"], "Pi"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{
              FractionBox["2", "3"], "Pi"}], "]"}]},
           {
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["4", "3"], "Pi"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{
              FractionBox["4", "3"], "Pi"}], "]"}]}
          }], "\[NoBreak]", ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", 
         RowBox[{"P", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{
        FractionBox[
         RowBox[{"Sqrt", "[", "3", "]"}], "4"], 
        SuperscriptBox["s", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "0"}], ",", 
        RowBox[{"k", "<", "num"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", " ", "=", " ", 
          RowBox[{"P", ".", " ", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"2", " ", 
             RowBox[{"Pi", " ", "/", " ", "num"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "0"}], ",", 
           RowBox[{"i", "<", "3"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"X0", " ", "=", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"u", ",", "v"}], "}"}], "+"}], "*)"}], 
             RowBox[{"P", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", 
                RowBox[{"Mod", "[", 
                 RowBox[{"i", ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"X1", " ", "=", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"u", ",", "v"}], "}"}], "+"}], "*)"}], 
             RowBox[{"P", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "3"}], "]"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Ei", " ", "=", " ", 
             RowBox[{"X1", "-", "X0"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Ti", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Ei", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
               RowBox[{"-", 
                RowBox[{"Ei", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"XM", " ", "=", " ", 
             FractionBox[
              RowBox[{"X0", "+", "X1"}], "2"]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"n0", " ", "=", " ", 
               RowBox[{"n", "@@", 
                RowBox[{"(", 
                 RowBox[{"XM", " ", "-", " ", 
                  RowBox[{"Ti", "/", "2"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"ni", " ", "=", " ", 
               RowBox[{"n", "@@", 
                RowBox[{"(", 
                 RowBox[{"XM", " ", "+", " ", 
                  RowBox[{"Ti", "/", "2"}]}], ")"}]}]}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"n0", " ", "=", " ", 
             RowBox[{"n", "@@", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"ni", " ", "=", " ", 
             RowBox[{"n", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], " ", "+", " ", "Ti"}], 
               ")"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"ei", " ", "=", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "@@", "X1"}], ")"}], " ", "-", " ", 
              RowBox[{"(", 
               RowBox[{"x", " ", "@@", "X0"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"\[Theta]i", "=", " ", 
             RowBox[{"-", 
              RowBox[{"Angle", "[", 
               RowBox[{"n0", ",", "ni", ",", 
                RowBox[{"Normalize", "[", "ei", "]"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"\[CapitalLambda]", " ", "=", 
             RowBox[{"\[CapitalLambda]", " ", "+", " ", 
              RowBox[{
               RowBox[{"\[Theta]i", "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "A", " ", 
                  RowBox[{"Norm", "[", "Ti", "]"}]}], ")"}]}], 
               RowBox[{"(", 
                RowBox[{"Ti", "\[CircleTimes]", "Ti"}], ")"}]}]}]}]}]}], 
          "   ", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"dx", "/", " ", "s"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", "/", "num"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7773978395427303`*^9, 
  3.777397839806639*^9}},ExpressionUUID->"360a4b16-3b73-4628-b6b4-\
4d03a2bc951a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"sx", 
        RowBox[{"sa", " ", "sy"}]},
       {"0", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", " ", "-", " ", 
           SuperscriptBox["sa", "2"]}], "]"}], " ", "sy"}]},
       {"0", "0"}
      }], "\[NoBreak]", ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sx", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"sa", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"sy", "\[Rule]", " ", "1"}]}], "}"}]}]}], 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sx", "\[Rule]", " ", "0.8"}], ",", " ", 
     RowBox[{"sa", "\[Rule]", " ", "0.3"}], ",", " ", 
     RowBox[{"sy", "\[Rule]", " ", "1.5"}]}], "}"}], "*)"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "c"}], "}"}]}], "}"}], " ", "/.", 
    RowBox[{"(*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "0.0"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "0.2"}], ",", " ", 
       RowBox[{"c", "\[Rule]", " ", "0.0"}]}], "}"}], "*)"}], 
    RowBox[{"(*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "0.1"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", 
        RowBox[{"-", "0.05"}]}], ",", " ", 
       RowBox[{"c", "\[Rule]", " ", "0.12"}]}], "}"}], "*)"}], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", " ", "0.2"}], ",", " ", 
      RowBox[{"b", "\[Rule]", " ", "0.0"}], ",", " ", 
      RowBox[{"c", "\[Rule]", " ", "0.3"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi", " ", "=", " ", 
    RowBox[{
     RowBox[{"A", ".", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u", ",", "v"}], "}"}], ".", "Q", ".", 
        RowBox[{"{", 
         RowBox[{"u", ",", "v"}], "}"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ParametricPlot3D", "[", 
    RowBox[{"phi", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", 
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", 
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
     RowBox[{"Axes", "\[Rule]", "True"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Compute", ":", " ", "N"}], ",", " ", "S", ",", " ", "Lambda"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"II", " ", "=", " ", 
    RowBox[{"2", " ", "Q"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"n", " ", ".", " ", "xuv"}], " ", "at", " ", "u"}], "=", "0"}], 
    ",", 
    RowBox[{"v", "=", 
     RowBox[{
      RowBox[{"0", " ", "\[Rule]", " ", "n"}], " ", "=", " ", "001"}]}], ",", 
    " ", 
    RowBox[{"x_uv", " ", "=", " ", 
     RowBox[{"2", "Q"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"sx", 
        RowBox[{"sa", " ", "sy"}]},
       {"0", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", " ", "-", " ", 
           SuperscriptBox["sa", "2"]}], "]"}], " ", "sy"}]},
       {"0", "0"}
      }], "\[NoBreak]", ")"}], "/.", 
    RowBox[{"(*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sx", "\[Rule]", " ", "1"}], ",", " ", 
       RowBox[{"sa", "\[Rule]", " ", "0"}], ",", " ", 
       RowBox[{"sy", "\[Rule]", " ", "1"}]}], "}"}], "*)"}], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sx", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"sa", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"sy", "\[Rule]", " ", "1"}]}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "c"}], "}"}]}], "}"}], " ", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", " ", "0.2"}], ",", " ", 
      RowBox[{"b", "\[Rule]", " ", "0.0"}], ",", " ", 
      RowBox[{"c", "\[Rule]", " ", "0.3"}]}], "}"}]}]}], 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", " ", "0.1"}], ",", " ", 
     RowBox[{"b", "\[Rule]", " ", 
      RowBox[{"-", "0.05"}]}], ",", " ", 
     RowBox[{"c", "\[Rule]", " ", "0.12"}]}], "}"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", " ", "0.2"}], ",", " ", 
     RowBox[{"b", "\[Rule]", " ", "0.2"}], ",", " ", 
     RowBox[{"c", "\[Rule]", " ", "0.2"}]}], "}"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", " ", "=", " ", 
   RowBox[{
    RowBox[{"A", ".", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}], ".", "Q", ".", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParametricPlot3D", "[", 
   RowBox[{"phi", ",", 
    RowBox[{"{", 
     RowBox[{"u", ",", 
      RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"v", ",", 
      RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
    RowBox[{"Axes", "\[Rule]", "True"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", " ", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Compute", ":", " ", "N"}], ",", " ", "S", ",", " ", "Lambda"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"II", " ", "=", " ", 
    RowBox[{"2", " ", "Q"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"n", " ", ".", " ", "xuv"}], " ", "at", " ", "u"}], "=", "0"}], 
    ",", 
    RowBox[{"v", "=", 
     RowBox[{
      RowBox[{"0", " ", "\[Rule]", " ", "n"}], " ", "=", " ", "001"}]}], ",", 
    " ", 
    RowBox[{"x_uv", " ", "=", " ", 
     RowBox[{"2", "Q"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lam", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{"Grad", "[", 
      RowBox[{
       RowBox[{"phi", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{"phi", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", " ", "=", " ", 
    RowBox[{"Normalize", "[", 
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "\[Cross]", 
      RowBox[{"F", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", "2"}], "]"}], "]"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"n", " ", "//", " ", "MatrixForm"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NN", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{"n", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmpx", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], " ", "=", " ", "phi"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmpn", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], " ", "=", " ", "n"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L0", " ", "=", 
   RowBox[{
    RowBox[{"ApproxLambdaTri", "[", 
     RowBox[{"tmpx", ",", "tmpn"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"v", "\[Rule]", " ", "0"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N0", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"NN", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"v", "\[Rule]", " ", "0"}]}], "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "sx", ",", "sa", ",", "sy"}], 
       "}"}], "\[Element]", "Reals"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[CapitalLambda]tri: \>\"", ",", 
   RowBox[{"NumberForm", "[", 
    RowBox[{
     RowBox[{"L0", "//", " ", "MatrixForm"}], ",", "2"}], "]"}], ",", " ", 
   "\"\<   II: \>\"", ",", 
   RowBox[{"II", " ", "//", " ", "MatrixForm"}], ",", " ", 
   "\"\<   \[CapitalLambda]: \>\"", ",", 
   RowBox[{"NumberForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ApproxLambda", "[", 
        RowBox[{"tmpx", ",", "tmpn"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"u", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"v", "\[Rule]", " ", "0"}]}], "}"}]}], " ", "//", " ", 
      "MatrixForm"}], ",", "2"}], "]"}]}], " ", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<n,u n,v: \>\"", ",", 
   RowBox[{
    RowBox[{"NN", " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "\[Rule]", "0"}], ",", 
       RowBox[{"v", "\[Rule]", "0"}]}], "}"}]}], " ", "//", " ", 
    "MatrixForm"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"sx", 
        RowBox[{"sa", " ", "sy"}]},
       {"0", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", " ", "-", " ", 
           SuperscriptBox["sa", "2"]}], "]"}], " ", "sy"}]},
       {"0", "0"}
      }], "\[NoBreak]", ")"}], "/.", 
    RowBox[{"(*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sx", "\[Rule]", " ", "1"}], ",", " ", 
       RowBox[{"sa", "\[Rule]", " ", "0"}], ",", " ", 
       RowBox[{"sy", "\[Rule]", " ", "1"}]}], "}"}], "*)"}], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sx", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"sa", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"sy", "\[Rule]", " ", "1"}]}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "c"}], "}"}]}], "}"}], " ", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", " ", "0.2"}], ",", " ", 
      RowBox[{"b", "\[Rule]", " ", "0.0"}], ",", " ", 
      RowBox[{"c", "\[Rule]", " ", "0.0"}]}], "}"}]}]}], 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", " ", "0.1"}], ",", " ", 
     RowBox[{"b", "\[Rule]", " ", 
      RowBox[{"-", "0.05"}]}], ",", " ", 
     RowBox[{"c", "\[Rule]", " ", "0.12"}]}], "}"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", " ", "0.2"}], ",", " ", 
     RowBox[{"b", "\[Rule]", " ", "0.2"}], ",", " ", 
     RowBox[{"c", "\[Rule]", " ", "0.2"}]}], "}"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", " ", "=", " ", 
   RowBox[{
    RowBox[{"A", ".", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}], ".", "Q", ".", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParametricPlot3D", "[", 
   RowBox[{"phi", ",", 
    RowBox[{"{", 
     RowBox[{"u", ",", 
      RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"v", ",", 
      RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
    RowBox[{"Axes", "\[Rule]", "True"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", " ", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Compute", ":", " ", "N"}], ",", " ", "S", ",", " ", "Lambda"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"II", " ", "=", " ", 
    RowBox[{"2", " ", "Q"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"n", " ", ".", " ", "xuv"}], " ", "at", " ", "u"}], "=", "0"}], 
    ",", 
    RowBox[{"v", "=", 
     RowBox[{
      RowBox[{"0", " ", "\[Rule]", " ", "n"}], " ", "=", " ", "001"}]}], ",", 
    " ", 
    RowBox[{"x_uv", " ", "=", " ", 
     RowBox[{"2", "Q"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lam", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{"Grad", "[", 
      RowBox[{
       RowBox[{"phi", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{"phi", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", " ", "=", " ", 
    RowBox[{"Normalize", "[", 
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "\[Cross]", 
      RowBox[{"F", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", "2"}], "]"}], "]"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"n", " ", "//", " ", "MatrixForm"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NN", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{"n", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmpx", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], " ", "=", " ", "phi"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmpn", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], " ", "=", " ", "n"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L0", " ", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ApproxLambda", "[", 
       RowBox[{"tmpx", ",", "tmpn"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"v", "\[Rule]", " ", "0"}]}], "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "sx", ",", "sa", ",", "sy"}], 
       "}"}], "\[Element]", "Reals"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N0", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"NN", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"v", "\[Rule]", " ", "0"}]}], "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "sx", ",", "sa", ",", "sy"}], 
       "}"}], "\[Element]", "Reals"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[CapitalLambda]: \>\"", ",", 
   RowBox[{"L0", " ", "//", " ", "MatrixForm"}], ",", " ", "\"\<   II: \>\"", 
   ",", 
   RowBox[{"II", " ", "//", " ", "MatrixForm"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[CapitalLambda]cool: \>\"", ",", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ApproxLambdaCool", "[", 
        RowBox[{"tmpx", ",", "tmpn"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"u", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"v", "\[Rule]", " ", "0"}]}], "}"}]}], ",", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "sx", ",", "sa", ",", "sy"}], 
        "}"}], "\[Element]", "Reals"}]}], "]"}], " ", "//", " ", 
    "MatrixForm"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<n,u n,v: \>\"", ",", 
   RowBox[{
    RowBox[{"NN", " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "\[Rule]", "0"}], ",", 
       RowBox[{"v", "\[Rule]", "0"}]}], "}"}]}], " ", "//", " ", 
    "MatrixForm"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.777397817896162*^9, 3.777397818347026*^9}, {
  3.7773978554256573`*^9, 
  3.777397855590612*^9}},ExpressionUUID->"3d6bbf2f-da90-44de-b1f1-\
021dcca09c18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"TESTING", " ", "ON", " ", "MY", " ", "CYLINDER"}], ",", " ", 
    RowBox[{"GET", " ", "II", " ", "AND", " ", 
     RowBox[{"dN", " ", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"u_", ",", "v_"}], "]"}], "=", 
     RowBox[{"MakeCyl", "[", 
      RowBox[{"1.3", ",", 
       RowBox[{"-", "0.5"}], ",", "1", ",", "5", ",", 
       RowBox[{"Pi", "/", "8"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"u_", ",", "v_"}], "]"}], " ", "=", " ", 
     RowBox[{"Grad", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"u", ",", "v"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F0", " ", "=", " ", 
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{"u", ",", "v"}], "]"}], ",", 
         RowBox[{"u", "\[Rule]", " ", "0"}]}], "]"}], ",", 
       RowBox[{"v", "\[Rule]", "0"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"n", "[", 
      RowBox[{"u_", ",", "v_"}], "]"}], " ", "=", " ", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"F", "[", 
         RowBox[{"u", ",", "v"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "\[Cross]", 
       RowBox[{
        RowBox[{"F", "[", 
         RowBox[{"u", ",", "v"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "2"}], "]"}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"n0", " ", "=", " ", 
    RowBox[{"n", "[", 
     RowBox[{
      RowBox[{"1", "/", "1000"}], ",", 
      RowBox[{"1", "/", "1000"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"n0", " ", "=", " ", 
      RowBox[{"Limit", "[", 
       RowBox[{
        RowBox[{"Limit", "[", 
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"u", ",", "v"}], "]"}], ",", 
          RowBox[{"u", "\[Rule]", " ", "0"}]}], "]"}], ",", 
        RowBox[{"v", "\[Rule]", "0"}]}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"duv", " ", "=", " ", "0.0001"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dN0", " ", "=", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"Limit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"duv", ",", "v"}], "]"}], "-", 
            RowBox[{"n", "[", 
             RowBox[{
              RowBox[{"-", "duv"}], ",", "v"}], "]"}]}], ",", 
           RowBox[{"v", "\[Rule]", " ", "0"}]}], "]"}], 
         RowBox[{"2", "duv"}]], ",", 
        FractionBox[
         RowBox[{"Limit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"u", ",", "duv"}], "]"}], "-", 
            RowBox[{"n", "[", 
             RowBox[{"u", ",", 
              RowBox[{"-", "duv"}]}], "]"}]}], ",", 
           RowBox[{"u", "\[Rule]", " ", "0"}]}], "]"}], 
         RowBox[{"2", "duv"}]]}], "}"}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "could", " ", "also", " ", "speed", " ", "up", " ", "by", " ", "doing", 
      " ", "eps", " ", "instead", " ", "of", " ", "limit"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"dN0", " ", "=", " ", 
       RowBox[{"Limit", "[", 
        RowBox[{
         RowBox[{"Limit", "[", 
          RowBox[{
           RowBox[{"Grad", "[", 
            RowBox[{
             RowBox[{"n", "[", 
              RowBox[{"u", ",", "v"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"u", ",", "v"}], "}"}]}], "]"}], ",", 
           RowBox[{"u", "\[Rule]", " ", "0"}]}], "]"}], ",", 
         RowBox[{"v", "\[Rule]", "0"}]}], "]"}]}], ";", "  ", "SLOW"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"II0", " ", "=", " ", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Transpose", "[", "dN0", "]"}], ".", "F0"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L0", " ", "=", 
     RowBox[{
      RowBox[{"ApproxLambdaTri", "[", 
       RowBox[{"x", ",", "n"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "\[Rule]", " ", 
         RowBox[{"1", "/", "1000"}]}], ",", " ", 
        RowBox[{"v", "\[Rule]", " ", 
         RowBox[{"1", "/", "1000"}]}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L0quad", " ", "=", 
     RowBox[{
      RowBox[{"ApproxLambda", "[", 
       RowBox[{"x", ",", "n", ",", "1"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "\[Rule]", " ", 
         RowBox[{"1", "/", "1000"}]}], ",", " ", 
        RowBox[{"v", "\[Rule]", " ", 
         RowBox[{"1", "/", "1000"}]}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotL", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ParametricPlot3D", "[", 
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"u", ",", "v"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", 
       RowBox[{
        RowBox[{"-", "plotL"}], "/", "2"}], ",", 
       RowBox[{"plotL", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", 
       RowBox[{
        RowBox[{"-", "plotL"}], "/", "2"}], ",", 
       RowBox[{"plotL", "/", "2"}]}], "}"}], ",", 
     RowBox[{"Axes", "\[Rule]", "True"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "plotL"}], " ", 
         RowBox[{"2", "/", "3"}]}], ",", 
        RowBox[{"plotL", " ", 
         RowBox[{"2", "/", "3"}]}]}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<II: \>\"", ",", 
     RowBox[{"NumberForm", "[", 
      RowBox[{
       RowBox[{"II0", "//", " ", "MatrixForm"}], ",", "4"}], "]"}], ",", " ", 
     "\"\<    \[CapitalLambda]tri: \>\"", ",", 
     RowBox[{"NumberForm", "[", 
      RowBox[{
       RowBox[{"L0", "//", " ", "MatrixForm"}], ",", "2"}], "]"}], ",", " ", 
     "\"\<   \[CapitalLambda]quad: \>\"", ",", 
     RowBox[{"NumberForm", "[", 
      RowBox[{
       RowBox[{"L0quad", "//", " ", "MatrixForm"}], ",", "2"}], "]"}]}], " ", 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<n,u n,v: \>\"", ",", 
     RowBox[{
      RowBox[{"NumberForm", "[", 
       RowBox[{
        RowBox[{"dN0", "//", " ", "MatrixForm"}], ",", "2"}], "]"}], "//", 
      " ", "MatrixForm"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"II0", "*", "35"}], " ", "//", " ", "MatrixForm"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"Inverse", "[", 
         RowBox[{"F0", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "2"}], ",", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"II0", "*", "35"}], ")"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"F0", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "2"}], ",", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}]}], " ", "//", 
      "MatrixForm"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ES", " ", "=", " ", 
     RowBox[{"Eigensystem", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"Inverse", "[", 
         RowBox[{"F0", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "2"}], ",", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"II0", "*", "35"}], ")"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"F0", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "2"}], ",", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ES", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}], ",", " ", 
     RowBox[{
      RowBox[{"180", "/", "Pi"}], " ", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"ES", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "1", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"ES", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "1", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A0", " ", "=", " ", 
     RowBox[{"F0", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "2"}], ",", 
        RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", " ", 
    RowBox[{"A0i", " ", "=", " ", 
     RowBox[{"Inverse", "[", "A0", "]"}]}], ";", " ", 
    RowBox[{"A0T", " ", "=", 
     RowBox[{"Transpose", "[", "A0", "]"}]}], ";", " ", 
    RowBox[{"A0iT", " ", "=", 
     RowBox[{"Transpose", "[", "A0i", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TMP", " ", "=", " ", 
     RowBox[{"L0", ".", "S", ".", 
      RowBox[{"Transpose", "[", "S", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TMP", " ", "=", " ", 
     RowBox[{"S", ".", "L0", ".", 
      RowBox[{"Transpose", "[", "S", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TMP", " ", "=", " ", 
     RowBox[{"S", ".", "L0", ".", 
      RowBox[{"Transpose", "[", "S", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TMP", " ", "=", " ", 
     RowBox[{"A0i", ".", "A0iT", ".", "L0", ".", "A0iT", ".", "A0i"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], " ", "=", 
     RowBox[{"Eigenvalues", "[", "TMP", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rad", " ", "=", " ", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Eigenvectors", "[", "TMP", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Eigenvectors", "[", "TMP", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a2", ",", "b2"}], "}"}], " ", "=", 
     RowBox[{"Eigenvalues", "[", "II0", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"a2", ",", "b2"}], "}"}], "\n", 
   RowBox[{
    RowBox[{"rad2", " ", "=", " ", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Eigenvectors", "[", "II0", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Eigenvectors", "[", "II0", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"Rotate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", " ", 
              RowBox[{"a", ",", "b"}], "}"}]}], "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "a"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "b"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "b"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"-", "rad"}]}], "]"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"Rotate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", " ", 
              RowBox[{"a2", ",", "b2"}], "}"}]}], "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "a2"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a2", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "b2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "b2"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"-", "rad2"}]}], "]"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], 
    "]"}]}]}]], "Input",ExpressionUUID->"fc6807d3-d74d-4583-a8b6-\
36dd64b94523"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"P", " ", "=", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"Cos", "[", "0", "]"}], 
         RowBox[{"Sin", "[", "0", "]"}]},
        {
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["2", "3"], "Pi"}], "]"}], 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox["2", "3"], "Pi"}], "]"}]},
        {
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["4", "3"], "Pi"}], "]"}], 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox["4", "3"], "Pi"}], "]"}]},
        {
         RowBox[{"2", 
          RowBox[{"Cos", "[", 
           FractionBox["Pi", "3"], "]"}]}], 
         RowBox[{"2", 
          RowBox[{"Sin", "[", 
           FractionBox["Pi", "3"], "]"}]}]},
        {
         RowBox[{"2", 
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"3", "Pi"}], "3"], "]"}]}], 
         RowBox[{"2", 
          RowBox[{"Sin", "[", 
           FractionBox[
            RowBox[{"3", "Pi"}], "3"], "]"}]}]},
        {
         RowBox[{"2", 
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"5", "Pi"}], "3"], "]"}]}], 
         RowBox[{"2", 
          RowBox[{"Sin", "[", 
           FractionBox[
            RowBox[{"5", "Pi"}], "3"], "]"}]}]},
        {"0", "0"},
        {"1", "0"},
        {"0", "1"}
       }], "\[NoBreak]", ")"}], ".", " ", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"Pi", "/", "8"}], "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Point", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
    RowBox[{"EdgeForm", "[", "Black", "]"}], ",", "Transparent", ",", 
    RowBox[{"Triangle", "[", 
     RowBox[{"P", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"EdgeForm", "[", "Dashed", "]"}], ",", 
    RowBox[{"Triangle", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"P", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{"P", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"Triangle", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"P", "[", 
        RowBox[{"[", "5", "]"}], "]"}], ",", 
       RowBox[{"P", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"Triangle", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"P", "[", 
        RowBox[{"[", "6", "]"}], "]"}], ",", 
       RowBox[{"P", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"Opacity", "[", "1", "]"}], ",", "Dashed", ",", "Red", ",", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"[", "7", "]"}], "]"}], ",", 
       RowBox[{"P", "[", 
        RowBox[{"[", "8", "]"}], "]"}]}], "}"}], "]"}], ",", "Green", ",", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"[", "7", "]"}], "]"}], ",", 
       RowBox[{"P", "[", 
        RowBox[{"[", "9", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.777606782723318*^9, 
  3.777607068604773*^9}},ExpressionUUID->"7a469471-319d-4217-8e80-\
a966be26d1dc"],

Cell[BoxData[
 GraphicsBox[{PointBox[{0, 0}], 
   {GrayLevel[0], Opacity[0], EdgeForm[GrayLevel[0]], 
    TagBox[
     PolygonBox[
      NCache[{{Cos[Rational[1, 8] Pi], -Sin[Rational[1, 8] Pi]}, {
        Rational[-1, 2] Cos[Rational[1, 8] Pi] + 
         Rational[1, 2] 3^Rational[1, 2] Sin[Rational[1, 8] Pi], 
         Rational[1, 2] 3^Rational[1, 2] Cos[Rational[1, 8] Pi] + 
         Rational[1, 2] Sin[Rational[1, 8] Pi]}, {
        Rational[-1, 2] Cos[Rational[1, 8] Pi] + 
         Rational[-1, 2] 3^Rational[1, 2] Sin[Rational[1, 8] Pi], 
         Rational[-1, 2] 3^Rational[1, 2] Cos[Rational[1, 8] Pi] + 
         Rational[1, 2] Sin[Rational[1, 8] Pi]}}, {{
       0.9238795325112867, -0.3826834323650898}, {-0.13052619222005157`, 
       0.9914448613738104}, {-0.7933533402912352, -0.6087614290087205}}]],
     "Triangle"], 
    {EdgeForm[Dashing[{Small, Small}]], 
     TagBox[
      PolygonBox[
       NCache[{{Cos[Rational[1, 8] Pi], -Sin[Rational[1, 8] Pi]}, {
         Cos[Rational[1, 8] Pi] + 3^Rational[1, 2] Sin[Rational[1, 8] Pi], 
          3^Rational[1, 2] Cos[Rational[1, 8] Pi] - Sin[Rational[1, 8] Pi]}, {
         Rational[-1, 2] Cos[Rational[1, 8] Pi] + 
          Rational[1, 2] 3^Rational[1, 2] Sin[Rational[1, 8] Pi], 
          Rational[1, 2] 3^Rational[1, 2] Cos[Rational[1, 8] Pi] + 
          Rational[1, 2] Sin[Rational[1, 8] Pi]}}, {{
        0.9238795325112867, -0.3826834323650898}, {1.5867066805824703`, 
        1.217522858017441}, {-0.13052619222005157`, 0.9914448613738104}}]],
      "Triangle"], 
     TagBox[
      PolygonBox[
       NCache[{{
         Rational[-1, 2] Cos[Rational[1, 8] Pi] + 
          Rational[1, 2] 3^Rational[1, 2] Sin[Rational[1, 8] Pi], 
          Rational[1, 2] 3^Rational[1, 2] Cos[Rational[1, 8] Pi] + 
          Rational[1, 2] Sin[Rational[1, 8] Pi]}, {(-2) 
          Cos[Rational[1, 8] Pi], 2 Sin[Rational[1, 8] Pi]}, {
         Rational[-1, 2] Cos[Rational[1, 8] Pi] + 
          Rational[-1, 2] 3^Rational[1, 2] Sin[Rational[1, 8] Pi], 
          Rational[-1, 2] 3^Rational[1, 2] Cos[Rational[1, 8] Pi] + 
          Rational[1, 2] Sin[Rational[1, 8] Pi]}}, {{-0.13052619222005157`, 
        0.9914448613738104}, {-1.8477590650225735`, 
        0.7653668647301796}, {-0.7933533402912352, -0.6087614290087205}}]],
      "Triangle"], 
     TagBox[
      PolygonBox[
       NCache[{{
         Rational[-1, 2] Cos[Rational[1, 8] Pi] + 
          Rational[-1, 2] 3^Rational[1, 2] Sin[Rational[1, 8] Pi], 
          Rational[-1, 2] 3^Rational[1, 2] Cos[Rational[1, 8] Pi] + 
          Rational[1, 2] Sin[Rational[1, 8] Pi]}, {
         Cos[Rational[1, 8] Pi] - 3^Rational[1, 2] 
          Sin[Rational[1, 8] Pi], -3^Rational[1, 2] Cos[Rational[1, 8] Pi] - 
          Sin[Rational[1, 8] Pi]}, {
         Cos[Rational[1, 8] Pi], -
          Sin[Rational[1, 8] 
            Pi]}}, {{-0.7933533402912352, -0.6087614290087205}, {
        0.26105238444010315`, -1.9828897227476208`}, {
        0.9238795325112867, -0.3826834323650898}}]],
      "Triangle"], 
     {RGBColor[1, 0, 0], Opacity[1], Dashing[{Small, Small}], 
      LineBox[NCache[{{0, 0}, {
         Cos[Rational[1, 8] Pi], -Sin[Rational[1, 8] Pi]}}, {{0, 0}, {
         0.9238795325112867, -0.3826834323650898}}]], 
      {RGBColor[0, 1, 0], 
       LineBox[NCache[{{0, 0}, {
          Sin[Rational[1, 8] Pi], Cos[Rational[1, 8] Pi]}}, {{0, 0}, {
          0.3826834323650898, 0.9238795325112867}}]]}}}}}]], "Output",
 CellChangeTimes->{
  3.777606764708186*^9, {3.7776068027535143`*^9, 3.777606926692349*^9}, 
   3.7776069949320393`*^9, {3.777607026003639*^9, 
   3.777607068951939*^9}},ExpressionUUID->"9afc0a6d-576c-4da7-83a1-\
9cf5fada6edb"]
}, Open  ]]
},
WindowSize->{1536, 791},
WindowMargins->{{0, Automatic}, {Automatic, 30}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 331, 5, 32, "Input", "ExpressionUUID" -> \
"bff7917f-2396-4bc2-8ea3-049129c17f4b"],
Cell[892, 27, 26731, 660, 2088, "Input", "ExpressionUUID" -> \
"26d244b1-cb62-4bbd-9ec8-450d951a784c"],
Cell[CellGroupData[{
Cell[27648, 691, 17054, 441, 1004, "Input", "ExpressionUUID" -> \
"7089f250-f82c-45b8-a89b-bc6004c3c480"],
Cell[CellGroupData[{
Cell[44727, 1136, 4593, 113, 59, "Print", "ExpressionUUID" -> \
"c073e0d7-107d-4423-a1e5-159b49d2567c"],
Cell[49323, 1251, 4713, 118, 59, "Print", "ExpressionUUID" -> \
"bfb780cb-ab6c-47f9-ae07-880701d0f8c2"],
Cell[54039, 1371, 2767, 62, 41, "Print", "ExpressionUUID" -> \
"118d2892-6937-4926-ba08-47f2286b7a39"],
Cell[56809, 1435, 4136, 101, 41, "Print", "ExpressionUUID" -> \
"5ae09aef-4b84-4b26-bf3e-30c6c8eb13aa"],
Cell[60948, 1538, 2759, 62, 41, "Print", "ExpressionUUID" -> \
"bf960f7b-6d77-416e-b83c-872c67492a7b"]
}, Open  ]],
Cell[63722, 1603, 2037, 39, 62, "Output", "ExpressionUUID" -> \
"1f6c1b95-cb44-4926-914c-9d2599394eef"],
Cell[65762, 1644, 2092, 40, 80, "Output", "ExpressionUUID" -> \
"087d3f30-775a-45ac-819c-5ac4f90973e8"],
Cell[67857, 1686, 2038, 39, 62, "Output", "ExpressionUUID" -> \
"8ec5b09a-57af-40da-9614-83a5efa8020d"],
Cell[69898, 1727, 2038, 39, 62, "Output", "ExpressionUUID" -> \
"9a2817ab-29c4-4a97-82c2-df9e4095bce2"],
Cell[71939, 1768, 2038, 39, 62, "Output", "ExpressionUUID" -> \
"99a92d58-b470-4881-bd99-17cb04e884fe"],
Cell[73980, 1809, 2232, 44, 80, "Output", "ExpressionUUID" -> \
"eec494bc-f799-46d8-a60d-5fbbff9a5070"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76249, 1858, 566, 15, 99, "Input", "ExpressionUUID" -> \
"22b10274-332d-4853-868c-c621db876994"],
Cell[76818, 1875, 823, 22, 62, "Output", "ExpressionUUID" -> \
"47eb07d5-f97a-4f47-b013-7272489bdfb5"],
Cell[77644, 1899, 824, 22, 62, "Output", "ExpressionUUID" -> \
"6394b429-d085-4054-8c08-f6008735c181"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78505, 1926, 2491, 70, 170, "Input", "ExpressionUUID" -> \
"ecceba40-909e-48ab-b0d7-cce0c42d3ea6"],
Cell[80999, 1998, 1228, 28, 62, "Output", "ExpressionUUID" -> \
"945bf14e-1538-4f2e-ba0c-4212670065e1"],
Cell[82230, 2028, 1226, 28, 62, "Output", "ExpressionUUID" -> \
"63fd0e89-d0bf-47f4-a3bb-47206294f8cb"],
Cell[83459, 2058, 1423, 33, 80, "Output", "ExpressionUUID" -> \
"0c7c7909-032c-4d28-b7a2-95ed44afc195"],
Cell[84885, 2093, 1227, 28, 62, "Output", "ExpressionUUID" -> \
"a93fdc12-4749-4ef8-bd87-2a895e1d516e"]
}, Open  ]],
Cell[86127, 2124, 786, 28, 32, "Input", "ExpressionUUID" -> \
"288bc807-25c3-45a6-92e4-4b4c964d2239"],
Cell[86916, 2154, 31569, 856, 2567, "Input", "ExpressionUUID" -> \
"749c92e4-67bd-42f9-af62-101448c38365"],
Cell[118488, 3012, 27708, 723, 2469, "Input", "ExpressionUUID" -> \
"360a4b16-3b73-4628-b6b4-4d03a2bc951a"],
Cell[146199, 3737, 18093, 559, 1114, "Input", "ExpressionUUID" -> \
"3d6bbf2f-da90-44de-b1f1-021dcca09c18"],
Cell[164295, 4298, 14133, 407, 818, "Input", "ExpressionUUID" -> \
"fc6807d3-d74d-4583-a8b6-36dd64b94523"],
Cell[CellGroupData[{
Cell[178453, 4709, 3560, 112, 310, "Input", "ExpressionUUID" -> \
"7a469471-319d-4217-8e80-a966be26d1dc"],
Cell[182016, 4823, 3674, 73, 351, "Output", "ExpressionUUID" -> \
"9afc0a6d-576c-4da7-83a1-9cf5fada6edb"]
}, Open  ]]
}
]
*)

