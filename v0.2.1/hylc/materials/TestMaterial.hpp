#ifndef _TESTMATERIAL_HPP_
#define _TESTMATERIAL_HPP_

#include "BaseMaterial.hpp"
#include <vector>

namespace hylc {
class TestMaterial : public BaseMaterial {
public:
  TestMaterial() {
    s = 1;         // 1e-2;
    double sk = 1; // 1e2; // debug, if bigger less curvy stuff
    // m_C = {24.880611357547,      30.9876859608939,   39.7198514665143,
    //        66.0881961218422,     -7.86982975935647,  0.0601702641758691,
    //        2.15049756442683,     -0.107739735775619, 2.18841192157357,
    //        0.789682883004569,    2.56995996381918,   0.311080303346407,
    //        38.7333643362365,     64.3308391120656,   -8.65483439454951,
    //        0.819894741423599,    24.8003831367493,   41.7141638558948,
    //        -15.0088957192384,    -41.2494582266692,  21.1812920608958,
    //        -19.9183334537448,    0.0216486869178135, -12.6495157375629,
    //        -0.00304599699300749, 3.57574897373618,   3.82153811589053,
    //        -7.95854800267124,    0.0444923410988428, 5.12138768953863,
    //        4.06996487713863};
    // m_ekmean = {1.305,
    //             -5.55111512312578e-18,
    //             1.305,
    //             2.8421709430404e-16,
    //             7.105427357601e-17,
    //             2.8421709430404e-16};
    // m_ekstd = {0.55107951910275, 0.412289121692097, 0.55107951910275,
    //            sk*69.9783516331833, sk*34.9891758155864,
    //            sk*69.9783516331833};

    // NOTE energy from this is off by factor of 0.85*0.85 ish
    // because i forgot to scale the ref area with proto
    m_C = {-4.700194616233,      -5.37199649556925,    6.07544107819065,
           3.34509809168707,     -0.551509389317062,   0.46928393375905,
           -4.70455827320207,    0.0353578411971718,   0.103343055539766,
           0.00120629726395653,  0.195057520109849,    1.78920787179131,
           3.91330245186814,     3.05128841702532,     -0.560075395101677,
           0.552456271015256,    3.33144826838135,     0.0163911521599623,
           0.235517324940807,    -0.00118848480256068, 0.0017881990202135,
           0.105397494644102,    0.0125797205563788,   0.170892451855713,
           -0.00100864927402942, 0.084245846297178,    -1.12063033182466,
           0.0347196676295963,   0.22307826917786,     -0.00474923578610595,
           0.000677340430722436};
    m_ekmean = {1.250000002847,       -4.05699995820186e-11,
                1.250000002027,       1.70530256582424e-15,
                -5.6843418860808e-16, -4.54747350886464e-15};
    m_ekstd = {0.43736469869565,      0.408207051975081,
               0.437364698392629,     sk * 291.111346991829,
               sk * 162.453284671786, sk * 290.987334018003};

    density = 0.893948789;
  }
  virtual double psi(const Vec6 &ek);
  virtual std::pair<Mat6x6, Vec6> psi_drv(const Vec6 &ek);

private:
  double s;
  std::vector<double> m_C;
  std::vector<double> m_ekmean;
  std::vector<double> m_ekstd;
};

} // namespace hylc
#endif /* end of include guard: _TESTMATERIAL_HPP_ */
