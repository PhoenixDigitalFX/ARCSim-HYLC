#include "strain.hpp"
#ifdef hylc_strain_II

using namespace hylc;
using namespace hylc::mathematica;

Vec6 hylc::mathematica::strain(const Vec18 &xloc, const Mat2x2 &invDm,
                               const Real &A, const Real &thetarest0,
                               const Real &thetarest1, const Real &thetarest2,
                               const Real &l0, const Real &l1, const Real &l2,
                               const Vec2 &t0, const Vec2 &t1, const Vec2 &t2) {
  // define output
  Vec6 out;

  Real copt1   = invDm(0, 0);
  Real copt2   = xloc(0);
  Real copt3   = -copt2;
  Real copt4   = xloc(3);
  Real copt5   = copt3 + copt4;
  Real copt6   = copt1 * copt5;
  Real copt7   = invDm(1, 0);
  Real copt8   = xloc(6);
  Real copt9   = copt3 + copt8;
  Real copt10  = copt7 * copt9;
  Real copt11  = copt10 + copt6;
  Real copt12  = Power(copt11, 2);
  Real copt13  = xloc(1);
  Real copt14  = -copt13;
  Real copt15  = xloc(4);
  Real copt16  = copt14 + copt15;
  Real copt17  = copt1 * copt16;
  Real copt18  = xloc(7);
  Real copt19  = copt14 + copt18;
  Real copt20  = copt19 * copt7;
  Real copt21  = copt17 + copt20;
  Real copt22  = Power(copt21, 2);
  Real copt23  = xloc(2);
  Real copt24  = -copt23;
  Real copt25  = xloc(5);
  Real copt26  = copt24 + copt25;
  Real copt27  = copt1 * copt26;
  Real copt28  = xloc(8);
  Real copt29  = copt24 + copt28;
  Real copt30  = copt29 * copt7;
  Real copt31  = copt27 + copt30;
  Real copt32  = Power(copt31, 2);
  Real copt33  = copt12 + copt22 + copt32;
  Real copt34  = Sqrt(copt33);
  Real copt35  = 1 / copt34;
  Real copt36  = invDm(0, 1);
  Real copt38  = invDm(1, 1);
  Real copt37  = copt36 * copt5;
  Real copt39  = copt38 * copt9;
  Real copt40  = copt37 + copt39;
  Real copt51  = Power(copt40, 2);
  Real copt42  = copt16 * copt36;
  Real copt43  = copt19 * copt38;
  Real copt44  = copt42 + copt43;
  Real copt52  = Power(copt44, 2);
  Real copt46  = copt26 * copt36;
  Real copt47  = copt29 * copt38;
  Real copt48  = copt46 + copt47;
  Real copt53  = Power(copt48, 2);
  Real copt54  = copt51 + copt52 + copt53;
  Real copt55  = Sqrt(copt54);
  Real copt56  = 1 / copt55;
  Real copt58  = 1 / A;
  Real copt59  = 1 / l0;
  Real copt60  = 1 / l1;
  Real copt61  = 1 / l2;
  Real copt71  = xloc(9);
  Real copt76  = xloc(10);
  Real copt63  = -copt4;
  Real copt95  = xloc(11);
  Real copt78  = -copt15;
  Real copt88  = -copt25;
  Real copt120 = copt2 + copt63;
  Real copt121 = Power(copt120, 2);
  Real copt122 = copt13 + copt78;
  Real copt123 = Power(copt122, 2);
  Real copt124 = copt23 + copt88;
  Real copt125 = Power(copt124, 2);
  Real copt126 = copt121 + copt123 + copt125;
  Real copt127 = Sqrt(copt126);
  Real copt83  = -copt8;
  Real copt110 = -copt76;
  Real copt72  = -copt71;
  Real copt105 = -copt28;
  Real copt84  = copt4 + copt83;
  Real copt103 = copt18 + copt78;
  Real copt168 = xloc(12);
  Real copt172 = xloc(13);
  Real copt85  = copt23 * copt84;
  Real copt86  = copt25 * copt8;
  Real copt87  = -(copt28 * copt4);
  Real copt89  = copt28 + copt88;
  Real copt90  = copt2 * copt89;
  Real copt91  = copt85 + copt86 + copt87 + copt90;
  Real copt170 = copt168 + copt83;
  Real copt181 = xloc(14);
  Real copt66  = -copt18;
  Real copt67  = copt15 + copt66;
  Real copt182 = -copt181;
  Real copt183 = copt182 + copt28;
  Real copt201 = Power(copt84, 2);
  Real copt202 = Power(copt67, 2);
  Real copt106 = copt105 + copt25;
  Real copt203 = Power(copt106, 2);
  Real copt204 = copt201 + copt202 + copt203;
  Real copt205 = Sqrt(copt204);
  Real copt128 = -(copt18 * copt2 * copt25);
  Real copt129 = copt15 * copt2 * copt28;
  Real copt169 = -(copt168 * copt18);
  Real copt171 = copt15 * copt170;
  Real copt173 = -copt172;
  Real copt174 = copt173 + copt18;
  Real copt175 = copt174 * copt4;
  Real copt176 = copt172 * copt8;
  Real copt177 = copt169 + copt171 + copt175 + copt176;
  Real copt163 = copt13 * copt84;
  Real copt164 = copt15 * copt8;
  Real copt165 = -(copt18 * copt4);
  Real copt166 = copt103 * copt2;
  Real copt167 = copt163 + copt164 + copt165 + copt166;
  Real copt233 = xloc(15);
  Real copt238 = xloc(16);
  Real copt234 = -copt233;
  Real copt235 = copt234 + copt8;
  Real copt246 = xloc(17);
  Real copt188 = copt23 * copt67;
  Real copt189 = copt18 * copt25;
  Real copt190 = -(copt15 * copt28);
  Real copt191 = copt13 * copt89;
  Real copt192 = copt188 + copt189 + copt190 + copt191;
  Real copt248 = copt105 + copt246;
  Real copt261 = copt2 + copt83;
  Real copt262 = Power(copt261, 2);
  Real copt263 = copt13 + copt66;
  Real copt264 = Power(copt263, 2);
  Real copt265 = copt105 + copt23;
  Real copt266 = Power(copt265, 2);
  Real copt267 = copt262 + copt264 + copt266;
  Real copt268 = Sqrt(copt267);
  Real copt237 = copt18 * copt233;
  Real copt239 = -(copt238 * copt8);
  Real copt240 = copt238 + copt66;
  Real copt41  = copt11 * copt40;
  Real copt45  = copt21 * copt44;
  Real copt49  = copt31 * copt48;
  Real copt50  = copt41 + copt45 + copt49;
  Real copt62  = -(copt15 * copt8);
  Real copt64  = copt63 + copt8;
  Real copt65  = copt13 * copt64;
  Real copt68  = copt2 * copt67;
  Real copt69  = copt18 * copt4;
  Real copt70  = copt62 + copt65 + copt68 + copt69;
  Real copt73  = copt4 + copt72;
  Real copt74  = copt13 * copt73;
  Real copt75  = copt15 * copt71;
  Real copt77  = -(copt4 * copt76);
  Real copt79  = copt76 + copt78;
  Real copt80  = copt2 * copt79;
  Real copt81  = copt74 + copt75 + copt77 + copt80;
  Real copt82  = copt70 * copt81;
  Real copt92  = -(copt25 * copt71);
  Real copt93  = copt63 + copt71;
  Real copt94  = copt23 * copt93;
  Real copt96  = -copt95;
  Real copt97  = copt25 + copt96;
  Real copt98  = copt2 * copt97;
  Real copt99  = copt4 * copt95;
  Real copt100 = copt92 + copt94 + copt98 + copt99;
  Real copt101 = copt100 * copt91;
  Real copt102 = -(copt18 * copt25);
  Real copt104 = copt103 * copt23;
  Real copt107 = copt106 * copt13;
  Real copt108 = copt15 * copt28;
  Real copt109 = copt102 + copt104 + copt107 + copt108;
  Real copt111 = copt110 + copt15;
  Real copt112 = copt111 * copt23;
  Real copt113 = copt25 * copt76;
  Real copt114 = -(copt15 * copt95);
  Real copt115 = copt88 + copt95;
  Real copt116 = copt115 * copt13;
  Real copt117 = copt112 + copt113 + copt114 + copt116;
  Real copt118 = copt109 * copt117;
  Real copt119 = copt101 + copt118 + copt82;
  Real copt130 = copt18 * copt25 * copt71;
  Real copt131 = -(copt15 * copt28 * copt71);
  Real copt132 = copt2 * copt25 * copt76;
  Real copt133 = -(copt25 * copt76 * copt8);
  Real copt134 = -(copt2 * copt28 * copt76);
  Real copt135 = copt28 * copt4 * copt76;
  Real copt136 = -(copt18 * copt71);
  Real copt137 = copt71 + copt83;
  Real copt138 = copt137 * copt15;
  Real copt139 = copt110 + copt18;
  Real copt140 = copt139 * copt4;
  Real copt141 = copt76 * copt8;
  Real copt142 = copt136 + copt138 + copt140 + copt141;
  Real copt143 = copt142 * copt23;
  Real copt144 = -(copt15 * copt2 * copt95);
  Real copt145 = copt15 * copt8 * copt95;
  Real copt146 = copt18 * copt2 * copt95;
  Real copt147 = -(copt18 * copt4 * copt95);
  Real copt148 = copt72 + copt8;
  Real copt149 = copt148 * copt25;
  Real copt150 = copt28 * copt71;
  Real copt151 = -(copt8 * copt95);
  Real copt152 = copt105 + copt95;
  Real copt153 = copt152 * copt4;
  Real copt154 = copt149 + copt150 + copt151 + copt153;
  Real copt155 = copt13 * copt154;
  Real copt156 = copt128 + copt129 + copt130 + copt131 + copt132 + copt133 +
                 copt134 + copt135 + copt143 + copt144 + copt145 + copt146 +
                 copt147 + copt155;
  Real copt157 = copt127 * copt156;
  Real copt158 = ArcTan(copt119, copt157);
  Real copt159 = copt158 + thetarest0;
  Real copt160 = t0(0);
  Real copt303 = Power(copt160, 2);
  Real copt178 = copt167 * copt177;
  Real copt179 = -(copt168 * copt28);
  Real copt180 = copt170 * copt25;
  Real copt184 = copt183 * copt4;
  Real copt185 = copt181 * copt8;
  Real copt186 = copt179 + copt180 + copt184 + copt185;
  Real copt187 = copt186 * copt91;
  Real copt193 = -(copt172 * copt28);
  Real copt194 = copt172 + copt66;
  Real copt195 = copt194 * copt25;
  Real copt196 = copt15 * copt183;
  Real copt197 = copt18 * copt181;
  Real copt198 = copt193 + copt195 + copt196 + copt197;
  Real copt199 = copt192 * copt198;
  Real copt200 = copt178 + copt187 + copt199;
  Real copt206 = copt168 * copt18 * copt25;
  Real copt207 = -(copt15 * copt168 * copt28);
  Real copt208 = copt172 * copt2 * copt25;
  Real copt209 = -(copt172 * copt25 * copt8);
  Real copt210 = -(copt172 * copt2 * copt28);
  Real copt211 = copt172 * copt28 * copt4;
  Real copt212 = copt177 * copt23;
  Real copt213 = -(copt15 * copt181 * copt2);
  Real copt214 = copt15 * copt181 * copt8;
  Real copt215 = copt18 * copt181 * copt2;
  Real copt216 = -(copt18 * copt181 * copt4);
  Real copt217 = -copt168;
  Real copt218 = copt217 + copt8;
  Real copt219 = copt218 * copt25;
  Real copt220 = copt168 * copt28;
  Real copt221 = -(copt181 * copt8);
  Real copt222 = copt105 + copt181;
  Real copt223 = copt222 * copt4;
  Real copt224 = copt219 + copt220 + copt221 + copt223;
  Real copt225 = copt13 * copt224;
  Real copt226 = copt128 + copt129 + copt206 + copt207 + copt208 + copt209 +
                 copt210 + copt211 + copt212 + copt213 + copt214 + copt215 +
                 copt216 + copt225;
  Real copt227 = copt205 * copt226;
  Real copt228 = ArcTan(copt200, copt227);
  Real copt229 = copt228 + thetarest1;
  Real copt230 = t1(0);
  Real copt305 = Power(copt230, 2);
  Real copt236 = copt13 * copt235;
  Real copt241 = copt2 * copt240;
  Real copt242 = copt236 + copt237 + copt239 + copt241;
  Real copt243 = copt167 * copt242;
  Real copt244 = copt23 * copt235;
  Real copt245 = copt233 * copt28;
  Real copt247 = -(copt246 * copt8);
  Real copt249 = copt2 * copt248;
  Real copt250 = copt244 + copt245 + copt247 + copt249;
  Real copt251 = copt250 * copt91;
  Real copt252 = -copt238;
  Real copt253 = copt18 + copt252;
  Real copt254 = copt23 * copt253;
  Real copt255 = copt238 * copt28;
  Real copt256 = -(copt18 * copt246);
  Real copt257 = copt13 * copt248;
  Real copt258 = copt254 + copt255 + copt256 + copt257;
  Real copt259 = copt192 * copt258;
  Real copt260 = copt243 + copt251 + copt259;
  Real copt269 = copt18 * copt2 * copt25;
  Real copt270 = -(copt15 * copt2 * copt28);
  Real copt271 = -(copt18 * copt233 * copt25);
  Real copt272 = copt15 * copt233 * copt28;
  Real copt273 = -(copt2 * copt238 * copt25);
  Real copt274 = copt238 * copt25 * copt8;
  Real copt275 = copt2 * copt238 * copt28;
  Real copt276 = -(copt238 * copt28 * copt4);
  Real copt277 = copt15 * copt235;
  Real copt278 = copt240 * copt4;
  Real copt279 = copt237 + copt239 + copt277 + copt278;
  Real copt280 = copt23 * copt279;
  Real copt281 = copt15 * copt2 * copt246;
  Real copt282 = -(copt15 * copt246 * copt8);
  Real copt283 = -(copt18 * copt2 * copt246);
  Real copt284 = copt18 * copt246 * copt4;
  Real copt285 = -(copt233 * copt28);
  Real copt286 = copt233 + copt83;
  Real copt287 = copt25 * copt286;
  Real copt288 = -copt246;
  Real copt289 = copt28 + copt288;
  Real copt290 = copt289 * copt4;
  Real copt291 = copt246 * copt8;
  Real copt292 = copt285 + copt287 + copt290 + copt291;
  Real copt293 = copt13 * copt292;
  Real copt294 = copt269 + copt270 + copt271 + copt272 + copt273 + copt274 +
                 copt275 + copt276 + copt280 + copt281 + copt282 + copt283 +
                 copt284 + copt293;
  Real copt295 = -(copt268 * copt294);
  Real copt296 = ArcTan(copt260, copt295);
  Real copt297 = copt296 + thetarest2;
  Real copt298 = t2(0);
  Real copt307 = Power(copt298, 2);
  Real copt312 = Power(copt50, 2);
  Real copt313 = -copt312;
  Real copt314 = copt33 * copt54;
  Real copt315 = copt313 + copt314;
  Real copt316 = 1 / copt315;
  Real copt318 = copt36 * copt7;
  Real copt319 = -(copt1 * copt38);
  Real copt320 = copt318 + copt319;
  Real copt321 = Power(copt320, 2);
  Real copt322 = 1 / copt321;
  Real copt323 = Power(copt2, 2);
  Real copt324 = Power(copt15, 2);
  Real copt325 = copt323 * copt324;
  Real copt326 = Power(copt25, 2);
  Real copt327 = copt323 * copt326;
  Real copt328 = -2 * copt2 * copt324 * copt8;
  Real copt329 = -2 * copt2 * copt326 * copt8;
  Real copt330 = Power(copt8, 2);
  Real copt331 = copt324 * copt330;
  Real copt332 = copt326 * copt330;
  Real copt333 = -2 * copt15 * copt18 * copt323;
  Real copt334 = 2 * copt15 * copt18 * copt2 * copt4;
  Real copt335 = 2 * copt15 * copt18 * copt2 * copt8;
  Real copt336 = -2 * copt15 * copt18 * copt4 * copt8;
  Real copt337 = Power(copt18, 2);
  Real copt338 = copt323 * copt337;
  Real copt339 = -2 * copt2 * copt337 * copt4;
  Real copt340 = Power(copt4, 2);
  Real copt341 = copt337 * copt340;
  Real copt342 = copt326 * copt337;
  Real copt343 = Power(copt23, 2);
  Real copt344 = -2 * copt4 * copt8;
  Real copt345 = -2 * copt15 * copt18;
  Real copt346 = copt324 + copt330 + copt337 + copt340 + copt344 + copt345;
  Real copt347 = copt343 * copt346;
  Real copt348 = -2 * copt25 * copt28 * copt323;
  Real copt349 = 2 * copt2 * copt25 * copt28 * copt4;
  Real copt350 = 2 * copt2 * copt25 * copt28 * copt8;
  Real copt351 = -2 * copt25 * copt28 * copt4 * copt8;
  Real copt352 = -2 * copt15 * copt18 * copt25 * copt28;
  Real copt353 = Power(copt28, 2);
  Real copt354 = copt323 * copt353;
  Real copt355 = -2 * copt2 * copt353 * copt4;
  Real copt356 = copt340 * copt353;
  Real copt357 = copt324 * copt353;
  Real copt358 = Power(copt13, 2);
  Real copt359 = -2 * copt25 * copt28;
  Real copt360 = copt326 + copt330 + copt340 + copt344 + copt353 + copt359;
  Real copt361 = copt358 * copt360;
  Real copt362 = -(copt15 * copt4 * copt8);
  Real copt363 = copt15 * copt330;
  Real copt364 = copt2 * copt67 * copt84;
  Real copt365 = copt18 * copt340;
  Real copt366 = copt18 * copt326;
  Real copt367 = -(copt18 * copt4 * copt8);
  Real copt368 = copt106 * copt23 * copt67;
  Real copt369 = -(copt15 * copt25 * copt28);
  Real copt370 = -(copt18 * copt25 * copt28);
  Real copt371 = copt15 * copt353;
  Real copt372 = copt362 + copt363 + copt364 + copt365 + copt366 + copt367 +
                 copt368 + copt369 + copt370 + copt371;
  Real copt373 = -2 * copt13 * copt372;
  Real copt374 = copt25 * copt330;
  Real copt375 = -(copt15 * copt18 * copt25);
  Real copt376 = copt25 * copt337;
  Real copt377 = copt106 * copt2 * copt84;
  Real copt378 = copt28 * copt340;
  Real copt379 = copt28 * copt324;
  Real copt380 = -(copt15 * copt18 * copt28);
  Real copt381 = copt25 + copt28;
  Real copt382 = -(copt381 * copt4 * copt8);
  Real copt383 = copt374 + copt375 + copt376 + copt377 + copt378 + copt379 +
                 copt380 + copt382;
  Real copt384 = -2 * copt23 * copt383;
  Real copt385 = copt325 + copt327 + copt328 + copt329 + copt331 + copt332 +
                 copt333 + copt334 + copt335 + copt336 + copt338 + copt339 +
                 copt341 + copt342 + copt347 + copt348 + copt349 + copt350 +
                 copt351 + copt352 + copt354 + copt355 + copt356 + copt357 +
                 copt361 + copt373 + copt384;
  Real copt386 = 1 / copt385;
  Real copt161 = t0(1);
  Real copt231 = t1(1);
  Real copt299 = t2(1);
  Real copt394 = Power(copt36, 2);
  Real copt411 = Power(copt38, 2);
  Real copt419 = Power(copt161, 2);
  Real copt422 = Power(copt231, 2);
  Real copt425 = Power(copt299, 2);
  Real copt395 = -2 * copt2 * copt4;
  Real copt396 = -2 * copt13 * copt15;
  Real copt397 = -2 * copt23 * copt25;
  Real copt398 = copt323 + copt324 + copt326 + copt340 + copt343 + copt358 +
                 copt395 + copt396 + copt397;
  Real copt400 = -(copt23 * copt25);
  Real copt401 = copt4 * copt8;
  Real copt402 = copt4 + copt8;
  Real copt403 = -(copt2 * copt402);
  Real copt404 = copt15 * copt18;
  Real copt405 = copt15 + copt18;
  Real copt406 = -(copt13 * copt405);
  Real copt407 = -(copt23 * copt28);
  Real copt408 = copt25 * copt28;
  Real copt409 = copt323 + copt343 + copt358 + copt400 + copt401 + copt403 +
                 copt404 + copt406 + copt407 + copt408;
  Real copt412 = -2 * copt2 * copt8;
  Real copt413 = -2 * copt13 * copt18;
  Real copt414 = -2 * copt23 * copt28;
  Real copt415 = copt323 + copt330 + copt337 + copt343 + copt353 + copt358 +
                 copt412 + copt413 + copt414;
  Real copt420 = copt419 * l1 * l2 * thetarest0;
  Real copt421 = copt158 * copt419 * l1 * l2;
  Real copt423 = copt422 * l0 * l2 * thetarest1;
  Real copt424 = copt228 * copt422 * l0 * l2;
  Real copt426 = copt425 * l0 * l1 * thetarest2;
  Real copt427 = copt296 * copt425 * l0 * l1;
  Real copt428 = copt420 + copt421 + copt423 + copt424 + copt426 + copt427;
  Real copt441 = Power(copt1, 2);
  Real copt444 = Power(copt7, 2);
  Real copt387 = copt160 * copt161 * l1 * l2 * thetarest0;
  Real copt388 = copt158 * copt160 * copt161 * l1 * l2;
  Real copt389 = copt230 * copt231 * l0 * l2 * thetarest1;
  Real copt390 = copt228 * copt230 * copt231 * l0 * l2;
  Real copt391 = copt298 * copt299 * l0 * l1 * thetarest2;
  Real copt392 = copt296 * copt298 * copt299 * l0 * l1;
  Real copt393 = copt387 + copt388 + copt389 + copt390 + copt391 + copt392;
  Real copt429 = copt36 * copt398;
  Real copt430 = copt38 * copt409;
  Real copt431 = copt429 + copt430;
  Real copt432 = copt1 * copt431;
  Real copt433 = copt36 * copt409;
  Real copt434 = copt38 * copt415;
  Real copt435 = copt433 + copt434;
  Real copt436 = copt435 * copt7;
  Real copt437 = copt432 + copt436;
  out(0)       = copt34;
  out(1)       = copt35 * copt50 * copt56;
  out(2)       = copt55;
  out(3) =
      (copt316 * copt58 * copt59 * copt60 * copt61 *
       (copt50 * (copt297 * copt298 * copt299 * l0 * l1 +
                  copt229 * copt230 * copt231 * l0 * l2 +
                  copt159 * copt160 * copt161 * l1 * l2) -
        copt54 * (copt297 * copt307 * l0 * l1 + copt229 * copt305 * l0 * l2 +
                  copt159 * copt303 * l1 * l2))) /
      2.;
  out(4) = (copt322 * copt386 *
            (-(copt393 * (copt394 * copt398 + 2 * copt36 * copt38 * copt409 +
                          copt411 * copt415)) +
             copt428 * copt437) *
            copt58 * copt59 * copt60 * copt61) /
           2.;
  out(5) =
      (copt322 * copt386 * copt58 * copt59 * copt60 * copt61 *
       (copt393 * copt437 - copt428 * (copt398 * copt441 + copt415 * copt444 +
                                       2 * copt1 * copt409 * copt7))) /
      2.;
  return out;
}

#endif  // hylc_strain_II
